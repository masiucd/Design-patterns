(()=>{"use strict";var t=function(){function t(){this.messageBox=[],this.members=[]}return t.prototype.register=function(t){this.members.push(t),t.adminMediator=this},Object.defineProperty(t.prototype,"getMessageBox",{get:function(){return this.messageBox},enumerable:!1,configurable:!0}),t.prototype.send=function(t,n){console.log("message",t),console.log("from",n);var e={message:t,from:n};this.messageBox.push(e)},t}();function n(){return{loadMediator:function(){return new t}}}var e,i=function(){function t(t,n,e){this.teacher=t,this.students=n,this.admin=e}return t.prototype.render=function(){this.teacher.init(),this.admin.init(),this.students.init(),console.log(n().loadMediator())},t}(),o=function(){function t(t,n,e,i,o){this.parentElement=t,this.dataList=n,this.title=e,this.subTitles=i,this.type=o}return t.prototype.clickHandler=function(t){document.querySelectorAll("tr").forEach((function(n){return n.addEventListener("click",(function(){"student"===n.id.split("-")[0]&&t(parseInt(n.dataset.id,10))}))}))},t.prototype.render=function(){var t=this,n='\n    <div class="table-wrapper wrapper-'+this.title+'">\n    <table class="'+this.title+'">\n        <caption>'+this.title+"</caption>\n        <thead>\n          "+this.subTitles.map((function(t){return"<th>"+t+"</th>"})).join("")+"\n        </thead>\n        <tbody>\n          "+this.dataList.map((function(n){var e=n.displayInfo();return'\n                <tr data-id="'+n.id+'" id="'+("student"===t.type?"student-"+n.id:"course"===t.type?"course-"+n.id:"teacher-"+n.id)+'">\n                '+Object.keys(e).map((function(t){return'<td data-info="'+e[t]+'">'+e[t]+"</td>"})).join("")+"\n                </tr>\n          "})).join("")+"\n        </tbody>\n      </table>\n    </div>\n    ";this.parentElement.innerHTML=n},t.prototype.renderRawHtml=function(){return'\n    <div class="table-wrapper wrapper-'+this.title+'">\n    <table>\n        <caption>'+this.title+"</caption>\n        <thead>\n          "+this.subTitles.map((function(t){return"<th>"+t+"</th>"})).join("")+"\n        </thead>\n        <tbody>\n          "+this.dataList.map((function(t){var n=t.displayInfo();return'\n                <tr data-id="'+t.id+'">\n                '+Object.keys(n).map((function(t){return"<td>"+n[t]+"</td>"})).join("")+"\n                </tr>\n          "})).join("")+"\n        </tbody>\n      </table>\n    </div>\n    "},t.prototype.mount=function(t){t.innerHTML=this.renderRawHtml()},t.prototype.init=function(){this.render()},t}(),r=function(t,n,e,i,o){this.id=t,this.firstName=n,this.lastName=e,this.email=i,this.age=o},s=(e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])})(t,n)},function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),a=function(t){function n(n,e,i,o,r){var s=t.call(this,n,e,i,o,r)||this;return s.subjects=[],s}return s(n,t),n.prototype.displayInfo=function(){return{name:this.firstName+"-"+this.lastName,email:this.email,age:""+this.age}},Object.defineProperty(n.prototype,"addSubject",{set:function(t){this.subjects.push(t)},enumerable:!1,configurable:!0}),n}(r),u=function(){function t(t){this.parentElement=t,this.teachersView=new o(this.parentElement,[new a(1,"Frank","Smith","frank@io.com",43),new a(2,"Logan","Jonsson","logan@io.com",47),new a(3,"Mia","Greger","mia@io.com",41),new a(4,"Boris","Rooney","frank@io.com",53)],"Teachers",["name","email","age"],"teacher")}return t.prototype.init=function(){this.teachersView.init()},t}(),c=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])})(n,e)};return function(n,e){function i(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}(),d=function(t){function n(n,e,i,o,r){var s=t.call(this,n,e,i,o,r)||this;return s.adminMediator=null,s}return c(n,t),n.prototype.displayInfo=function(){return{name:this.firstName+"-"+this.lastName,email:this.email,age:""+this.age}},n.prototype.send=function(t){var n;null===(n=this.adminMediator)||void 0===n||n.send(t,this),console.log("x",t),console.log(this.adminMediator)},n.prototype.receive=function(t,n){return t+" - from "+n},n}(r),l=function(){return[new d(1,"Frank","Mellberg","frank@io.com",21),new d(2,"Rio","Ferdinand","rio@io.com",25),new d(3,"Nemanja","Vidic","nemanja@io.com",32),new d(4,"Fredrik","ljungberg","fredrik@io.com",32)]},h=function(){function t(){this.id=99,this.firstName="Alfred",this.slug="I am the boss üí∞!!!",this.isAdmin=!0,this.adminMediator=null}return t.getInstance=function(){return t.instance||(t.instance=new t),t.instance},Object.defineProperty(t.prototype,"getMessages",{get:function(){var t;return null===(t=this.adminMediator)||void 0===t?void 0:t.messageBox},enumerable:!1,configurable:!0}),t}();function p(){var t=function(){return new h};return n().loadMediator().register(t()),{admin:t()}}var m=function(){function t(t,n,e,i,r){this.parentElement=t,this.list=n,this.data=e,this.title=i,this.subTitles=r,this.listView=new o(this.parentElement,this.list,this.title,this.subTitles,"student"),this.confirmationText="",this.admin=p().admin}return t.prototype.updateText=function(t){this.confirmationText=t},t.prototype.render=function(){var t,n=this,e=document.querySelector(".modal");e.classList.add("show-modal");var i='\n    <div class="modal-container">\n      '+this.listView.renderRawHtml()+"\n      "+this.confirmationText+'\n      <button class="close-modal">\n        ‚ùå\n      </button>\n    </div>\n    ';e.innerHTML=i,null===(t=document.querySelector(".close-modal"))||void 0===t||t.addEventListener("click",(function(){e.classList.remove("show-modal"),e.innerHTML=""})),document.querySelectorAll(".modal tbody tr").forEach((function(t){t.addEventListener("click",(function(t){if("send"in n.data){var e="You have now been registered to the "+t.target.innerText+" Course";n.data.send(e),n.updateText(e),n.updateHtml()}}))}))},t.prototype.updateHtml=function(){this.render(),p()},t}(),f=function(){function t(t,n,e,i){this.id=t,this.title=n,this.description=e,this.duration=i}return t.prototype.displayInfo=function(){return{title:this.title,duration:this.duration}},t}(),y=function(){function t(t){this.parentElement=t,this.studentsView=new o(this.parentElement,l(),"Students",["name","email","age"],"student")}return t.prototype.handleClickStudent=function(){this.studentsView.clickHandler((function(t){var n=l().find((function(n){return n.id===t})),e=[new f(1,"math","math is wonderful","6h"),new f(2,"history","history is good for you","3h"),new f(3,"swedish","without swedish you will face some serious problems","2h"),new f(4,"english","the global language, learn it NOW!!!","5h")],i=document.querySelector(".modal-list");new m(i,e,n,"courses",["title","duration"]).render()}))},t.prototype.handleShowProfile=function(){},t.prototype.init=function(){this.studentsView.init(),this.handleClickStudent(),this.handleShowProfile(),function(){for(var t=0,e=l();t<e.length;t++){var i=e[t];n().loadMediator().register(i)}}()},t}(),w=function(){function t(t){this.parentElement=t,this.admin=p().admin}return t.prototype.render=function(){var t,n='\n      <div class="admin-wrapper wrapper-'+this.admin.firstName+'">\n        <button id="admin-profile-btn" class="button">Admin Profile</button>\n\n        <div class="admin-content">\n          <h3> Mr Admin '+this.admin.firstName+"</h3>\n          <p>"+this.admin.slug+"</p>\n        </div>\n\n      </div>\n    ";this.parentElement.innerHTML=n;var e=document.querySelector(".admin-content");null===(t=document.getElementById("admin-profile-btn"))||void 0===t||t.addEventListener("click",(function(){e.classList.toggle("show-admin-content")}))},t}(),g=function(){function t(t){this.parentElement=t,this.adminView=new w(this.parentElement)}return t.prototype.init=function(){this.adminView.render()},t}();new i(new u(document.getElementById("teacher")),new y(document.getElementById("student")),new g(document.getElementById("admin"))).render()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zY2hvb2wtZGF0YS8uL3NyYy9wYXR0ZXJucy9tdmMyLjAvbW9kZWxzL21lZGlhdG9yLnRzIiwid2VicGFjazovL3NjaG9vbC1kYXRhLy4vc3JjL3BhdHRlcm5zL212YzIuMC9jb250cm9sbGVycy9hcHAudHMiLCJ3ZWJwYWNrOi8vc2Nob29sLWRhdGEvLi9zcmMvcGF0dGVybnMvbXZjMi4wL3ZpZXdzL2xpc3Qtdmlldy50cyIsIndlYnBhY2s6Ly9zY2hvb2wtZGF0YS8uL3NyYy9wYXR0ZXJucy9tdmMyLjAvbW9kZWxzL1BlcnNvbi50cyIsIndlYnBhY2s6Ly9zY2hvb2wtZGF0YS8uL3NyYy9wYXR0ZXJucy9tdmMyLjAvbW9kZWxzL3RlYWNoZXIudHMiLCJ3ZWJwYWNrOi8vc2Nob29sLWRhdGEvLi9zcmMvcGF0dGVybnMvbXZjMi4wL2NvbnRyb2xsZXJzL3RlYWNoZXIudHMiLCJ3ZWJwYWNrOi8vc2Nob29sLWRhdGEvLi9zcmMvcGF0dGVybnMvbXZjMi4wL21vZGVscy9zdHVkZW50LnRzIiwid2VicGFjazovL3NjaG9vbC1kYXRhLy4vc3JjL3BhdHRlcm5zL212YzIuMC9tb2RlbHMvYWRtaW4udHMiLCJ3ZWJwYWNrOi8vc2Nob29sLWRhdGEvLi9zcmMvcGF0dGVybnMvbXZjMi4wL3ZpZXdzL21vZGFsLXZpZXcudHMiLCJ3ZWJwYWNrOi8vc2Nob29sLWRhdGEvLi9zcmMvcGF0dGVybnMvbXZjMi4wL21vZGVscy9jb3Vyc2UudHMiLCJ3ZWJwYWNrOi8vc2Nob29sLWRhdGEvLi9zcmMvcGF0dGVybnMvbXZjMi4wL2NvbnRyb2xsZXJzL3N0dWRlbnQudHMiLCJ3ZWJwYWNrOi8vc2Nob29sLWRhdGEvLi9zcmMvcGF0dGVybnMvbXZjMi4wL3ZpZXdzL2FkbWluLXZpZXcudHMiLCJ3ZWJwYWNrOi8vc2Nob29sLWRhdGEvLi9zcmMvcGF0dGVybnMvbXZjMi4wL2NvbnRyb2xsZXJzL2FkbWluLnRzIiwid2VicGFjazovL3NjaG9vbC1kYXRhLy4vc3JjL2luZGV4LnRzIl0sIm5hbWVzIjpbInRoaXMiLCJtZXNzYWdlQm94IiwibWVtYmVycyIsInJlZ2lzdGVyIiwibWVtYmVyIiwicHVzaCIsImFkbWluTWVkaWF0b3IiLCJzZW5kIiwibWVzc2FnZSIsImZyb20iLCJjb25zb2xlIiwibG9nIiwib2JqIiwiaW5pdCIsImxvYWRNZWRpYXRvciIsIkFkbWluTWVkaWF0b3IiLCJ0ZWFjaGVyIiwic3R1ZGVudHMiLCJhZG1pbiIsInJlbmRlciIsInBhcmVudEVsZW1lbnQiLCJkYXRhTGlzdCIsInRpdGxlIiwic3ViVGl0bGVzIiwidHlwZSIsImNsaWNrSGFuZGxlciIsInN1YnNjcmliZXIiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJmb3JFYWNoIiwidHIiLCJhZGRFdmVudExpc3RlbmVyIiwiaWQiLCJzcGxpdCIsInBhcnNlSW50IiwiZGF0YXNldCIsImh0bWwiLCJtYXAiLCJ0Iiwiam9pbiIsImRhdGEiLCJkaXNwbGF5SW5mbyIsIk9iamVjdCIsImtleXMiLCJrZXkiLCJpbm5lckhUTUwiLCJyZW5kZXJSYXdIdG1sIiwibW91bnQiLCJlbGVtZW50IiwiZmlyc3ROYW1lIiwibGFzdE5hbWUiLCJlbWFpbCIsImFnZSIsInN1YmplY3RzIiwibmFtZSIsInN1YmplY3QiLCJQZXJzb24iLCJ0ZWFjaGVyc1ZpZXciLCJMaXN0VmlldyIsIlRlYWNoZXIiLCJyZWNlaXZlIiwibG9hZFN0dWRlbnRzIiwiU3R1ZGVudCIsInNsdWciLCJpc0FkbWluIiwiZ2V0SW5zdGFuY2UiLCJBZG1pbiIsImluc3RhbmNlIiwibG9hZEFkbWluIiwibGlzdCIsImxpc3RWaWV3IiwiY29uZmlybWF0aW9uVGV4dCIsInVwZGF0ZVRleHQiLCJ0ZXh0IiwibW9kYWxXcmFwcGVyIiwicXVlcnlTZWxlY3RvciIsImNsYXNzTGlzdCIsImFkZCIsInJlbW92ZSIsImV2ZW50IiwidGFyZ2V0IiwiaW5uZXJUZXh0IiwidXBkYXRlSHRtbCIsImRlc2NyaXB0aW9uIiwiZHVyYXRpb24iLCJzdHVkZW50c1ZpZXciLCJoYW5kbGVDbGlja1N0dWRlbnQiLCJmaW5kIiwic3R1ZGVudCIsImNvdXJzZXMiLCJDb3Vyc2UiLCJtb2RhbCIsImhhbmRsZVNob3dQcm9maWxlIiwicmVnaXN0ZXJBbGxTdHVkZW50cyIsImFkbWluQ29udGVudCIsImdldEVsZW1lbnRCeUlkIiwidG9nZ2xlIiwiYWRtaW5WaWV3IiwiQWRtaW5WaWV3IiwiQXBwIiwiVGVhY2hlckNvbnRyb2xsZXIiLCJTdHVkZW50Q29udHJvbGxlciIsIkFkbWluQ29udHJvbGxlciJdLCJtYXBwaW5ncyI6Im1CQU1BLGlCQUdFLGFBQ0VBLEtBQUtDLFdBQWEsR0FDbEJELEtBQUtFLFFBQVUsR0FrQm5CLE9BaEJFLFlBQUFDLFNBQUEsU0FBU0MsR0FFUEosS0FBS0UsUUFBUUcsS0FBS0QsR0FDbEJBLEVBQU9FLGNBQWdCTixNQUd6QixzQkFBSSw0QkFBYSxDLElBQWpCLFdBQ0UsT0FBT0EsS0FBS0MsWSxnQ0FHZCxZQUFBTSxLQUFBLFNBQUtDLEVBQWlCQyxHQUNwQkMsUUFBUUMsSUFBSSxVQUFXSCxHQUN2QkUsUUFBUUMsSUFBSSxPQUFRRixHQUNwQixJQUFNRyxFQUFrQixDQUFFSixRQUFPLEVBQUVDLEtBQUksR0FDdkNULEtBQUtDLFdBQVdJLEtBQUtPLElBRXpCLEVBdkJBLEdBeUJBLFNBQVNDLElBRVAsTUFBTyxDQUNMQyxhQUZtQixXQUFNLFdBQUlDLElDM0JqQyxJLEVBQUEsYUFJRSxXQUFZQyxFQUE0QkMsRUFBNkJDLEdBQ25FbEIsS0FBS2dCLFFBQVVBLEVBQ2ZoQixLQUFLaUIsU0FBV0EsRUFDaEJqQixLQUFLa0IsTUFBUUEsRUFTakIsT0FORSxZQUFBQyxPQUFBLFdBQ0VuQixLQUFLZ0IsUUFBUUgsT0FDYmIsS0FBS2tCLE1BQU1MLE9BQ1hiLEtBQUtpQixTQUFTSixPQUNkSCxRQUFRQyxJQUFJRSxJQUFPQyxpQkFFdkIsRUFoQkEsR0NGQSxhQU1FLFdBQ0VNLEVBQ0FDLEVBQ0FDLEVBQ0FDLEVBQ0FDLEdBRUF4QixLQUFLb0Is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LEtBQUs0RixvQkpUbUIsV0FDMUIsSUFBb0IsVUFBQS9CLElBQUEsZUFBZ0IsQ0FBL0IsSUFBSTJCLEVBQU8sS0FDZDNFLElBQU9DLGVBQWVYLFNBQVNxRixJSVEvQkssSUFFSixFQXhDQSxHQ0pBLGFBR0UsV0FBWXpFLEdBQ1ZwQixLQUFLb0IsY0FBZ0JBLEVBQ3JCcEIsS0FBS2tCLE1BQVEsSUFBT0EsTUF1QnhCLE9BcEJFLFlBQUFDLE9BQUEsVyxNQUVRaUIsRUFBTyw2Q0FDeUJwQyxLQUFLa0IsTUFBTStCLFVBQVMsb0pBSXBDakQsS0FBS2tCLE1BQU0rQixVQUFTLHVCQUMvQmpELEtBQUtrQixNQUFNNkMsS0FBSSw2Q0FLMUIvRCxLQUFLb0IsY0FBY3lCLFVBQVlULEVBRS9CLElBQU0wRCxFQUFlbkUsU0FBU2dELGNBQWMsa0JBQ0EsUUFBNUMsRUFBQWhELFNBQVNvRSxlQUFlLDRCQUFvQixTQUFFaEUsaUJBQWlCLFNBQVMsV0FDdEUrRCxFQUFhbEIsVUFBVW9CLE9BQU8sMEJBR3BDLEVBNUJBLEdDQUEsYUFHRSxXQUFZNUUsR0FDVnBCLEtBQUtvQixjQUFnQkEsRUFDckJwQixLQUFLaUcsVUFBWSxJQUFJQyxFQUFVbEcsS0FBS29CLGVBTXhDLE9BSEUsWUFBQVAsS0FBQSxXQUNFYixLQUFLaUcsVUFBVTlFLFVBRW5CLEVBWEEsR0NHRSxJQUFJZ0YsRUFDRixJQUFJQyxFQUFrQnpFLFNBQVNvRSxlQUFlLFlBQzlDLElBQUlNLEVBQWtCMUUsU0FBU29FLGVBQWUsWUFDOUMsSUFBSU8sRUFBZ0IzRSxTQUFTb0UsZUFBZSxXQUM1QzVFLFUiLCJmaWxlIjoiYnVuZGxlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQWRtaW4gfSBmcm9tIFwiLi9hZG1pblwiXG5pbXBvcnQgeyBTdHVkZW50IH0gZnJvbSBcIi4vc3R1ZGVudFwiXG5pbnRlcmZhY2UgTWVzc2FnZUJveCB7XG4gIG1lc3NhZ2U6IHN0cmluZ1xuICBmcm9tOiBTdHVkZW50IHwgQWRtaW5cbn1cbmNsYXNzIEFkbWluTWVkaWF0b3Ige1xuICBtZXNzYWdlQm94OiBNZXNzYWdlQm94W11cbiAgbWVtYmVyczogU3R1ZGVudFtdICYgQWRtaW5bXVxuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLm1lc3NhZ2VCb3ggPSBbXVxuICAgIHRoaXMubWVtYmVycyA9IFtdXG4gIH1cbiAgcmVnaXN0ZXIobWVtYmVyOiBTdHVkZW50IHwgQWRtaW4pIHtcbiAgICAvLyBAdHMtaWdub3JlXG4gICAgdGhpcy5tZW1iZXJzLnB1c2gobWVtYmVyKVxuICAgIG1lbWJlci5hZG1pbk1lZGlhdG9yID0gdGhpc1xuICB9XG5cbiAgZ2V0IGdldE1lc3NhZ2VCb3goKTogTWVzc2FnZUJveFtdIHtcbiAgICByZXR1cm4gdGhpcy5tZXNzYWdlQm94XG4gIH1cblxuICBzZW5kKG1lc3NhZ2U6IHN0cmluZywgZnJvbTogU3R1ZGVudCB8IEFkbWluKSB7XG4gICAgY29uc29sZS5sb2coXCJtZXNzYWdlXCIsIG1lc3NhZ2UpXG4gICAgY29uc29sZS5sb2coXCJmcm9tXCIsIGZyb20pXG4gICAgY29uc3Qgb2JqOiBNZXNzYWdlQm94ID0geyBtZXNzYWdlLCBmcm9tIH1cbiAgICB0aGlzLm1lc3NhZ2VCb3gucHVzaChvYmopXG4gIH1cbn1cblxuZnVuY3Rpb24gaW5pdCgpIHtcbiAgY29uc3QgbG9hZE1lZGlhdG9yID0gKCkgPT4gbmV3IEFkbWluTWVkaWF0b3IoKVxuICByZXR1cm4ge1xuICAgIGxvYWRNZWRpYXRvcixcbiAgfVxufVxuXG5leHBvcnQgeyBBZG1pbk1lZGlhdG9yLCBpbml0IH1cbiIsImltcG9ydCB7IFRlYWNoZXJDb250cm9sbGVyIH0gZnJvbSBcIi4vdGVhY2hlclwiXG5pbXBvcnQgeyBTdHVkZW50Q29udHJvbGxlciB9IGZyb20gXCIuL3N0dWRlbnRcIlxuaW1wb3J0IHsgQWRtaW5Db250cm9sbGVyIH0gZnJvbSBcIi4vYWRtaW5cIlxuaW1wb3J0IHsgaW5pdCB9IGZyb20gXCIuLi9tb2RlbHMvbWVkaWF0b3JcIlxuXG5leHBvcnQgY2xhc3MgQXBwIHtcbiAgdGVhY2hlcjogVGVhY2hlckNvbnRyb2xsZXJcbiAgc3R1ZGVudHM6IFN0dWRlbnRDb250cm9sbGVyXG4gIGFkbWluOiBBZG1pbkNvbnRyb2xsZXJcbiAgY29uc3RydWN0b3IodGVhY2hlcjogVGVhY2hlckNvbnRyb2xsZXIsIHN0dWRlbnRzOiBTdHVkZW50Q29udHJvbGxlciwgYWRtaW46IEFkbWluQ29udHJvbGxlcikge1xuICAgIHRoaXMudGVhY2hlciA9IHRlYWNoZXJcbiAgICB0aGlzLnN0dWRlbnRzID0gc3R1ZGVudHNcbiAgICB0aGlzLmFkbWluID0gYWRtaW5cbiAgfVxuXG4gIHJlbmRlcigpOiB2b2lkIHtcbiAgICB0aGlzLnRlYWNoZXIuaW5pdCgpXG4gICAgdGhpcy5hZG1pbi5pbml0KClcbiAgICB0aGlzLnN0dWRlbnRzLmluaXQoKVxuICAgIGNvbnNvbGUubG9nKGluaXQoKS5sb2FkTWVkaWF0b3IoKSlcbiAgfVxufVxuIiwiaW1wb3J0IHsgQ291cnNlIH0gZnJvbSBcIi4uLy4uL212Yy9tb2RlbHMvY291cnNlLW1vZGVsXCJcbmltcG9ydCB7IFRlYWNoZXIgfSBmcm9tIFwiLi4vbW9kZWxzL3RlYWNoZXJcIlxuaW1wb3J0IHsgV2hhdE1vZGVsVHlwZSB9IGZyb20gXCIuLi90eXBlc1wiXG5leHBvcnQgY2xhc3MgTGlzdFZpZXc8VD4ge1xuICBwYXJlbnRFbGVtZW50OiBIVE1MRGl2RWxlbWVudFxuICBkYXRhTGlzdDogQXJyYXk8VD5cbiAgdGl0bGU6IHN0cmluZ1xuICBzdWJUaXRsZXM6IHN0cmluZ1tdXG4gIHR5cGU6IFdoYXRNb2RlbFR5cGUgLy8gc3R1ZGVudCBvcmUgdGVhY2hlclxuICBjb25zdHJ1Y3RvcihcbiAgICBwYXJlbnRFbGVtZW50OiBIVE1MRGl2RWxlbWVudCxcbiAgICBkYXRhTGlzdDogQXJyYXk8VD4sXG4gICAgdGl0bGU6IHN0cmluZyxcbiAgICBzdWJUaXRsZXM6IHN0cmluZ1tdLFxuICAgIHR5cGU6IFdoYXRNb2RlbFR5cGUsXG4gICkge1xuICAgIHRoaXMucGFyZW50RWxlbWVudCA9IHBhcmVudEVsZW1lbnRcbiAgICB0aGlzLmRhdGFMaXN0ID0gZGF0YUxpc3RcbiAgICB0aGlzLnRpdGxlID0gdGl0bGVcbiAgICB0aGlzLnN1YlRpdGxlcyA9IHN1YlRpdGxlc1xuICAgIHRoaXMudHlwZSA9IHR5cGVcbiAgfVxuXG4gIGNsaWNrSGFuZGxlcihzdWJzY3JpYmVyOiBGdW5jdGlvbikge1xuICAgIGNvbnN0IHRycyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCJ0clwiKVxuICAgIHRycy5mb3JFYWNoKHRyID0+XG4gICAgICB0ci5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgICBjb25zdCBbdHlwZV0gPSB0ci5pZC5zcGxpdChcIi1cIilcbiAgICAgICAgaWYgKHR5cGUgPT09IFwic3R1ZGVudFwiKSB7XG4gICAgICAgICAgc3Vic2NyaWJlcihwYXJzZUludCh0ci5kYXRhc2V0LmlkISwgMTApKVxuICAgICAgICB9XG4gICAgICAgIC8vIHNlc3Npb25TdG9yYWdlLnNldEl0ZW0oXCJ1c2VyXCIsIFN0cmluZyh0ci5kYXRhc2V0LmlkKSlcbiAgICAgIH0pLFxuICAgIClcbiAgfVxuXG4gIHByaXZhdGUgcmVuZGVyKCk6IHZvaWQge1xuICAgIGNvbnN0IGh0bWwgPSBgXG4gICAgPGRpdiBjbGFzcz1cInRhYmxlLXdyYXBwZXIgd3JhcHBlci0ke3RoaXMudGl0bGV9XCI+XG4gICAgPHRhYmxlIGNsYXNzPVwiJHt0aGlzLnRpdGxlfVwiPlxuICAgICAgICA8Y2FwdGlvbj4ke3RoaXMudGl0bGV9PC9jYXB0aW9uPlxuICAgICAgICA8dGhlYWQ+XG4gICAgICAgICAgJHt0aGlzLnN1YlRpdGxlcy5tYXAodCA9PiBgPHRoPiR7dH08L3RoPmApLmpvaW4oXCJcIil9XG4gICAgICAgIDwvdGhlYWQ+XG4gICAgICAgIDx0Ym9keT5cbiAgICAgICAgICAkeyh0aGlzLmRhdGFMaXN0IGFzIEFycmF5PFQ+KVxuICAgICAgICAgICAgLm1hcCgoZGF0YTogYW55KSA9PiB7XG4gICAgICAgICAgICAgIGNvbnN0IGRpc3BsYXlJbmZvID0gZGF0YS5kaXNwbGF5SW5mbygpIGFzIHsgW2tleTogc3RyaW5nXTogc3RyaW5nIH1cbiAgICAgICAgICAgICAgcmV0dXJuIGBcbiAgICAgICAgICAgICAgICA8dHIgZGF0YS1pZD1cIiR7ZGF0YS5pZH1cIiBpZD1cIiR7XG4gICAgICAgICAgICAgICAgdGhpcy50eXBlID09PSBcInN0dWRlbnRcIlxuICAgICAgICAgICAgICAgICAgPyBgc3R1ZGVudC0ke2RhdGEuaWR9YFxuICAgICAgICAgICAgICAgICAgOiB0aGlzLnR5cGUgPT09IFwiY291cnNlXCJcbiAgICAgICAgICAgICAgICAgID8gYGNvdXJzZS0ke2RhdGEuaWR9YFxuICAgICAgICAgICAgICAgICAgOiBgdGVhY2hlci0ke2RhdGEuaWR9YFxuICAgICAgICAgICAgICB9XCI+XG4gICAgICAgICAgICAgICAgJHtPYmplY3Qua2V5cyhkaXNwbGF5SW5mbylcbiAgICAgICAgICAgICAgICAgIC5tYXAoa2V5ID0+IGA8dGQgZGF0YS1pbmZvPVwiJHtkaXNwbGF5SW5mb1trZXldfVwiPiR7ZGlzcGxheUluZm9ba2V5XX08L3RkPmApXG4gICAgICAgICAgICAgICAgICAuam9pbihcIlwiKX1cbiAgICAgICAgICAgICAgICA8L3RyPlxuICAgICAgICAgIGBcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuam9pbihcIlwiKX1cbiAgICAgICAgPC90Ym9keT5cbiAgICAgIDwvdGFibGU+XG4gICAgPC9kaXY+XG4gICAgYFxuICAgIHRoaXMucGFyZW50RWxlbWVudC5pbm5lckhUTUwgPSBodG1sXG4gIH1cblxuICByZW5kZXJSYXdIdG1sKCk6IHN0cmluZyB7XG4gICAgY29uc3QgaHRtbCA9IGBcbiAgICA8ZGl2IGNsYXNzPVwidGFibGUtd3JhcHBlciB3cmFwcGVyLSR7dGhpcy50aXRsZX1cIj5cbiAgICA8dGFibGU+XG4gICAgICAgIDxjYXB0aW9uPiR7dGhpcy50aXRsZX08L2NhcHRpb24+XG4gICAgICAgIDx0aGVhZD5cbiAgICAgICAgICAke3RoaXMuc3ViVGl0bGVzLm1hcCh0ID0+IGA8dGg+JHt0fTwvdGg+YCkuam9pbihcIlwiKX1cbiAgICAgICAgPC90aGVhZD5cbiAgICAgICAgPHRib2R5PlxuICAgICAgICAgICR7KHRoaXMuZGF0YUxpc3QgYXMgQXJyYXk8YW55PilcbiAgICAgICAgICAgIC5tYXAoKGRhdGE6IGFueSkgPT4ge1xuICAgICAgICAgICAgICBjb25zdCBkaXNwbGF5SW5mbyA9IGRhdGEuZGlzcGxheUluZm8oKSBhcyB7IFtrZXk6IHN0cmluZ106IHN0cmluZyB9XG4gICAgICAgICAgICAgIHJldHVybiBgXG4gICAgICAgICAgICAgICAgPHRyIGRhdGEtaWQ9XCIke2RhdGEuaWR9XCI+XG4gICAgICAgICAgICAgICAgJHtPYmplY3Qua2V5cyhkaXNwbGF5SW5mbylcbiAgICAgICAgICAgICAgICAgIC5tYXAoa2V5ID0+IGA8dGQ+JHtkaXNwbGF5SW5mb1trZXldfTwvdGQ+YClcbiAgICAgICAgICAgICAgICAgIC5qb2luKFwiXCIpfVxuICAgICAgICAgICAgICAgIDwvdHI+XG4gICAgICAgICAgYFxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5qb2luKFwiXCIpfVxuICAgICAgICA8L3Rib2R5PlxuICAgICAgPC90YWJsZT5cbiAgICA8L2Rpdj5cbiAgICBgXG4gICAgcmV0dXJuIGh0bWxcbiAgfVxuXG4gIG1vdW50KGVsZW1lbnQ6IEhUTUxFbGVtZW50KSB7XG4gICAgZWxlbWVudC5pbm5lckhUTUwgPSB0aGlzLnJlbmRlclJhd0h0bWwoKVxuICB9XG5cbiAgaW5pdCgpOiB2b2lkIHtcbiAgICB0aGlzLnJlbmRlcigpXG4gIH1cbn1cbiIsImV4cG9ydCBjbGFzcyBQZXJzb24ge1xuICBpZDogbnVtYmVyXG4gIGZpcnN0TmFtZTogc3RyaW5nXG4gIGxhc3ROYW1lOiBzdHJpbmdcbiAgZW1haWw6IHN0cmluZ1xuICBhZ2U6IG51bWJlclxuICBjb25zdHJ1Y3RvcihpZDogbnVtYmVyLCBmaXJzdE5hbWU6IHN0cmluZywgbGFzdE5hbWU6IHN0cmluZywgZW1haWw6IHN0cmluZywgYWdlOiBudW1iZXIpIHtcbiAgICB0aGlzLmlkID0gaWRcbiAgICB0aGlzLmZpcnN0TmFtZSA9IGZpcnN0TmFtZVxuICAgIHRoaXMubGFzdE5hbWUgPSBsYXN0TmFtZVxuICAgIHRoaXMuZW1haWwgPSBlbWFpbFxuICAgIHRoaXMuYWdlID0gYWdlXG4gIH1cbn1cbiIsImltcG9ydCB7IFBlcnNvbiB9IGZyb20gXCIuL1BlcnNvblwiXG5pbXBvcnQgeyBEaXNwbGF5SW5mbywgU3ViamVjdCwgVGVhY2hlclN0dWRlbnRDb25zdHJ1Y3QgfSBmcm9tIFwiLi4vdHlwZXNcIlxuaW1wb3J0IHsgbmFub2lkIH0gZnJvbSBcIm5hbm9pZFwiXG5cbmV4cG9ydCBjbGFzcyBUZWFjaGVyIGV4dGVuZHMgUGVyc29uIGltcGxlbWVudHMgVGVhY2hlclN0dWRlbnRDb25zdHJ1Y3Qge1xuICBzdWJqZWN0czogU3ViamVjdFtdXG4gIGNvbnN0cnVjdG9yKGlkOiBudW1iZXIsIGZpcnN0TmFtZTogc3RyaW5nLCBsYXN0TmFtZTogc3RyaW5nLCBlbWFpbDogc3RyaW5nLCBhZ2U6IG51bWJlcikge1xuICAgIHN1cGVyKGlkLCBmaXJzdE5hbWUsIGxhc3ROYW1lLCBlbWFpbCwgYWdlKVxuICAgIHRoaXMuc3ViamVjdHMgPSBbXVxuICB9XG5cbiAgZGlzcGxheUluZm8oKTogRGlzcGxheUluZm8ge1xuICAgIHJldHVybiB7XG4gICAgICBuYW1lOiBgJHt0aGlzLmZpcnN0TmFtZX0tJHt0aGlzLmxhc3ROYW1lfWAsXG4gICAgICBlbWFpbDogdGhpcy5lbWFpbCxcbiAgICAgIGFnZTogYCR7dGhpcy5hZ2V9YCxcbiAgICB9XG4gIH1cblxuICBzZXQgYWRkU3ViamVjdChzdWJqZWN0OiBTdWJqZWN0KSB7XG4gICAgdGhpcy5zdWJqZWN0cy5wdXNoKHN1YmplY3QpXG4gIH1cbn1cblxuZXhwb3J0IGNvbnN0IGxvYWRUZWFjaGVycyA9ICgpID0+IFtcbiAgbmV3IFRlYWNoZXIoMSwgXCJGcmFua1wiLCBcIlNtaXRoXCIsIFwiZnJhbmtAaW8uY29tXCIsIDQzKSxcbiAgbmV3IFRlYWNoZXIoMiwgXCJMb2dhblwiLCBcIkpvbnNzb25cIiwgXCJsb2dhbkBpby5jb21cIiwgNDcpLFxuICBuZXcgVGVhY2hlcigzLCBcIk1pYVwiLCBcIkdyZWdlclwiLCBcIm1pYUBpby5jb21cIiwgNDEpLFxuICBuZXcgVGVhY2hlcig0LCBcIkJvcmlzXCIsIFwiUm9vbmV5XCIsIFwiZnJhbmtAaW8uY29tXCIsIDUzKSxcbl1cbiIsImltcG9ydCB7IExpc3RWaWV3IH0gZnJvbSBcIi4uL3ZpZXdzL2xpc3Qtdmlld1wiXG5pbXBvcnQgeyBsb2FkVGVhY2hlcnMsIFRlYWNoZXIgfSBmcm9tIFwiLi4vbW9kZWxzL3RlYWNoZXJcIlxuXG5leHBvcnQgY2xhc3MgVGVhY2hlckNvbnRyb2xsZXIge1xuICBwYXJlbnRFbGVtZW50OiBIVE1MRGl2RWxlbWVudFxuICB0ZWFjaGVyc1ZpZXc6IExpc3RWaWV3PFRlYWNoZXI+XG4gIGNvbnN0cnVjdG9yKHBhcmVudEVsZW1lbnQ6IEhUTUxEaXZFbGVtZW50KSB7XG4gICAgdGhpcy5wYXJlbnRFbGVtZW50ID0gcGFyZW50RWxlbWVudFxuICAgIHRoaXMudGVhY2hlcnNWaWV3ID0gbmV3IExpc3RWaWV3KFxuICAgICAgdGhpcy5wYXJlbnRFbGVtZW50LFxuICAgICAgbG9hZFRlYWNoZXJzKCksXG4gICAgICBcIlRlYWNoZXJzXCIsXG4gICAgICBbXCJuYW1lXCIsIFwiZW1haWxcIiwgXCJhZ2VcIl0sXG4gICAgICBcInRlYWNoZXJcIixcbiAgICApXG4gIH1cblxuICBpbml0KCk6IHZvaWQge1xuICAgIHRoaXMudGVhY2hlcnNWaWV3LmluaXQoKVxuICB9XG59XG4iLCJpbXBvcnQgeyBBZG1pbiB9IGZyb20gXCIuL2FkbWluXCJcbmltcG9ydCB7IEFkbWluTWVkaWF0b3IsIGluaXQgfSBmcm9tIFwiLi9tZWRpYXRvclwiXG5pbXBvcnQgeyBQZXJzb24gfSBmcm9tIFwiLi9QZXJzb25cIlxuXG5jbGFzcyBTdHVkZW50IGV4dGVuZHMgUGVyc29uIHtcbiAgYWRtaW5NZWRpYXRvcjogbnVsbCB8IEFkbWluTWVkaWF0b3JcbiAgY29uc3RydWN0b3IoaWQ6IG51bWJlciwgZmlyc3ROYW1lOiBzdHJpbmcsIGxhc3ROYW1lOiBzdHJpbmcsIGVtYWlsOiBzdHJpbmcsIGFnZTogbnVtYmVyKSB7XG4gICAgc3VwZXIoaWQsIGZpcnN0TmFtZSwgbGFzdE5hbWUsIGVtYWlsLCBhZ2UpXG4gICAgdGhpcy5hZG1pbk1lZGlhdG9yID0gbnVsbFxuICB9XG4gIGRpc3BsYXlJbmZvKCkge1xuICAgIHJldHVybiB7XG4gICAgICBuYW1lOiBgJHt0aGlzLmZpcnN0TmFtZX0tJHt0aGlzLmxhc3ROYW1lfWAsXG4gICAgICBlbWFpbDogdGhpcy5lbWFpbCxcbiAgICAgIGFnZTogYCR7dGhpcy5hZ2V9YCxcbiAgICB9XG4gIH1cbiAgc2VuZChtZXNzYWdlOiBzdHJpbmcpIHtcbiAgICB0aGlzLmFkbWluTWVkaWF0b3I/LnNlbmQobWVzc2FnZSwgdGhpcylcbiAgICBjb25zb2xlLmxvZyhcInhcIiwgbWVzc2FnZSlcbiAgICBjb25zb2xlLmxvZyh0aGlzLmFkbWluTWVkaWF0b3IpXG4gIH1cbiAgcmVjZWl2ZShtZXNzYWdlOiBzdHJpbmcsIGZyb206IFN0dWRlbnQpOiBzdHJpbmcge1xuICAgIHJldHVybiBgJHttZXNzYWdlfSAtIGZyb20gJHtmcm9tfWBcbiAgfVxufVxuXG5jb25zdCBsb2FkU3R1ZGVudHMgPSAoKSA9PiBbXG4gIG5ldyBTdHVkZW50KDEsIFwiRnJhbmtcIiwgXCJNZWxsYmVyZ1wiLCBcImZyYW5rQGlvLmNvbVwiLCAyMSksXG4gIG5ldyBTdHVkZW50KDIsIFwiUmlvXCIsIFwiRmVyZGluYW5kXCIsIFwicmlvQGlvLmNvbVwiLCAyNSksXG4gIG5ldyBTdHVkZW50KDMsIFwiTmVtYW5qYVwiLCBcIlZpZGljXCIsIFwibmVtYW5qYUBpby5jb21cIiwgMzIpLFxuICBuZXcgU3R1ZGVudCg0LCBcIkZyZWRyaWtcIiwgXCJsanVuZ2JlcmdcIiwgXCJmcmVkcmlrQGlvLmNvbVwiLCAzMiksXG5dXG5cbmNvbnN0IHJlZ2lzdGVyQWxsU3R1ZGVudHMgPSAoKTogdm9pZCA9PiB7XG4gIGZvciAobGV0IHN0dWRlbnQgb2YgbG9hZFN0dWRlbnRzKCkpIHtcbiAgICBpbml0KCkubG9hZE1lZGlhdG9yKCkucmVnaXN0ZXIoc3R1ZGVudClcbiAgfVxufVxuXG5leHBvcnQgeyBTdHVkZW50LCBsb2FkU3R1ZGVudHMsIHJlZ2lzdGVyQWxsU3R1ZGVudHMgfVxuIiwiaW1wb3J0IHsgQWRtaW5NZWRpYXRvciwgaW5pdCBhcyBtZWRpYXRvckluaXQgfSBmcm9tIFwiLi9tZWRpYXRvclwiXG5cbmNsYXNzIEFkbWluIHtcbiAgcHJpdmF0ZSBzdGF0aWMgaW5zdGFuY2U6IEFkbWluXG4gIGlkOiBudW1iZXJcbiAgZmlyc3ROYW1lOiBzdHJpbmdcbiAgc2x1Zzogc3RyaW5nXG4gIGlzQWRtaW46IGJvb2xlYW5cblxuICBhZG1pbk1lZGlhdG9yOiBudWxsIHwgQWRtaW5NZWRpYXRvclxuXG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMuaWQgPSA5OVxuICAgIHRoaXMuZmlyc3ROYW1lID0gXCJBbGZyZWRcIlxuICAgIHRoaXMuc2x1ZyA9IFwiSSBhbSB0aGUgYm9zcyDwn5KwISEhXCJcbiAgICB0aGlzLmlzQWRtaW4gPSB0cnVlXG4gICAgdGhpcy5hZG1pbk1lZGlhdG9yID0gbnVsbFxuICB9XG4gIHN0YXRpYyBnZXRJbnN0YW5jZSgpIHtcbiAgICBpZiAoIUFkbWluLmluc3RhbmNlKSB7XG4gICAgICBBZG1pbi5pbnN0YW5jZSA9IG5ldyBBZG1pbigpXG4gICAgfVxuICAgIHJldHVybiBBZG1pbi5pbnN0YW5jZVxuICB9XG5cbiAgZ2V0IGdldE1lc3NhZ2VzKCkge1xuICAgIHJldHVybiB0aGlzLmFkbWluTWVkaWF0b3I/Lm1lc3NhZ2VCb3hcbiAgfVxufVxuXG5mdW5jdGlvbiBpbml0KCkge1xuICBjb25zdCBsb2FkQWRtaW4gPSAoKSA9PiBuZXcgQWRtaW4oKVxuICBtZWRpYXRvckluaXQoKS5sb2FkTWVkaWF0b3IoKS5yZWdpc3Rlcihsb2FkQWRtaW4oKSlcbiAgcmV0dXJuIHtcbiAgICBhZG1pbjogbG9hZEFkbWluKCksXG4gIH1cbn1cblxuZXhwb3J0IHsgQWRtaW4sIGluaXQgfVxuIiwiaW1wb3J0IHsgQWRtaW4sIGluaXQgfSBmcm9tIFwiLi4vbW9kZWxzL2FkbWluXCJcbmltcG9ydCB7IFN0dWRlbnQgfSBmcm9tIFwiLi4vbW9kZWxzL3N0dWRlbnRcIlxuaW1wb3J0IHsgVGVhY2hlciB9IGZyb20gXCIuLi9tb2RlbHMvdGVhY2hlclwiXG5pbXBvcnQgeyBMaXN0VmlldyB9IGZyb20gXCIuL2xpc3Qtdmlld1wiXG5cbmV4cG9ydCBjbGFzcyBNb2RhbFZpZXc8VD4ge1xuICBwYXJlbnRFbGVtZW50OiBIVE1MRGl2RWxlbWVudFxuICBsaXN0OiBBcnJheTxhbnk+XG4gIGRhdGE6IFN0dWRlbnQgfCBUZWFjaGVyXG4gIHRpdGxlOiBzdHJpbmdcbiAgbGlzdFZpZXc6IExpc3RWaWV3PFQ+XG4gIHN1YlRpdGxlczogc3RyaW5nW11cbiAgY29uZmlybWF0aW9uVGV4dDogc3RyaW5nXG4gIGFkbWluOiBBZG1pblxuXG4gIGNvbnN0cnVjdG9yKFxuICAgIHBhcmVudEVsZW1lbnQ6IEhUTUxEaXZFbGVtZW50LFxuICAgIGxpc3Q6IGFueSxcbiAgICBkYXRhOiBTdHVkZW50IHwgVGVhY2hlcixcbiAgICB0aXRsZTogc3RyaW5nLFxuICAgIHN1YlRpdGxlczogc3RyaW5nW10sXG4gICkge1xuICAgIHRoaXMucGFyZW50RWxlbWVudCA9IHBhcmVudEVsZW1lbnRcbiAgICB0aGlzLmxpc3QgPSBsaXN0XG4gICAgdGhpcy5kYXRhID0gZGF0YVxuICAgIHRoaXMudGl0bGUgPSB0aXRsZVxuICAgIHRoaXMuc3ViVGl0bGVzID0gc3ViVGl0bGVzXG4gICAgdGhpcy5saXN0VmlldyA9IG5ldyBMaXN0VmlldyhcbiAgICAgIHRoaXMucGFyZW50RWxlbWVudCxcbiAgICAgIHRoaXMubGlzdCxcbiAgICAgIHRoaXMudGl0bGUsXG4gICAgICB0aGlzLnN1YlRpdGxlcyxcbiAgICAgIFwic3R1ZGVudFwiLFxuICAgIClcbiAgICB0aGlzLmNvbmZpcm1hdGlvblRleHQgPSBcIlwiXG4gICAgdGhpcy5hZG1pbiA9IGluaXQoKS5hZG1pblxuICB9XG5cbiAgdXBkYXRlVGV4dCh0ZXh0OiBzdHJpbmcpIHtcbiAgICB0aGlzLmNvbmZpcm1hdGlvblRleHQgPSB0ZXh0XG4gIH1cblxuICByZW5kZXIoKTogdm9pZCB7XG4gICAgY29uc3QgbW9kYWxXcmFwcGVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbFwiKSBhcyBIVE1MRExpc3RFbGVtZW50XG4gICAgbW9kYWxXcmFwcGVyLmNsYXNzTGlzdC5hZGQoXCJzaG93LW1vZGFsXCIpXG5cbiAgICBjb25zdCBodG1sID0gYFxuICAgIDxkaXYgY2xhc3M9XCJtb2RhbC1jb250YWluZXJcIj5cbiAgICAgICR7dGhpcy5saXN0Vmlldy5yZW5kZXJSYXdIdG1sKCl9XG4gICAgICAke3RoaXMuY29uZmlybWF0aW9uVGV4dH1cbiAgICAgIDxidXR0b24gY2xhc3M9XCJjbG9zZS1tb2RhbFwiPlxuICAgICAgICDinYxcbiAgICAgIDwvYnV0dG9uPlxuICAgIDwvZGl2PlxuICAgIGBcblxuICAgIG1vZGFsV3JhcHBlci5pbm5lckhUTUwgPSBodG1sXG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jbG9zZS1tb2RhbFwiKT8uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgIG1vZGFsV3JhcHBlci5jbGFzc0xpc3QucmVtb3ZlKFwic2hvdy1tb2RhbFwiKVxuICAgICAgbW9kYWxXcmFwcGVyLmlubmVySFRNTCA9IFwiXCJcbiAgICB9KVxuXG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5tb2RhbCB0Ym9keSB0clwiKS5mb3JFYWNoKCh0cjogYW55KSA9PiB7XG4gICAgICB0ci5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGV2ZW50OiBhbnkpID0+IHtcbiAgICAgICAgaWYgKFwic2VuZFwiIGluIHRoaXMuZGF0YSkge1xuICAgICAgICAgIGNvbnN0IGNvbmZpcm1hdGlvblRleHQgPSBgWW91IGhhdmUgbm93IGJlZW4gcmVnaXN0ZXJlZCB0byB0aGUgJHtldmVudC50YXJnZXQuaW5uZXJUZXh0fSBDb3Vyc2VgXG4gICAgICAgICAgdGhpcy5kYXRhLnNlbmQoY29uZmlybWF0aW9uVGV4dCkgLy8gc2VuZGluZyBmcm9tIHRoaXMgc3R1ZGVudCwgdG8gaXRzZWxmIGFuZCB0byBhZG1pblxuICAgICAgICAgIHRoaXMudXBkYXRlVGV4dChjb25maXJtYXRpb25UZXh0KVxuICAgICAgICAgIHRoaXMudXBkYXRlSHRtbCgpXG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgfSlcbiAgfVxuICB1cGRhdGVIdG1sKCkge1xuICAgIHRoaXMucmVuZGVyKClcbiAgICBpbml0KClcbiAgfVxufVxuIiwiaW1wb3J0IHsgRGlzcGxheUluZm8gfSBmcm9tIFwiLi4vdHlwZXNcIlxuY2xhc3MgQ291cnNlIHtcbiAgaWQ6IG51bWJlclxuICB0aXRsZTogc3RyaW5nXG4gIGRlc2NyaXB0aW9uOiBzdHJpbmdcbiAgZHVyYXRpb246IHN0cmluZ1xuXG4gIGNvbnN0cnVjdG9yKGlkOiBudW1iZXIsIHRpdGxlOiBzdHJpbmcsIGRlc2NyaXB0aW9uOiBzdHJpbmcsIGR1cmF0aW9uOiBzdHJpbmcpIHtcbiAgICB0aGlzLmlkID0gaWRcbiAgICB0aGlzLnRpdGxlID0gdGl0bGVcbiAgICB0aGlzLmRlc2NyaXB0aW9uID0gZGVzY3JpcHRpb25cbiAgICB0aGlzLmR1cmF0aW9uID0gZHVyYXRpb25cbiAgfVxuXG4gIGRpc3BsYXlJbmZvKCk6IERpc3BsYXlJbmZvIHtcbiAgICByZXR1cm4ge1xuICAgICAgdGl0bGU6IHRoaXMudGl0bGUsXG4gICAgICBkdXJhdGlvbjogdGhpcy5kdXJhdGlvbixcbiAgICB9XG4gIH1cbn1cblxuY29uc3QgbG9hZENvdXJzZXMgPSAoKTogQ291cnNlW10gPT4gW1xuICBuZXcgQ291cnNlKDEsIFwibWF0aFwiLCBcIm1hdGggaXMgd29uZGVyZnVsXCIsIFwiNmhcIiksXG4gIG5ldyBDb3Vyc2UoMiwgXCJoaXN0b3J5XCIsIFwiaGlzdG9yeSBpcyBnb29kIGZvciB5b3VcIiwgXCIzaFwiKSxcbiAgbmV3IENvdXJzZSgzLCBcInN3ZWRpc2hcIiwgXCJ3aXRob3V0IHN3ZWRpc2ggeW91IHdpbGwgZmFjZSBzb21lIHNlcmlvdXMgcHJvYmxlbXNcIiwgXCIyaFwiKSxcbiAgbmV3IENvdXJzZSg0LCBcImVuZ2xpc2hcIiwgXCJ0aGUgZ2xvYmFsIGxhbmd1YWdlLCBsZWFybiBpdCBOT1chISFcIiwgXCI1aFwiKSxcbl1cblxuZXhwb3J0IHsgQ291cnNlLCBsb2FkQ291cnNlcyB9XG4iLCJpbXBvcnQgeyBsb2FkU3R1ZGVudHMsIFN0dWRlbnQsIHJlZ2lzdGVyQWxsU3R1ZGVudHMgfSBmcm9tIFwiLi4vbW9kZWxzL3N0dWRlbnRcIlxuaW1wb3J0IHsgTGlzdFZpZXcgfSBmcm9tIFwiLi4vdmlld3MvbGlzdC12aWV3XCJcbmltcG9ydCB7IE1vZGFsVmlldyBhcyBDb3Vyc2VzTW9kYWxWaWV3IH0gZnJvbSBcIi4uL3ZpZXdzL21vZGFsLXZpZXdcIlxuaW1wb3J0IHsgbG9hZENvdXJzZXMgfSBmcm9tIFwiLi4vbW9kZWxzL2NvdXJzZVwiXG5pbXBvcnQgeyBQcm9maWxlVmlldyB9IGZyb20gXCIuLi92aWV3cy9wcm9maWxlLXZpZXdcIlxuXG5leHBvcnQgY2xhc3MgU3R1ZGVudENvbnRyb2xsZXIge1xuICBwYXJlbnRFbGVtZW50OiBIVE1MRGl2RWxlbWVudFxuICBzdHVkZW50c1ZpZXc6IExpc3RWaWV3PFN0dWRlbnQ+XG4gIGNvbnN0cnVjdG9yKHBhcmVudEVsZW1lbnQ6IEhUTUxEaXZFbGVtZW50KSB7XG4gICAgdGhpcy5wYXJlbnRFbGVtZW50ID0gcGFyZW50RWxlbWVudFxuICAgIHRoaXMuc3R1ZGVudHNWaWV3ID0gbmV3IExpc3RWaWV3KFxuICAgICAgdGhpcy5wYXJlbnRFbGVtZW50LFxuICAgICAgbG9hZFN0dWRlbnRzKCksXG4gICAgICBcIlN0dWRlbnRzXCIsXG4gICAgICBbXCJuYW1lXCIsIFwiZW1haWxcIiwgXCJhZ2VcIl0sXG4gICAgICBcInN0dWRlbnRcIixcbiAgICApXG4gIH1cblxuICBoYW5kbGVDbGlja1N0dWRlbnQoKTogdm9pZCB7XG4gICAgdGhpcy5zdHVkZW50c1ZpZXcuY2xpY2tIYW5kbGVyKChpZDogbnVtYmVyKSA9PiB7XG4gICAgICBjb25zdCBzdHVkZW50ID0gbG9hZFN0dWRlbnRzKCkuZmluZChzdHVkZW50ID0+IHN0dWRlbnQuaWQgPT09IGlkKVxuICAgICAgY29uc3QgZGF0YSA9IHN0dWRlbnQhIGFzIFN0dWRlbnRcbiAgICAgIGNvbnN0IGNvdXJzZXMgPSBsb2FkQ291cnNlcygpXG4gICAgICBjb25zdCBtb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWwtbGlzdFwiKSBhcyBIVE1MRGl2RWxlbWVudFxuICAgICAgbmV3IENvdXJzZXNNb2RhbFZpZXc8YW55W10+KG1vZGFsLCBjb3Vyc2VzLCBkYXRhLCBcImNvdXJzZXNcIiwgW1widGl0bGVcIiwgXCJkdXJhdGlvblwiXSkucmVuZGVyKClcbiAgICB9KVxuICB9XG5cbiAgaGFuZGxlU2hvd1Byb2ZpbGUoKTogdm9pZCB7XG4gICAgLy8gdGhpcy5wcm9maWxlVmlldy5jbGlja0hhbmRsZXIoKGlkOiBudW1iZXIpID0+IHtcbiAgICAvLyAgIGNvbnN0IHN0dWRlbnQgPSBsb2FkU3R1ZGVudHMoKS5maW5kKHN0dWRlbnQgPT4gc3R1ZGVudC5pZCA9PT0gaWQpXG4gICAgLy8gICBjb25zdCBkYXRhID0gc3R1ZGVudCEgYXMgU3R1ZGVudFxuICAgIC8vICAgY29uc3QgY291cnNlcyA9IGxvYWRDb3Vyc2VzKClcbiAgICAvLyAgIGNvbnN0IG1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbC1saXN0XCIpIGFzIEhUTUxEaXZFbGVtZW50XG4gICAgLy8gICBjb25zb2xlLmxvZyhcIm1vZGFsXCIsIG1vZGFsKVxuICAgIC8vIH0pXG4gIH1cblxuICBpbml0KCk6IHZvaWQge1xuICAgIHRoaXMuc3R1ZGVudHNWaWV3LmluaXQoKVxuICAgIHRoaXMuaGFuZGxlQ2xpY2tTdHVkZW50KClcbiAgICB0aGlzLmhhbmRsZVNob3dQcm9maWxlKClcbiAgICByZWdpc3RlckFsbFN0dWRlbnRzKClcbiAgfVxufVxuIiwiaW1wb3J0IHsgQWRtaW4sIGluaXQgfSBmcm9tIFwiLi4vbW9kZWxzL2FkbWluXCJcblxuZXhwb3J0IGNsYXNzIEFkbWluVmlldyB7XG4gIHBhcmVudEVsZW1lbnQ6IEhUTUxEaXZFbGVtZW50XG4gIGFkbWluOiBBZG1pblxuICBjb25zdHJ1Y3RvcihwYXJlbnRFbGVtZW50OiBIVE1MRGl2RWxlbWVudCkge1xuICAgIHRoaXMucGFyZW50RWxlbWVudCA9IHBhcmVudEVsZW1lbnRcbiAgICB0aGlzLmFkbWluID0gaW5pdCgpLmFkbWluXG4gIH1cblxuICByZW5kZXIoKTogdm9pZCB7XG4gICAgLy8gY29uc29sZS5sb2coXCJhZG1pblwiLCB0aGlzLmFkbWluLCB0aGlzLnBhcmVudEVsZW1lbnQpXG4gICAgY29uc3QgaHRtbCA9IGBcbiAgICAgIDxkaXYgY2xhc3M9XCJhZG1pbi13cmFwcGVyIHdyYXBwZXItJHt0aGlzLmFkbWluLmZpcnN0TmFtZX1cIj5cbiAgICAgICAgPGJ1dHRvbiBpZD1cImFkbWluLXByb2ZpbGUtYnRuXCIgY2xhc3M9XCJidXR0b25cIj5BZG1pbiBQcm9maWxlPC9idXR0b24+XG5cbiAgICAgICAgPGRpdiBjbGFzcz1cImFkbWluLWNvbnRlbnRcIj5cbiAgICAgICAgICA8aDM+IE1yIEFkbWluICR7dGhpcy5hZG1pbi5maXJzdE5hbWV9PC9oMz5cbiAgICAgICAgICA8cD4ke3RoaXMuYWRtaW4uc2x1Z308L3A+XG4gICAgICAgIDwvZGl2PlxuXG4gICAgICA8L2Rpdj5cbiAgICBgXG4gICAgdGhpcy5wYXJlbnRFbGVtZW50LmlubmVySFRNTCA9IGh0bWxcblxuICAgIGNvbnN0IGFkbWluQ29udGVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuYWRtaW4tY29udGVudFwiKSBhcyBIVE1MRGl2RWxlbWVudFxuICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYWRtaW4tcHJvZmlsZS1idG5cIik/LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICBhZG1pbkNvbnRlbnQuY2xhc3NMaXN0LnRvZ2dsZShcInNob3ctYWRtaW4tY29udGVudFwiKVxuICAgIH0pXG4gIH1cbn1cbiIsImltcG9ydCB7IEFkbWluVmlldyB9IGZyb20gXCIuLi92aWV3cy9hZG1pbi12aWV3XCJcblxuZXhwb3J0IGNsYXNzIEFkbWluQ29udHJvbGxlciB7XG4gIHBhcmVudEVsZW1lbnQ6IEhUTUxEaXZFbGVtZW50XG4gIGFkbWluVmlldzogQWRtaW5WaWV3XG4gIGNvbnN0cnVjdG9yKHBhcmVudEVsZW1lbnQ6IEhUTUxEaXZFbGVtZW50KSB7XG4gICAgdGhpcy5wYXJlbnRFbGVtZW50ID0gcGFyZW50RWxlbWVudFxuICAgIHRoaXMuYWRtaW5WaWV3ID0gbmV3IEFkbWluVmlldyh0aGlzLnBhcmVudEVsZW1lbnQpXG4gIH1cblxuICBpbml0KCk6IHZvaWQge1xuICAgIHRoaXMuYWRtaW5WaWV3LnJlbmRlcigpXG4gIH1cbn1cbiIsImltcG9ydCB7IEFwcCB9IGZyb20gXCIuL3BhdHRlcm5zL212YzIuMC9jb250cm9sbGVycy9hcHBcIlxuaW1wb3J0IHsgVGVhY2hlckNvbnRyb2xsZXIgfSBmcm9tIFwiLi9wYXR0ZXJucy9tdmMyLjAvY29udHJvbGxlcnMvdGVhY2hlclwiXG5pbXBvcnQgeyBTdHVkZW50Q29udHJvbGxlciB9IGZyb20gXCIuL3BhdHRlcm5zL212YzIuMC9jb250cm9sbGVycy9zdHVkZW50XCJcbmltcG9ydCB7IEFkbWluQ29udHJvbGxlciB9IGZyb20gXCIuL3BhdHRlcm5zL212YzIuMC9jb250cm9sbGVycy9hZG1pblwiXG47KCgpID0+IHtcbiAgbmV3IEFwcChcbiAgICBuZXcgVGVhY2hlckNvbnRyb2xsZXIoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ0ZWFjaGVyXCIpIGFzIEhUTUxEaXZFbGVtZW50KSxcbiAgICBuZXcgU3R1ZGVudENvbnRyb2xsZXIoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJzdHVkZW50XCIpIGFzIEhUTUxEaXZFbGVtZW50KSxcbiAgICBuZXcgQWRtaW5Db250cm9sbGVyKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYWRtaW5cIikgYXMgSFRNTERpdkVsZW1lbnQpLFxuICApLnJlbmRlcigpXG59KSgpXG4iXSwic291cmNlUm9vdCI6IiJ9