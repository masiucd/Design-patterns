(()=>{"use strict";var t,n=function(){function t(t,n,e){this.teacher=t,this.courses=n,this.students=e}return t.prototype.render=function(){this.teacher.init(),this.courses.init(),this.students.init()},t}(),e=function(){function t(t,n,e,i){this.parentElement=t,this.dataList=n,this.title=e,this.subTitles=i}return t.prototype.clickHandler=function(t){document.querySelectorAll("tr").forEach((function(n){return n.addEventListener("click",(function(){t(parseInt(n.dataset.id,10)),sessionStorage.setItem("user",String(n.dataset.id))}))}))},t.prototype.render=function(){var t='\n    <div class="table-wrapper wrapper-'+this.title+'">\n    <table class="'+this.title+'">\n        <caption>'+this.title+"</caption>\n        <thead>\n          "+this.subTitles.map((function(t){return"<th>"+t+"</th>"})).join("")+"\n        </thead>\n        <tbody>\n          "+this.dataList.map((function(t){var n=t.displayInfo();return'\n                <tr data-id="'+t.id+'">\n                '+Object.keys(n).map((function(t){return'<td data-info="'+n[t]+'">'+n[t]+"</td>"})).join("")+"\n                </tr>\n          "})).join("")+"\n        </tbody>\n      </table>\n    </div>\n    ";this.parentElement.innerHTML=t},t.prototype.renderRawHtml=function(){return'\n    <div class="table-wrapper wrapper-'+this.title+'">\n    <table>\n        <caption>'+this.title+"</caption>\n        <thead>\n          "+this.subTitles.map((function(t){return"<th>"+t+"</th>"})).join("")+"\n        </thead>\n        <tbody>\n          "+this.dataList.map((function(t){var n=t.displayInfo();return'\n                <tr data-id="'+t.id+'">\n                '+Object.keys(n).map((function(t){return"<td>"+n[t]+"</td>"})).join("")+"\n                </tr>\n          "})).join("")+"\n        </tbody>\n      </table>\n    </div>\n    "},t.prototype.mount=function(t){t.innerHTML=this.renderRawHtml()},t.prototype.init=function(){this.render()},t}(),i=function(){function t(){this.students={}}return t.prototype.registerStudent=function(t){this.students[t.firstName]=t,t.studentMediator=this},t.prototype.send=function(t,n,e){var i=this;e?e.receive(t,n):Object.keys(this.students).forEach((function(e){i.students[e]!==n&&i.students[e].receive(t,n)}))},t}(),o=function(){function t(){this.courses={}}return t.prototype.registerCourse=function(t){this.courses[t.title]=t,t.courseMediator=this},t.prototype.send=function(t,n,e){},t}(),r=function(){function t(t,n,e,i){this.id=t,this.title=n,this.description=e,this.duration=i,this.courseMediator=null}return t.prototype.displayInfo=function(){return{title:this.title,duration:this.duration}},t.prototype.send=function(){},t.prototype.receive=function(){},t}(),s=new o,a=function(){return[new r(1,"math","math is wonderful","6h"),new r(2,"history","history is good for you","3h"),new r(3,"swedish","without swedish you will face some serious problems","2h"),new r(4,"english","the global language, learn it NOW!!!","5h")]},u=function(){function t(t){this.parentElement=t,this.coursesView=new e(this.parentElement,a(),"Courses",["title","duration"])}return t.prototype.init=function(){this.coursesView.init(),function(){for(var t=0,n=a();t<n.length;t++){var e=n[t];s.registerCourse(e)}}()},t}(),c=function(t,n,e,i,o){this.id=t,this.firstName=n,this.lastName=e,this.email=i,this.age=o},l=(t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])})(n,e)},function(n,e){function i(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),d=function(t){function n(n,e,i,o,r){var s=t.call(this,n,e,i,o,r)||this;return s.subjects=[],s}return l(n,t),n.prototype.displayInfo=function(){return{name:this.firstName+"-"+this.lastName,email:this.email,age:""+this.age}},n}(c),h=function(){function t(t){this.parentElement=t,this.teachersView=new e(this.parentElement,[new d(1,"Frank","Smith","frank@io.com",43),new d(2,"Logan","Jonsson","logan@io.com",47),new d(3,"Mia","Greger","mia@io.com",41),new d(4,"Boris","Rooney","frank@io.com",53)],"Teachers",["name","email","age"])}return t.prototype.init=function(){this.teachersView.init()},t}(),f=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])})(n,e)};return function(n,e){function i(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}(),p=function(t){function n(n,e,i,o,r){var s=t.call(this,n,e,i,o,r)||this;return s.studentMediator=null,s}return f(n,t),n.prototype.displayInfo=function(){return{name:this.firstName+"-"+this.lastName,email:this.email,age:""+this.age}},n.prototype.send=function(t,n){var e;null===(e=this.studentMediator)||void 0===e||e.send(t,this,n)},n.prototype.receive=function(t,n){return t+" - from "+n},n}(c),m=new i,y=function(){return[new p(1,"Frank","Mellberg","frank@io.com",21),new p(2,"Rio","Ferdinand","rio@io.com",25),new p(3,"Nemanja","Vidic","nemanja@io.com",32),new p(4,"Fredrik","ljungberg","fredrik@io.com",32),new p(5,"Lotta","Schelin","lotta@io.com",21),new p(6,"Stina","Olofsson","sina@io.com",21)]},w=function(){function t(t,n,i,o,r){this.parentElement=t,this.list=n,this.data=i,this.title=o,this.subTitles=r,this.listView=new e(this.parentElement,this.list,this.title,this.subTitles)}return t.prototype.render=function(){var t,n=this,e=document.querySelector(".modal");e.classList.add("show-modal");var i='\n    <div class="modal-container">\n      '+this.listView.renderRawHtml()+'\n      <button class="close-modal">\n        ‚ùå\n      </button>\n    </div>\n    ';e.innerHTML=i,null===(t=document.querySelector(".close-modal"))||void 0===t||t.addEventListener("click",(function(){e.classList.remove("show-modal")})),document.querySelectorAll(".modal tbody tr").forEach((function(t){t.addEventListener("click",(function(e){console.log(e.target),console.log(e.target.innerText),t.dataset.id===String(n.data.id)&&"send"in n.data&&n.data.send("I am no registered to "+e.target.innerText)}))}))},t}(),g=function(){function t(t){this.parentElement=t,this.studentsView=new e(this.parentElement,y(),"Students",["name","email","age"])}return t.prototype.handleClickStudent=function(){this.studentsView.clickHandler((function(t){var n=y().find((function(n){return n.id===t})),e=a(),i=document.querySelector(".modal-list");new w(i,e,n,"courses",["title","duration"]).render()}))},t.prototype.init=function(){this.studentsView.init(),this.handleClickStudent(),function(){for(var t=0,n=y();t<n.length;t++){var e=n[t];m.registerStudent(e)}}(),console.log("studentMediator",m)},t}();new n(new h(document.getElementById("teacher")),new u(document.getElementById("course")),new g(document.getElementById("student"))).render()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zY2hvb2wtZGF0YS8uL3NyYy9wYXR0ZXJucy9tdmMyLjAvY29udHJvbGxlcnMvYXBwLnRzIiwid2VicGFjazovL3NjaG9vbC1kYXRhLy4vc3JjL3BhdHRlcm5zL212YzIuMC92aWV3cy9saXN0LXZpZXcudHMiLCJ3ZWJwYWNrOi8vc2Nob29sLWRhdGEvLi9zcmMvcGF0dGVybnMvbXZjMi4wL21vZGVscy9tZWRpYXRvci50cyIsIndlYnBhY2s6Ly9zY2hvb2wtZGF0YS8uL3NyYy9wYXR0ZXJucy9tdmMyLjAvbW9kZWxzL2NvdXJzZS50cyIsIndlYnBhY2s6Ly9zY2hvb2wtZGF0YS8uL3NyYy9wYXR0ZXJucy9tdmMyLjAvY29udHJvbGxlcnMvY291cnNlLnRzIiwid2VicGFjazovL3NjaG9vbC1kYXRhLy4vc3JjL3BhdHRlcm5zL212YzIuMC9tb2RlbHMvUGVyc29uLnRzIiwid2VicGFjazovL3NjaG9vbC1kYXRhLy4vc3JjL3BhdHRlcm5zL212YzIuMC9tb2RlbHMvdGVhY2hlci50cyIsIndlYnBhY2s6Ly9zY2hvb2wtZGF0YS8uL3NyYy9wYXR0ZXJucy9tdmMyLjAvY29udHJvbGxlcnMvdGVhY2hlci50cyIsIndlYnBhY2s6Ly9zY2hvb2wtZGF0YS8uL3NyYy9wYXR0ZXJucy9tdmMyLjAvbW9kZWxzL3N0dWRlbnQudHMiLCJ3ZWJwYWNrOi8vc2Nob29sLWRhdGEvLi9zcmMvcGF0dGVybnMvbXZjMi4wL3ZpZXdzL21vZGFsLXZpZXcudHMiLCJ3ZWJwYWNrOi8vc2Nob29sLWRhdGEvLi9zcmMvcGF0dGVybnMvbXZjMi4wL2NvbnRyb2xsZXJzL3N0dWRlbnQudHMiLCJ3ZWJwYWNrOi8vc2Nob29sLWRhdGEvLi9zcmMvaW5kZXgudHMiXSwibmFtZXMiOlsidGVhY2hlciIsImNvdXJzZXMiLCJzdHVkZW50cyIsInRoaXMiLCJyZW5kZXIiLCJpbml0IiwicGFyZW50RWxlbWVudCIsImRhdGFMaXN0IiwidGl0bGUiLCJzdWJUaXRsZXMiLCJjbGlja0hhbmRsZXIiLCJzdWJzY3JpYmVyIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yQWxsIiwiZm9yRWFjaCIsInRyIiwiYWRkRXZlbnRMaXN0ZW5lciIsInBhcnNlSW50IiwiZGF0YXNldCIsImlkIiwic2Vzc2lvblN0b3JhZ2UiLCJzZXRJdGVtIiwiU3RyaW5nIiwiaHRtbCIsIm1hcCIsInQiLCJqb2luIiwiZGF0YSIsImRpc3BsYXlJbmZvIiwiT2JqZWN0Iiwia2V5cyIsImtleSIsImlubmVySFRNTCIsInJlbmRlclJhd0h0bWwiLCJtb3VudCIsImVsZW1lbnQiLCJyZWdpc3RlclN0dWRlbnQiLCJzdHVkZW50IiwiZmlyc3ROYW1lIiwic3R1ZGVudE1lZGlhdG9yIiwic2VuZCIsIm1lc3NhZ2UiLCJmcm9tIiwidG8iLCJyZWNlaXZlIiwicmVnaXN0ZXJDb3Vyc2UiLCJjb3Vyc2UiLCJjb3Vyc2VNZWRpYXRvciIsImRlc2NyaXB0aW9uIiwiZHVyYXRpb24iLCJDb3Vyc2VNZWRpYXRvciIsImxvYWRDb3Vyc2VzIiwiQ291cnNlIiwiY291cnNlc1ZpZXciLCJMaXN0VmlldyIsInJlZ2lzdGVyQ291cnNlcyIsImxhc3ROYW1lIiwiZW1haWwiLCJhZ2UiLCJzdWJqZWN0cyIsIm5hbWUiLCJQZXJzb24iLCJ0ZWFjaGVyc1ZpZXciLCJUZWFjaGVyIiwiU3R1ZGVudE1lZGlhdG9yIiwibG9hZFN0dWRlbnRzIiwiU3R1ZGVudCIsImxpc3QiLCJsaXN0VmlldyIsIm1vZGFsV3JhcHBlciIsInF1ZXJ5U2VsZWN0b3IiLCJjbGFzc0xpc3QiLCJhZGQiLCJyZW1vdmUiLCJldmVudCIsImNvbnNvbGUiLCJsb2ciLCJ0YXJnZXQiLCJpbm5lclRleHQiLCJzdHVkZW50c1ZpZXciLCJoYW5kbGVDbGlja1N0dWRlbnQiLCJmaW5kIiwibW9kYWwiLCJyZWdpc3RlckFsbFN0dWRlbnRzIiwiQXBwIiwiVGVhY2hlckNvbnRyb2xsZXIiLCJnZXRFbGVtZW50QnlJZCIsIkNvdXJzZUNvbnRyb2xsZXIiLCJTdHVkZW50Q29udHJvbGxlciJdLCJtYXBwaW5ncyI6Im1CQUlBLEksRUFBQSxhQUlFLFdBQVlBLEVBQTRCQyxFQUEyQkMsR0FDakVDLEtBQUtILFFBQVVBLEVBQ2ZHLEtBQUtGLFFBQVVBLEVBQ2ZFLEtBQUtELFNBQVdBLEVBUXBCLE9BTEUsWUFBQUUsT0FBQSxXQUNFRCxLQUFLSCxRQUFRSyxPQUNiRixLQUFLRixRQUFRSSxPQUNiRixLQUFLRCxTQUFTRyxRQUVsQixFQWZBLEdDREEsYUFLRSxXQUNFQyxFQUNBQyxFQUNBQyxFQUNBQyxHQUVBTixLQUFLRyxjQUFnQkEsRUFDckJILEtBQUtJLFNBQVdBLEVBQ2hCSixLQUFLSyxNQUFRQSxFQUNiTCxLQUFLTSxVQUFZQSxFQTRFckIsT0F6RUUsWUFBQUMsYUFBQSxTQUFhQyxHQUNDQyxTQUFTQyxpQkFBaUIsTUFDbENDLFNBQVEsU0FBQUMsR0FDVixPQUFBQSxFQUFHQyxpQkFBaUIsU0FBUyxXQUMzQkwsRUFBV00sU0FBU0YsRUFBR0csUUFBUUMsR0FBSyxLQUNwQ0MsZUFBZUMsUUFBUSxPQUFRQyxPQUFPUCxFQUFHRyxRQUFRQyxZQUsvQyxZQUFBZixPQUFSLFdBQ0UsSUFBTW1CLEVBQU8sMkNBQ3VCcEIsS0FBS0ssTUFBSyx5QkFDOUJMLEtBQUtLLE1BQUssd0JBQ1hMLEtBQUtLLE1BQUssMENBRWpCTCxLQUFLTSxVQUFVZSxLQUFJLFNBQUFDLEdBQUssYUFBT0EsRUFBQyxXQUFTQyxLQUFLLElBQUcsa0RBR2hEdkIsS0FBS0ksU0FDTGlCLEtBQUksU0FBQ0csR0FDSixJQUFNQyxFQUFjRCxFQUFLQyxjQUN6QixNQUFPLGtDQUNVRCxFQUFLUixHQUFFLHVCQUNwQlUsT0FBT0MsS0FBS0YsR0FDWEosS0FBSSxTQUFBTyxHQUFPLHdCQUFrQkgsRUFBWUcsR0FBSSxLQUFLSCxFQUFZRyxHQUFJLFdBQ2xFTCxLQUFLLElBQUcseUNBSWRBLEtBQUssSUFBRyx1REFLakJ2QixLQUFLRyxjQUFjMEIsVUFBWVQsR0FHakMsWUFBQVUsY0FBQSxXQXlCRSxNQXhCYSwyQ0FDdUI5QixLQUFLSyxNQUFLLHFDQUUvQkwsS0FBS0ssTUFBSywwQ0FFakJMLEtBQUtNLFVBQVVlLEtBQUksU0FBQUMsR0FBSyxhQUFPQSxFQUFDLFdBQVNDLEtBQUssSUFBRyxrREFHaER2QixLQUFLSSxTQUNMaUIsS0FBSSxTQUFDRyxHQUNKLElBQU1DLEVBQWNELEVBQUtDLGNBQ3pCLE1BQU8sa0NBQ1VELEVBQUtSLEdBQUUsdUJBQ3BCVSxPQUFPQyxLQUFLRixHQUNYSixLQUFJLFNBQUFPLEdBQU8sYUFBT0gsRUFBWUcsR0FBSSxXQUNsQ0wsS0FBSyxJQUFHLHlDQUlkQSxLQUFLLElBQUcsd0RBUW5CLFlBQUFRLE1BQUEsU0FBTUMsR0FDSkEsRUFBUUgsVUFBWTdCLEtBQUs4QixpQkFHM0IsWUFBQTVCLEtBQUEsV0FDRUYsS0FBS0MsVUFFVCxFQTFGQSxHQ0FBLGFBRUUsYUFDRUQsS0FBS0QsU0FBVyxHQW1CcEIsT0FoQkUsWUFBQWtDLGdCQUFBLFNBQWdCQyxHQUNkbEMsS0FBS0QsU0FBU21DLEVBQVFDLFdBQWFELEVBQ25DQSxFQUFRRSxnQkFBa0JwQyxNQUc1QixZQUFBcUMsS0FBQSxTQUFLQyxFQUFpQkMsRUFBZUMsR0FBckMsV0FDTUEsRUFDRkEsRUFBR0MsUUFBUUgsRUFBU0MsR0FFcEJiLE9BQU9DLEtBQUszQixLQUFLRCxVQUFVWSxTQUFRLFNBQUFpQixHQUM3QixFQUFLN0IsU0FBUzZCLEtBQVNXLEdBQ3pCLEVBQUt4QyxTQUFTNkIsR0FBS2EsUUFBUUgsRUFBU0MsT0FLOUMsRUF0QkEsR0F1QkEsYUFFRSxhQUNFdkMsS0FBS0YsUUFBVSxHQVduQixPQVJFLFlBQUE0QyxlQUFBLFNBQWVDLEdBQ2IzQyxLQUFLRixRQUFRNkMsRUFBT3RDLE9BQVNzQyxFQUM3QkEsRUFBT0MsZUFBaUI1QyxNQUcxQixZQUFBcUMsS0FBQSxTQUFLQyxFQUFpQkMsRUFBY0MsS0FHdEMsRUFkQSxHQ3hCQSxhQU1FLFdBQVl4QixFQUFZWCxFQUFld0MsRUFBcUJDLEdBQzFEOUMsS0FBS2dCLEdBQUtBLEVBQ1ZoQixLQUFLSyxNQUFRQSxFQUNiTCxLQUFLNkMsWUFBY0EsRUFDbkI3QyxLQUFLOEMsU0FBV0EsRUFDaEI5QyxLQUFLNEMsZUFBaUIsS0FXMUIsT0FSRSxZQUFBbkIsWUFBQSxXQUNFLE1BQU8sQ0FDTHBCLE1BQU9MLEtBQUtLLE1BQ1p5QyxTQUFVOUMsS0FBSzhDLFdBR25CLFlBQUFULEtBQUEsYUFDQSxZQUFBSSxRQUFBLGFBQ0YsRUF0QkEsR0F3Qk1HLEVBQWlCLElBQUlHLEVBRXJCQyxFQUFjLFdBQWdCLE9BQ2xDLElBQUlDLEVBQU8sRUFBRyxPQUFRLG9CQUFxQixNQUMzQyxJQUFJQSxFQUFPLEVBQUcsVUFBVywwQkFBMkIsTUFDcEQsSUFBSUEsRUFBTyxFQUFHLFVBQVcsc0RBQXVELE1BQ2hGLElBQUlBLEVBQU8sRUFBRyxVQUFXLHVDQUF3QyxRQzdCbkUsYUFHRSxXQUFZOUMsR0FDVkgsS0FBS0csY0FBZ0JBLEVBQ3JCSCxLQUFLa0QsWUFBYyxJQUFJQyxFQUFTbkQsS0FBS0csY0FBZTZDLElBQWUsVUFBVyxDQUM1RSxRQUNBLGFBUU4sT0FKRSxZQUFBOUMsS0FBQSxXQUNFRixLQUFLa0QsWUFBWWhELE9Eb0JHLFdBQ3RCLElBQW1CLFVBQUE4QyxJQUFBLGVBQWUsQ0FBN0IsSUFBSUwsRUFBTSxLQUNiQyxFQUFlRixlQUFlQyxJQ3JCOUJTLElBRUosRUFmQSxHQ0hBLEVBTUUsU0FBWXBDLEVBQVltQixFQUFtQmtCLEVBQWtCQyxFQUFlQyxHQUMxRXZELEtBQUtnQixHQUFLQSxFQUNWaEIsS0FBS21DLFVBQVlBLEVBQ2pCbkMsS0FBS3FELFNBQVdBLEVBQ2hCckQsS0FBS3NELE1BQVFBLEVBQ2J0RCxLQUFLdUQsSUFBTUEsRywwVUNQZixjQUVFLFdBQVl2QyxFQUFZbUIsRUFBbUJrQixFQUFrQkMsRUFBZUMsR0FBNUUsTUFDRSxZQUFNdkMsRUFBSW1CLEVBQVdrQixFQUFVQyxFQUFPQyxJQUFJLEssT0FDMUMsRUFBS0MsU0FBVyxHLEVBVXBCLE9BZDZCLE9BTzNCLFlBQUEvQixZQUFBLFdBQ0UsTUFBTyxDQUNMZ0MsS0FBU3pELEtBQUttQyxVQUFTLElBQUluQyxLQUFLcUQsU0FDaENDLE1BQU90RCxLQUFLc0QsTUFDWkMsSUFBSyxHQUFHdkQsS0FBS3VELE1BR25CLEVBZEEsQ0FBNkJHLEdDRDdCLGFBR0UsV0FBWXZELEdBQ1ZILEtBQUtHLGNBQWdCQSxFQUNyQkgsS0FBSzJELGFBQWUsSUFBSVIsRUFBU25ELEtBQUtHLGNEWVIsQ0FDaEMsSUFBSXlELEVBQVEsRUFBRyxRQUFTLFFBQVMsZUFBZ0IsSUFDakQsSUFBSUEsRUFBUSxFQUFHLFFBQVMsVUFBVyxlQUFnQixJQUNuRCxJQUFJQSxFQUFRLEVBQUcsTUFBTyxTQUFVLGFBQWMsSUFDOUMsSUFBSUEsRUFBUSxFQUFHLFFBQVMsU0FBVSxlQUFnQixLQ2hCcUIsV0FBWSxDQUMvRSxPQUNBLFFBQ0EsUUFPTixPQUhFLFlBQUExRCxLQUFBLFdBQ0VGLEtBQUsyRCxhQUFhekQsUUFFdEIsRUFmQSxHLGlXQ0NBLGNBRUUsV0FBWWMsRUFBWW1CLEVBQW1Ca0IsRUFBa0JDLEVBQWVDLEdBQTVFLE1BQ0UsWUFBTXZDLEVBQUltQixFQUFXa0IsRUFBVUMsRUFBT0MsSUFBSSxLLE9BQzFDLEVBQUtuQixnQkFBa0IsSyxFQWUzQixPQW5Cc0IsT0FNcEIsWUFBQVgsWUFBQSxXQUNFLE1BQU8sQ0FDTGdDLEtBQVN6RCxLQUFLbUMsVUFBUyxJQUFJbkMsS0FBS3FELFNBQ2hDQyxNQUFPdEQsS0FBS3NELE1BQ1pDLElBQUssR0FBR3ZELEtBQUt1RCxNQUdqQixZQUFBbEIsS0FBQSxTQUFLQyxFQUFpQkUsRyxNQUNBLFFBQXBCLEVBQUF4QyxLQUFLb0MsdUJBQWUsU0FBRUMsS0FBS0MsRUFBU3RDLEtBQU13QyxJQUU1QyxZQUFBQyxRQUFBLFNBQVFILEVBQWlCQyxHQUN2QixPQUFVRCxFQUFPLFdBQVdDLEdBRWhDLEVBbkJBLENBQXNCbUIsR0FxQmhCdEIsRUFBa0IsSUFBSXlCLEVBRXRCQyxFQUFlLFdBQU0sT0FDekIsSUFBSUMsRUFBUSxFQUFHLFFBQVMsV0FBWSxlQUFnQixJQUNwRCxJQUFJQSxFQUFRLEVBQUcsTUFBTyxZQUFhLGFBQWMsSUFDakQsSUFBSUEsRUFBUSxFQUFHLFVBQVcsUUFBUyxpQkFBa0IsSUFDckQsSUFBSUEsRUFBUSxFQUFHLFVBQVcsWUFBYSxpQkFBa0IsSUFDekQsSUFBSUEsRUFBUSxFQUFHLFFBQVMsVUFBVyxlQUFnQixJQUNuRCxJQUFJQSxFQUFRLEVBQUcsUUFBUyxXQUFZLGNBQWUsTUM3QnJELGFBT0UsV0FDRTVELEVBQ0E2RCxFQUNBeEMsRUFDQW5CLEVBQ0FDLEdBRUFOLEtBQUtHLGNBQWdCQSxFQUNyQkgsS0FBS2dFLEtBQU9BLEVBQ1poRSxLQUFLd0IsS0FBT0EsRUFDWnhCLEtBQUtLLE1BQVFBLEVBQ2JMLEtBQUtNLFVBQVlBLEVBQ2pCTixLQUFLaUUsU0FBVyxJQUFJZCxFQUFTbkQsS0FBS0csY0FBZUgsS0FBS2dFLEtBQU1oRSxLQUFLSyxNQUFPTCxLQUFLTSxXQXlDakYsT0F0Q0UsWUFBQUwsT0FBQSxlLEVBQUEsT0FDUWlFLEVBQWV6RCxTQUFTMEQsY0FBYyxVQUM1Q0QsRUFBYUUsVUFBVUMsSUFBSSxjQUUzQixJQUFNakQsRUFBTyw4Q0FFVHBCLEtBQUtpRSxTQUFTbkMsZ0JBQWUscUZBT2pDb0MsRUFBYXJDLFVBQVlULEVBQ2EsUUFBdEMsRUFBQVgsU0FBUzBELGNBQWMsdUJBQWUsU0FBRXRELGlCQUFpQixTQUFTLFdBQ2hFcUQsRUFBYUUsVUFBVUUsT0FBTyxpQkFHcEI3RCxTQUFTQyxpQkFBaUIsbUJBQW1CQyxTQUFRLFNBQUNDLEdBQ2hFQSxFQUFHQyxpQkFBaUIsU0FBUyxTQUFDMEQsR0FDNUJDLFFBQVFDLElBQUlGLEVBQU1HLFFBQ2xCRixRQUFRQyxJQUFJRixFQUFNRyxPQUFPQyxXQUNyQi9ELEVBQUdHLFFBQVFDLEtBQU9HLE9BQU8sRUFBS0ssS0FBS1IsS0FDakMsU0FBVSxFQUFLUSxNQUNqQixFQUFLQSxLQUFLYSxLQUFLLHlCQUF5QmtDLEVBQU1HLE9BQU9DLGtCQWNqRSxFQTVEQSxHQ0NBLGFBR0UsV0FBWXhFLEdBQ1ZILEtBQUtHLGNBQWdCQSxFQUNyQkgsS0FBSzRFLGFBQWUsSUFBSXpCLEVBQVNuRCxLQUFLRyxjQUFlMkQsSUFBZ0IsV0FBWSxDQUMvRSxPQUNBLFFBQ0EsUUF3Qk4sT0FwQkUsWUFBQWUsbUJBQUEsV0FDRTdFLEtBQUs0RSxhQUFhckUsY0FBYSxTQUFDUyxHQUM5QixJQUNNUSxFQURVc0MsSUFBZWdCLE1BQUssU0FBQTVDLEdBQVcsT0FBQUEsRUFBUWxCLEtBQU9BLEtBR3hEbEIsRUFBVWtELElBQ1YrQixFQUFRdEUsU0FBUzBELGNBQWMsZUFDckMsSUFBSSxFQUFpQ1ksRUFBT2pGLEVBQVMwQixFQUFNLFVBQVcsQ0FDcEUsUUFDQSxhQUNDdkIsYUFJUCxZQUFBQyxLQUFBLFdBQ0VGLEtBQUs0RSxhQUFhMUUsT0FDbEJGLEtBQUs2RSxxQkZHbUIsV0FDMUIsSUFBb0IsVUFBQWYsSUFBQSxlQUFnQixDQUEvQixJQUFJNUIsRUFBTyxLQUNkRSxFQUFnQkgsZ0JBQWdCQyxJRUpoQzhDLEdBQ0FSLFFBQVFDLElBQUksa0JBQW1CckMsSUFFbkMsRUFoQ0EsR0NLRSxJQUFJNkMsRUFDRixJQUFJQyxFQUFrQnpFLFNBQVMwRSxlQUFlLFlBQzlDLElBQUlDLEVBQWlCM0UsU0FBUzBFLGVBQWUsV0FDN0MsSUFBSUUsRUFBa0I1RSxTQUFTMEUsZUFBZSxhQUM5Q2xGLFUiLCJmaWxlIjoiYnVuZGxlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgVGVhY2hlckNvbnRyb2xsZXIgfSBmcm9tIFwiLi90ZWFjaGVyXCJcbmltcG9ydCB7IENvdXJzZUNvbnRyb2xsZXIgfSBmcm9tIFwiLi9jb3Vyc2VcIlxuaW1wb3J0IHsgU3R1ZGVudENvbnRyb2xsZXIgfSBmcm9tIFwiLi9zdHVkZW50XCJcblxuZXhwb3J0IGNsYXNzIEFwcCB7XG4gIHRlYWNoZXI6IFRlYWNoZXJDb250cm9sbGVyXG4gIGNvdXJzZXM6IENvdXJzZUNvbnRyb2xsZXJcbiAgc3R1ZGVudHM6IFN0dWRlbnRDb250cm9sbGVyXG4gIGNvbnN0cnVjdG9yKHRlYWNoZXI6IFRlYWNoZXJDb250cm9sbGVyLCBjb3Vyc2VzOiBDb3Vyc2VDb250cm9sbGVyLCBzdHVkZW50czogU3R1ZGVudENvbnRyb2xsZXIpIHtcbiAgICB0aGlzLnRlYWNoZXIgPSB0ZWFjaGVyXG4gICAgdGhpcy5jb3Vyc2VzID0gY291cnNlc1xuICAgIHRoaXMuc3R1ZGVudHMgPSBzdHVkZW50c1xuICB9XG5cbiAgcmVuZGVyKCk6IHZvaWQge1xuICAgIHRoaXMudGVhY2hlci5pbml0KClcbiAgICB0aGlzLmNvdXJzZXMuaW5pdCgpXG4gICAgdGhpcy5zdHVkZW50cy5pbml0KClcbiAgfVxufVxuIiwiaW1wb3J0IHsgQ291cnNlIH0gZnJvbSBcIi4uLy4uL212Yy9tb2RlbHMvY291cnNlLW1vZGVsXCJcbmltcG9ydCB7IFRlYWNoZXIgfSBmcm9tIFwiLi4vbW9kZWxzL3RlYWNoZXJcIlxuXG5leHBvcnQgY2xhc3MgTGlzdFZpZXc8VD4ge1xuICBwYXJlbnRFbGVtZW50OiBIVE1MRGl2RWxlbWVudFxuICBkYXRhTGlzdDogQXJyYXk8VD5cbiAgdGl0bGU6IHN0cmluZ1xuICBzdWJUaXRsZXM6IHN0cmluZ1tdXG4gIGNvbnN0cnVjdG9yKFxuICAgIHBhcmVudEVsZW1lbnQ6IEhUTUxEaXZFbGVtZW50LFxuICAgIGRhdGFMaXN0OiBBcnJheTxUPixcbiAgICB0aXRsZTogc3RyaW5nLFxuICAgIHN1YlRpdGxlczogc3RyaW5nW11cbiAgKSB7XG4gICAgdGhpcy5wYXJlbnRFbGVtZW50ID0gcGFyZW50RWxlbWVudFxuICAgIHRoaXMuZGF0YUxpc3QgPSBkYXRhTGlzdFxuICAgIHRoaXMudGl0bGUgPSB0aXRsZVxuICAgIHRoaXMuc3ViVGl0bGVzID0gc3ViVGl0bGVzXG4gIH1cblxuICBjbGlja0hhbmRsZXIoc3Vic2NyaWJlcjogRnVuY3Rpb24pIHtcbiAgICBjb25zdCB0cnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwidHJcIilcbiAgICB0cnMuZm9yRWFjaCh0ciA9PlxuICAgICAgdHIuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgICAgc3Vic2NyaWJlcihwYXJzZUludCh0ci5kYXRhc2V0LmlkISwgMTApKVxuICAgICAgICBzZXNzaW9uU3RvcmFnZS5zZXRJdGVtKFwidXNlclwiLCBTdHJpbmcodHIuZGF0YXNldC5pZCkpXG4gICAgICB9KVxuICAgIClcbiAgfVxuXG4gIHByaXZhdGUgcmVuZGVyKCk6IHZvaWQge1xuICAgIGNvbnN0IGh0bWwgPSBgXG4gICAgPGRpdiBjbGFzcz1cInRhYmxlLXdyYXBwZXIgd3JhcHBlci0ke3RoaXMudGl0bGV9XCI+XG4gICAgPHRhYmxlIGNsYXNzPVwiJHt0aGlzLnRpdGxlfVwiPlxuICAgICAgICA8Y2FwdGlvbj4ke3RoaXMudGl0bGV9PC9jYXB0aW9uPlxuICAgICAgICA8dGhlYWQ+XG4gICAgICAgICAgJHt0aGlzLnN1YlRpdGxlcy5tYXAodCA9PiBgPHRoPiR7dH08L3RoPmApLmpvaW4oXCJcIil9XG4gICAgICAgIDwvdGhlYWQ+XG4gICAgICAgIDx0Ym9keT5cbiAgICAgICAgICAkeyh0aGlzLmRhdGFMaXN0IGFzIEFycmF5PFQ+KVxuICAgICAgICAgICAgLm1hcCgoZGF0YTogYW55KSA9PiB7XG4gICAgICAgICAgICAgIGNvbnN0IGRpc3BsYXlJbmZvID0gZGF0YS5kaXNwbGF5SW5mbygpIGFzIHsgW2tleTogc3RyaW5nXTogc3RyaW5nIH1cbiAgICAgICAgICAgICAgcmV0dXJuIGBcbiAgICAgICAgICAgICAgICA8dHIgZGF0YS1pZD1cIiR7ZGF0YS5pZH1cIj5cbiAgICAgICAgICAgICAgICAke09iamVjdC5rZXlzKGRpc3BsYXlJbmZvKVxuICAgICAgICAgICAgICAgICAgLm1hcChrZXkgPT4gYDx0ZCBkYXRhLWluZm89XCIke2Rpc3BsYXlJbmZvW2tleV19XCI+JHtkaXNwbGF5SW5mb1trZXldfTwvdGQ+YClcbiAgICAgICAgICAgICAgICAgIC5qb2luKFwiXCIpfVxuICAgICAgICAgICAgICAgIDwvdHI+XG4gICAgICAgICAgYFxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5qb2luKFwiXCIpfVxuICAgICAgICA8L3Rib2R5PlxuICAgICAgPC90YWJsZT5cbiAgICA8L2Rpdj5cbiAgICBgXG4gICAgdGhpcy5wYXJlbnRFbGVtZW50LmlubmVySFRNTCA9IGh0bWxcbiAgfVxuXG4gIHJlbmRlclJhd0h0bWwoKTogc3RyaW5nIHtcbiAgICBjb25zdCBodG1sID0gYFxuICAgIDxkaXYgY2xhc3M9XCJ0YWJsZS13cmFwcGVyIHdyYXBwZXItJHt0aGlzLnRpdGxlfVwiPlxuICAgIDx0YWJsZT5cbiAgICAgICAgPGNhcHRpb24+JHt0aGlzLnRpdGxlfTwvY2FwdGlvbj5cbiAgICAgICAgPHRoZWFkPlxuICAgICAgICAgICR7dGhpcy5zdWJUaXRsZXMubWFwKHQgPT4gYDx0aD4ke3R9PC90aD5gKS5qb2luKFwiXCIpfVxuICAgICAgICA8L3RoZWFkPlxuICAgICAgICA8dGJvZHk+XG4gICAgICAgICAgJHsodGhpcy5kYXRhTGlzdCBhcyBBcnJheTxhbnk+KVxuICAgICAgICAgICAgLm1hcCgoZGF0YTogYW55KSA9PiB7XG4gICAgICAgICAgICAgIGNvbnN0IGRpc3BsYXlJbmZvID0gZGF0YS5kaXNwbGF5SW5mbygpIGFzIHsgW2tleTogc3RyaW5nXTogc3RyaW5nIH1cbiAgICAgICAgICAgICAgcmV0dXJuIGBcbiAgICAgICAgICAgICAgICA8dHIgZGF0YS1pZD1cIiR7ZGF0YS5pZH1cIj5cbiAgICAgICAgICAgICAgICAke09iamVjdC5rZXlzKGRpc3BsYXlJbmZvKVxuICAgICAgICAgICAgICAgICAgLm1hcChrZXkgPT4gYDx0ZD4ke2Rpc3BsYXlJbmZvW2tleV19PC90ZD5gKVxuICAgICAgICAgICAgICAgICAgLmpvaW4oXCJcIil9XG4gICAgICAgICAgICAgICAgPC90cj5cbiAgICAgICAgICBgXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmpvaW4oXCJcIil9XG4gICAgICAgIDwvdGJvZHk+XG4gICAgICA8L3RhYmxlPlxuICAgIDwvZGl2PlxuICAgIGBcbiAgICByZXR1cm4gaHRtbFxuICB9XG5cbiAgbW91bnQoZWxlbWVudDogSFRNTEVsZW1lbnQpIHtcbiAgICBlbGVtZW50LmlubmVySFRNTCA9IHRoaXMucmVuZGVyUmF3SHRtbCgpXG4gIH1cblxuICBpbml0KCk6IHZvaWQge1xuICAgIHRoaXMucmVuZGVyKClcbiAgfVxufVxuIiwiaW1wb3J0IHsgQ291cnNlIH0gZnJvbSBcIi4vY291cnNlXCJcbmltcG9ydCB7IFN0dWRlbnQgfSBmcm9tIFwiLi9zdHVkZW50XCJcblxuY2xhc3MgU3R1ZGVudE1lZGlhdG9yIHtcbiAgc3R1ZGVudHM6IFJlY29yZDxzdHJpbmcsIFN0dWRlbnQ+XG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMuc3R1ZGVudHMgPSB7fVxuICB9XG5cbiAgcmVnaXN0ZXJTdHVkZW50KHN0dWRlbnQ6IFN0dWRlbnQpIHtcbiAgICB0aGlzLnN0dWRlbnRzW3N0dWRlbnQuZmlyc3ROYW1lXSA9IHN0dWRlbnRcbiAgICBzdHVkZW50LnN0dWRlbnRNZWRpYXRvciA9IHRoaXNcbiAgfVxuXG4gIHNlbmQobWVzc2FnZTogc3RyaW5nLCBmcm9tOiBTdHVkZW50LCB0bz86IFN0dWRlbnQpIHtcbiAgICBpZiAodG8pIHtcbiAgICAgIHRvLnJlY2VpdmUobWVzc2FnZSwgZnJvbSlcbiAgICB9IGVsc2Uge1xuICAgICAgT2JqZWN0LmtleXModGhpcy5zdHVkZW50cykuZm9yRWFjaChrZXkgPT4ge1xuICAgICAgICBpZiAodGhpcy5zdHVkZW50c1trZXldICE9PSBmcm9tKSB7XG4gICAgICAgICAgdGhpcy5zdHVkZW50c1trZXldLnJlY2VpdmUobWVzc2FnZSwgZnJvbSlcbiAgICAgICAgfVxuICAgICAgfSlcbiAgICB9XG4gIH1cbn1cbmNsYXNzIENvdXJzZU1lZGlhdG9yIHtcbiAgY291cnNlczogUmVjb3JkPHN0cmluZywgQ291cnNlPlxuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLmNvdXJzZXMgPSB7fVxuICB9XG5cbiAgcmVnaXN0ZXJDb3Vyc2UoY291cnNlOiBDb3Vyc2UpIHtcbiAgICB0aGlzLmNvdXJzZXNbY291cnNlLnRpdGxlXSA9IGNvdXJzZVxuICAgIGNvdXJzZS5jb3Vyc2VNZWRpYXRvciA9IHRoaXNcbiAgfVxuXG4gIHNlbmQobWVzc2FnZTogc3RyaW5nLCBmcm9tOiBDb3Vyc2UsIHRvPzogQ291cnNlKSB7XG4gICAgLy9cbiAgfVxufVxuXG5leHBvcnQgeyBTdHVkZW50TWVkaWF0b3IsIENvdXJzZU1lZGlhdG9yIH1cbiIsImltcG9ydCB7IENvdXJzZU1lZGlhdG9yIH0gZnJvbSBcIi4vbWVkaWF0b3JcIlxuaW1wb3J0IHsgRGlzcGxheUluZm8gfSBmcm9tIFwiLi4vdHlwZXNcIlxuY2xhc3MgQ291cnNlIHtcbiAgaWQ6IG51bWJlclxuICB0aXRsZTogc3RyaW5nXG4gIGRlc2NyaXB0aW9uOiBzdHJpbmdcbiAgZHVyYXRpb246IHN0cmluZ1xuICBjb3Vyc2VNZWRpYXRvcjogbnVsbCB8IENvdXJzZU1lZGlhdG9yXG4gIGNvbnN0cnVjdG9yKGlkOiBudW1iZXIsIHRpdGxlOiBzdHJpbmcsIGRlc2NyaXB0aW9uOiBzdHJpbmcsIGR1cmF0aW9uOiBzdHJpbmcpIHtcbiAgICB0aGlzLmlkID0gaWRcbiAgICB0aGlzLnRpdGxlID0gdGl0bGVcbiAgICB0aGlzLmRlc2NyaXB0aW9uID0gZGVzY3JpcHRpb25cbiAgICB0aGlzLmR1cmF0aW9uID0gZHVyYXRpb25cbiAgICB0aGlzLmNvdXJzZU1lZGlhdG9yID0gbnVsbFxuICB9XG5cbiAgZGlzcGxheUluZm8oKTogRGlzcGxheUluZm8ge1xuICAgIHJldHVybiB7XG4gICAgICB0aXRsZTogdGhpcy50aXRsZSxcbiAgICAgIGR1cmF0aW9uOiB0aGlzLmR1cmF0aW9uLFxuICAgIH1cbiAgfVxuICBzZW5kKCkge31cbiAgcmVjZWl2ZSgpIHt9XG59XG5cbmNvbnN0IGNvdXJzZU1lZGlhdG9yID0gbmV3IENvdXJzZU1lZGlhdG9yKClcblxuY29uc3QgbG9hZENvdXJzZXMgPSAoKTogQ291cnNlW10gPT4gW1xuICBuZXcgQ291cnNlKDEsIFwibWF0aFwiLCBcIm1hdGggaXMgd29uZGVyZnVsXCIsIFwiNmhcIiksXG4gIG5ldyBDb3Vyc2UoMiwgXCJoaXN0b3J5XCIsIFwiaGlzdG9yeSBpcyBnb29kIGZvciB5b3VcIiwgXCIzaFwiKSxcbiAgbmV3IENvdXJzZSgzLCBcInN3ZWRpc2hcIiwgXCJ3aXRob3V0IHN3ZWRpc2ggeW91IHdpbGwgZmFjZSBzb21lIHNlcmlvdXMgcHJvYmxlbXNcIiwgXCIyaFwiKSxcbiAgbmV3IENvdXJzZSg0LCBcImVuZ2xpc2hcIiwgXCJ0aGUgZ2xvYmFsIGxhbmd1YWdlLCBsZWFybiBpdCBOT1chISFcIiwgXCI1aFwiKSxcbl1cblxuY29uc3QgcmVnaXN0ZXJDb3Vyc2VzID0gKCkgPT4ge1xuICBmb3IgKGxldCBjb3Vyc2Ugb2YgbG9hZENvdXJzZXMoKSkge1xuICAgIGNvdXJzZU1lZGlhdG9yLnJlZ2lzdGVyQ291cnNlKGNvdXJzZSlcbiAgfVxufVxuXG5leHBvcnQgeyBDb3Vyc2UsIGxvYWRDb3Vyc2VzLCByZWdpc3RlckNvdXJzZXMgfVxuIiwiaW1wb3J0IHsgTGlzdFZpZXcgfSBmcm9tIFwiLi4vdmlld3MvbGlzdC12aWV3XCJcbmltcG9ydCB7IENvdXJzZSwgbG9hZENvdXJzZXMsIHJlZ2lzdGVyQ291cnNlcyB9IGZyb20gXCIuLi9tb2RlbHMvY291cnNlXCJcblxuZXhwb3J0IGNsYXNzIENvdXJzZUNvbnRyb2xsZXIge1xuICBwYXJlbnRFbGVtZW50OiBIVE1MRGl2RWxlbWVudFxuICBjb3Vyc2VzVmlldzogTGlzdFZpZXc8Q291cnNlPlxuICBjb25zdHJ1Y3RvcihwYXJlbnRFbGVtZW50OiBIVE1MRGl2RWxlbWVudCkge1xuICAgIHRoaXMucGFyZW50RWxlbWVudCA9IHBhcmVudEVsZW1lbnRcbiAgICB0aGlzLmNvdXJzZXNWaWV3ID0gbmV3IExpc3RWaWV3KHRoaXMucGFyZW50RWxlbWVudCwgbG9hZENvdXJzZXMoKSwgXCJDb3Vyc2VzXCIsIFtcbiAgICAgIFwidGl0bGVcIixcbiAgICAgIFwiZHVyYXRpb25cIixcbiAgICBdKVxuICB9XG5cbiAgaW5pdCgpOiB2b2lkIHtcbiAgICB0aGlzLmNvdXJzZXNWaWV3LmluaXQoKVxuICAgIHJlZ2lzdGVyQ291cnNlcygpXG4gIH1cbn1cbiIsImV4cG9ydCBjbGFzcyBQZXJzb24ge1xuICBpZDogbnVtYmVyXG4gIGZpcnN0TmFtZTogc3RyaW5nXG4gIGxhc3ROYW1lOiBzdHJpbmdcbiAgZW1haWw6IHN0cmluZ1xuICBhZ2U6IG51bWJlclxuICBjb25zdHJ1Y3RvcihpZDogbnVtYmVyLCBmaXJzdE5hbWU6IHN0cmluZywgbGFzdE5hbWU6IHN0cmluZywgZW1haWw6IHN0cmluZywgYWdlOiBudW1iZXIpIHtcbiAgICB0aGlzLmlkID0gaWRcbiAgICB0aGlzLmZpcnN0TmFtZSA9IGZpcnN0TmFtZVxuICAgIHRoaXMubGFzdE5hbWUgPSBsYXN0TmFtZVxuICAgIHRoaXMuZW1haWwgPSBlbWFpbFxuICAgIHRoaXMuYWdlID0gYWdlXG4gIH1cbn1cbiIsImltcG9ydCB7IFBlcnNvbiB9IGZyb20gXCIuL1BlcnNvblwiXG5pbXBvcnQgeyBTdWJqZWN0LCBUZWFjaGVyU3R1ZGVudENvbnN0cnVjdCB9IGZyb20gXCIuLi90eXBlc1wiXG5pbXBvcnQgeyBuYW5vaWQgfSBmcm9tIFwibmFub2lkXCJcblxuZXhwb3J0IGNsYXNzIFRlYWNoZXIgZXh0ZW5kcyBQZXJzb24gaW1wbGVtZW50cyBUZWFjaGVyU3R1ZGVudENvbnN0cnVjdCB7XG4gIHN1YmplY3RzOiBTdWJqZWN0W11cbiAgY29uc3RydWN0b3IoaWQ6IG51bWJlciwgZmlyc3ROYW1lOiBzdHJpbmcsIGxhc3ROYW1lOiBzdHJpbmcsIGVtYWlsOiBzdHJpbmcsIGFnZTogbnVtYmVyKSB7XG4gICAgc3VwZXIoaWQsIGZpcnN0TmFtZSwgbGFzdE5hbWUsIGVtYWlsLCBhZ2UpXG4gICAgdGhpcy5zdWJqZWN0cyA9IFtdXG4gIH1cblxuICBkaXNwbGF5SW5mbygpIHtcbiAgICByZXR1cm4ge1xuICAgICAgbmFtZTogYCR7dGhpcy5maXJzdE5hbWV9LSR7dGhpcy5sYXN0TmFtZX1gLFxuICAgICAgZW1haWw6IHRoaXMuZW1haWwsXG4gICAgICBhZ2U6IGAke3RoaXMuYWdlfWAsXG4gICAgfVxuICB9XG59XG5cbmV4cG9ydCBjb25zdCBsb2FkVGVhY2hlcnMgPSAoKSA9PiBbXG4gIG5ldyBUZWFjaGVyKDEsIFwiRnJhbmtcIiwgXCJTbWl0aFwiLCBcImZyYW5rQGlvLmNvbVwiLCA0MyksXG4gIG5ldyBUZWFjaGVyKDIsIFwiTG9nYW5cIiwgXCJKb25zc29uXCIsIFwibG9nYW5AaW8uY29tXCIsIDQ3KSxcbiAgbmV3IFRlYWNoZXIoMywgXCJNaWFcIiwgXCJHcmVnZXJcIiwgXCJtaWFAaW8uY29tXCIsIDQxKSxcbiAgbmV3IFRlYWNoZXIoNCwgXCJCb3Jpc1wiLCBcIlJvb25leVwiLCBcImZyYW5rQGlvLmNvbVwiLCA1MyksXG5dXG4iLCJpbXBvcnQgeyBMaXN0VmlldyB9IGZyb20gXCIuLi92aWV3cy9saXN0LXZpZXdcIlxuaW1wb3J0IHsgbG9hZFRlYWNoZXJzLCBUZWFjaGVyIH0gZnJvbSBcIi4uL21vZGVscy90ZWFjaGVyXCJcblxuZXhwb3J0IGNsYXNzIFRlYWNoZXJDb250cm9sbGVyIHtcbiAgcGFyZW50RWxlbWVudDogSFRNTERpdkVsZW1lbnRcbiAgdGVhY2hlcnNWaWV3OiBMaXN0VmlldzxUZWFjaGVyPlxuICBjb25zdHJ1Y3RvcihwYXJlbnRFbGVtZW50OiBIVE1MRGl2RWxlbWVudCkge1xuICAgIHRoaXMucGFyZW50RWxlbWVudCA9IHBhcmVudEVsZW1lbnRcbiAgICB0aGlzLnRlYWNoZXJzVmlldyA9IG5ldyBMaXN0Vmlldyh0aGlzLnBhcmVudEVsZW1lbnQsIGxvYWRUZWFjaGVycygpLCBcIlRlYWNoZXJzXCIsIFtcbiAgICAgIFwibmFtZVwiLFxuICAgICAgXCJlbWFpbFwiLFxuICAgICAgXCJhZ2VcIixcbiAgICBdKVxuICB9XG5cbiAgaW5pdCgpOiB2b2lkIHtcbiAgICB0aGlzLnRlYWNoZXJzVmlldy5pbml0KClcbiAgfVxufVxuIiwiaW1wb3J0IHsgQ291cnNlIH0gZnJvbSBcIi4vY291cnNlXCJcbmltcG9ydCB7IFN0dWRlbnRNZWRpYXRvciB9IGZyb20gXCIuL21lZGlhdG9yXCJcbmltcG9ydCB7IFBlcnNvbiB9IGZyb20gXCIuL1BlcnNvblwiXG5cbmNsYXNzIFN0dWRlbnQgZXh0ZW5kcyBQZXJzb24ge1xuICBzdHVkZW50TWVkaWF0b3I6IG51bGwgfCBTdHVkZW50TWVkaWF0b3JcbiAgY29uc3RydWN0b3IoaWQ6IG51bWJlciwgZmlyc3ROYW1lOiBzdHJpbmcsIGxhc3ROYW1lOiBzdHJpbmcsIGVtYWlsOiBzdHJpbmcsIGFnZTogbnVtYmVyKSB7XG4gICAgc3VwZXIoaWQsIGZpcnN0TmFtZSwgbGFzdE5hbWUsIGVtYWlsLCBhZ2UpXG4gICAgdGhpcy5zdHVkZW50TWVkaWF0b3IgPSBudWxsXG4gIH1cbiAgZGlzcGxheUluZm8oKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIG5hbWU6IGAke3RoaXMuZmlyc3ROYW1lfS0ke3RoaXMubGFzdE5hbWV9YCxcbiAgICAgIGVtYWlsOiB0aGlzLmVtYWlsLFxuICAgICAgYWdlOiBgJHt0aGlzLmFnZX1gLFxuICAgIH1cbiAgfVxuICBzZW5kKG1lc3NhZ2U6IHN0cmluZywgdG8/OiBTdHVkZW50KSB7XG4gICAgdGhpcy5zdHVkZW50TWVkaWF0b3I/LnNlbmQobWVzc2FnZSwgdGhpcywgdG8pXG4gIH1cbiAgcmVjZWl2ZShtZXNzYWdlOiBzdHJpbmcsIGZyb206IFN0dWRlbnQpOiBzdHJpbmcge1xuICAgIHJldHVybiBgJHttZXNzYWdlfSAtIGZyb20gJHtmcm9tfWBcbiAgfVxufVxuXG5jb25zdCBzdHVkZW50TWVkaWF0b3IgPSBuZXcgU3R1ZGVudE1lZGlhdG9yKClcblxuY29uc3QgbG9hZFN0dWRlbnRzID0gKCkgPT4gW1xuICBuZXcgU3R1ZGVudCgxLCBcIkZyYW5rXCIsIFwiTWVsbGJlcmdcIiwgXCJmcmFua0Bpby5jb21cIiwgMjEpLFxuICBuZXcgU3R1ZGVudCgyLCBcIlJpb1wiLCBcIkZlcmRpbmFuZFwiLCBcInJpb0Bpby5jb21cIiwgMjUpLFxuICBuZXcgU3R1ZGVudCgzLCBcIk5lbWFuamFcIiwgXCJWaWRpY1wiLCBcIm5lbWFuamFAaW8uY29tXCIsIDMyKSxcbiAgbmV3IFN0dWRlbnQoNCwgXCJGcmVkcmlrXCIsIFwibGp1bmdiZXJnXCIsIFwiZnJlZHJpa0Bpby5jb21cIiwgMzIpLFxuICBuZXcgU3R1ZGVudCg1LCBcIkxvdHRhXCIsIFwiU2NoZWxpblwiLCBcImxvdHRhQGlvLmNvbVwiLCAyMSksXG4gIG5ldyBTdHVkZW50KDYsIFwiU3RpbmFcIiwgXCJPbG9mc3NvblwiLCBcInNpbmFAaW8uY29tXCIsIDIxKSxcbl1cblxuY29uc3QgcmVnaXN0ZXJBbGxTdHVkZW50cyA9ICgpOiB2b2lkID0+IHtcbiAgZm9yIChsZXQgc3R1ZGVudCBvZiBsb2FkU3R1ZGVudHMoKSkge1xuICAgIHN0dWRlbnRNZWRpYXRvci5yZWdpc3RlclN0dWRlbnQoc3R1ZGVudClcbiAgfVxufVxuXG5leHBvcnQgeyBTdHVkZW50LCBsb2FkU3R1ZGVudHMsIHN0dWRlbnRNZWRpYXRvciwgcmVnaXN0ZXJBbGxTdHVkZW50cyB9XG4iLCJpbXBvcnQgeyBTdHVkZW50IH0gZnJvbSBcIi4uL21vZGVscy9zdHVkZW50XCJcbmltcG9ydCB7IFRlYWNoZXIgfSBmcm9tIFwiLi4vbW9kZWxzL3RlYWNoZXJcIlxuaW1wb3J0IHsgTGlzdFZpZXcgfSBmcm9tIFwiLi9saXN0LXZpZXdcIlxuXG5leHBvcnQgY2xhc3MgTW9kYWxWaWV3PFQsIFM+IHtcbiAgcGFyZW50RWxlbWVudDogSFRNTERpdkVsZW1lbnRcbiAgbGlzdDogQXJyYXk8YW55PlxuICBkYXRhOiBTdHVkZW50IHwgVGVhY2hlclxuICB0aXRsZTogc3RyaW5nXG4gIGxpc3RWaWV3OiBMaXN0VmlldzxUPlxuICBzdWJUaXRsZXM6IHN0cmluZ1tdXG4gIGNvbnN0cnVjdG9yKFxuICAgIHBhcmVudEVsZW1lbnQ6IEhUTUxEaXZFbGVtZW50LFxuICAgIGxpc3Q6IGFueSxcbiAgICBkYXRhOiBTdHVkZW50IHwgVGVhY2hlcixcbiAgICB0aXRsZTogc3RyaW5nLFxuICAgIHN1YlRpdGxlczogc3RyaW5nW11cbiAgKSB7XG4gICAgdGhpcy5wYXJlbnRFbGVtZW50ID0gcGFyZW50RWxlbWVudFxuICAgIHRoaXMubGlzdCA9IGxpc3RcbiAgICB0aGlzLmRhdGEgPSBkYXRhXG4gICAgdGhpcy50aXRsZSA9IHRpdGxlXG4gICAgdGhpcy5zdWJUaXRsZXMgPSBzdWJUaXRsZXNcbiAgICB0aGlzLmxpc3RWaWV3ID0gbmV3IExpc3RWaWV3KHRoaXMucGFyZW50RWxlbWVudCwgdGhpcy5saXN0LCB0aGlzLnRpdGxlLCB0aGlzLnN1YlRpdGxlcylcbiAgfVxuXG4gIHJlbmRlcigpOiB2b2lkIHtcbiAgICBjb25zdCBtb2RhbFdyYXBwZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsXCIpIGFzIEhUTUxETGlzdEVsZW1lbnRcbiAgICBtb2RhbFdyYXBwZXIuY2xhc3NMaXN0LmFkZChcInNob3ctbW9kYWxcIilcblxuICAgIGNvbnN0IGh0bWwgPSBgXG4gICAgPGRpdiBjbGFzcz1cIm1vZGFsLWNvbnRhaW5lclwiPlxuICAgICAgJHt0aGlzLmxpc3RWaWV3LnJlbmRlclJhd0h0bWwoKX1cbiAgICAgIDxidXR0b24gY2xhc3M9XCJjbG9zZS1tb2RhbFwiPlxuICAgICAgICDinYxcbiAgICAgIDwvYnV0dG9uPlxuICAgIDwvZGl2PlxuICAgIGBcblxuICAgIG1vZGFsV3JhcHBlci5pbm5lckhUTUwgPSBodG1sXG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jbG9zZS1tb2RhbFwiKT8uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgIG1vZGFsV3JhcHBlci5jbGFzc0xpc3QucmVtb3ZlKFwic2hvdy1tb2RhbFwiKVxuICAgIH0pXG5cbiAgICBjb25zdCB0cnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLm1vZGFsIHRib2R5IHRyXCIpLmZvckVhY2goKHRyOiBhbnkpID0+IHtcbiAgICAgIHRyLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZlbnQ6IGFueSkgPT4ge1xuICAgICAgICBjb25zb2xlLmxvZyhldmVudC50YXJnZXQpXG4gICAgICAgIGNvbnNvbGUubG9nKGV2ZW50LnRhcmdldC5pbm5lclRleHQpXG4gICAgICAgIGlmICh0ci5kYXRhc2V0LmlkID09PSBTdHJpbmcodGhpcy5kYXRhLmlkKSkge1xuICAgICAgICAgIGlmIChcInNlbmRcIiBpbiB0aGlzLmRhdGEpIHtcbiAgICAgICAgICAgIHRoaXMuZGF0YS5zZW5kKGBJIGFtIG5vIHJlZ2lzdGVyZWQgdG8gJHtldmVudC50YXJnZXQuaW5uZXJUZXh0fWApXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KVxuICAgICAgLy8gaWYgKHRyLmRhdGFzZXQuaWQgPT09IFN0cmluZyh0aGlzLmRhdGEuaWQpKSB7XG4gICAgICAvLyB9XG5cbiAgICAgIC8vIGlmICh0ci5kYXRhc2V0LmlkID09PSBTdHJpbmcodGhpcy5kYXRhLmlkKSkge1xuICAgICAgLy8gICBpZiAoXCJzZW5kXCIgaW4gdGhpcy5kYXRhKSB7XG4gICAgICAvLyAgICAgdGhpcy5kYXRhLnNlbmQoXCJJIGFtIG5vIHJlZ2lzdGVyZWRcIilcbiAgICAgIC8vICAgfVxuICAgICAgLy8gfVxuICAgIH0pXG4gIH1cbn1cbiIsImltcG9ydCB7IGxvYWRTdHVkZW50cywgU3R1ZGVudCwgcmVnaXN0ZXJBbGxTdHVkZW50cywgc3R1ZGVudE1lZGlhdG9yIH0gZnJvbSBcIi4uL21vZGVscy9zdHVkZW50XCJcbmltcG9ydCB7IExpc3RWaWV3IH0gZnJvbSBcIi4uL3ZpZXdzL2xpc3Qtdmlld1wiXG5pbXBvcnQgeyBNb2RhbFZpZXcgYXMgQ291cnNlc01vZGFsVmlldyB9IGZyb20gXCIuLi92aWV3cy9tb2RhbC12aWV3XCJcbmltcG9ydCB7IGxvYWRDb3Vyc2VzIH0gZnJvbSBcIi4uL21vZGVscy9jb3Vyc2VcIlxuXG5leHBvcnQgY2xhc3MgU3R1ZGVudENvbnRyb2xsZXIge1xuICBwYXJlbnRFbGVtZW50OiBIVE1MRGl2RWxlbWVudFxuICBzdHVkZW50c1ZpZXc6IExpc3RWaWV3PFN0dWRlbnQ+XG4gIGNvbnN0cnVjdG9yKHBhcmVudEVsZW1lbnQ6IEhUTUxEaXZFbGVtZW50KSB7XG4gICAgdGhpcy5wYXJlbnRFbGVtZW50ID0gcGFyZW50RWxlbWVudFxuICAgIHRoaXMuc3R1ZGVudHNWaWV3ID0gbmV3IExpc3RWaWV3KHRoaXMucGFyZW50RWxlbWVudCwgbG9hZFN0dWRlbnRzKCksIFwiU3R1ZGVudHNcIiwgW1xuICAgICAgXCJuYW1lXCIsXG4gICAgICBcImVtYWlsXCIsXG4gICAgICBcImFnZVwiLFxuICAgIF0pXG4gIH1cblxuICBoYW5kbGVDbGlja1N0dWRlbnQoKTogdm9pZCB7XG4gICAgdGhpcy5zdHVkZW50c1ZpZXcuY2xpY2tIYW5kbGVyKChpZDogbnVtYmVyKSA9PiB7XG4gICAgICBjb25zdCBzdHVkZW50ID0gbG9hZFN0dWRlbnRzKCkuZmluZChzdHVkZW50ID0+IHN0dWRlbnQuaWQgPT09IGlkKVxuICAgICAgY29uc3QgZGF0YSA9IHN0dWRlbnQhIGFzIFN0dWRlbnRcblxuICAgICAgY29uc3QgY291cnNlcyA9IGxvYWRDb3Vyc2VzKClcbiAgICAgIGNvbnN0IG1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbC1saXN0XCIpIGFzIEhUTUxEaXZFbGVtZW50XG4gICAgICBuZXcgQ291cnNlc01vZGFsVmlldzxhbnlbXSwgU3R1ZGVudD4obW9kYWwsIGNvdXJzZXMsIGRhdGEsIFwiY291cnNlc1wiLCBbXG4gICAgICAgIFwidGl0bGVcIixcbiAgICAgICAgXCJkdXJhdGlvblwiLFxuICAgICAgXSkucmVuZGVyKClcbiAgICB9KVxuICB9XG5cbiAgaW5pdCgpOiB2b2lkIHtcbiAgICB0aGlzLnN0dWRlbnRzVmlldy5pbml0KClcbiAgICB0aGlzLmhhbmRsZUNsaWNrU3R1ZGVudCgpXG4gICAgcmVnaXN0ZXJBbGxTdHVkZW50cygpXG4gICAgY29uc29sZS5sb2coXCJzdHVkZW50TWVkaWF0b3JcIiwgc3R1ZGVudE1lZGlhdG9yKSAvL2ZvciB0ZXN0aW5nIVxuICB9XG59XG4iLCJpbXBvcnQgeyBBcHAgfSBmcm9tIFwiLi9wYXR0ZXJucy9tdmMyLjAvY29udHJvbGxlcnMvYXBwXCJcbmltcG9ydCB7IENvdXJzZUNvbnRyb2xsZXIgfSBmcm9tIFwiLi9wYXR0ZXJucy9tdmMyLjAvY29udHJvbGxlcnMvY291cnNlXCJcbmltcG9ydCB7IFRlYWNoZXJDb250cm9sbGVyIH0gZnJvbSBcIi4vcGF0dGVybnMvbXZjMi4wL2NvbnRyb2xsZXJzL3RlYWNoZXJcIlxuaW1wb3J0IHsgU3R1ZGVudENvbnRyb2xsZXIgfSBmcm9tIFwiLi9wYXR0ZXJucy9tdmMyLjAvY29udHJvbGxlcnMvc3R1ZGVudFwiXG47KCgpID0+IHtcbiAgY29uc3QgY3JlYXRlRWxlbWVudCA9ICh0YWc6IHN0cmluZywgY2xhc3NOYW1lOiBzdHJpbmcpOiBIVE1MRWxlbWVudCA9PiB7XG4gICAgY29uc3QgZWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQodGFnKVxuICAgIGVsZW1lbnQuY2xhc3NMaXN0LmFkZChjbGFzc05hbWUpXG4gICAgcmV0dXJuIGVsZW1lbnRcbiAgfVxuICBuZXcgQXBwKFxuICAgIG5ldyBUZWFjaGVyQ29udHJvbGxlcihkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInRlYWNoZXJcIikgYXMgSFRNTERpdkVsZW1lbnQpLFxuICAgIG5ldyBDb3Vyc2VDb250cm9sbGVyKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY291cnNlXCIpIGFzIEhUTUxEaXZFbGVtZW50KSxcbiAgICBuZXcgU3R1ZGVudENvbnRyb2xsZXIoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJzdHVkZW50XCIpIGFzIEhUTUxEaXZFbGVtZW50KVxuICApLnJlbmRlcigpXG59KSgpXG4iXSwic291cmNlUm9vdCI6IiJ9