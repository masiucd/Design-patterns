(()=>{"use strict";var t,n=function(){function t(t,n){this.teacher=t,this.students=n}return t.prototype.render=function(){this.teacher.init(),this.students.init()},t}(),e=function(){function t(t,n,e,i){this.parentElement=t,this.dataList=n,this.title=e,this.subTitles=i}return t.prototype.clickHandler=function(t){document.querySelectorAll("tr").forEach((function(n){return n.addEventListener("click",(function(){t(parseInt(n.dataset.id,10)),sessionStorage.setItem("user",String(n.dataset.id))}))}))},t.prototype.render=function(){var t='\n    <div class="table-wrapper wrapper-'+this.title+'">\n    <table class="'+this.title+'">\n        <caption>'+this.title+"</caption>\n        <thead>\n          "+this.subTitles.map((function(t){return"<th>"+t+"</th>"})).join("")+"\n        </thead>\n        <tbody>\n          "+this.dataList.map((function(t){var n=t.displayInfo();return'\n                <tr data-id="'+t.id+'">\n                '+Object.keys(n).map((function(t){return'<td data-info="'+n[t]+'">'+n[t]+"</td>"})).join("")+"\n                </tr>\n          "})).join("")+"\n        </tbody>\n      </table>\n    </div>\n    ";this.parentElement.innerHTML=t},t.prototype.renderRawHtml=function(){return'\n    <div class="table-wrapper wrapper-'+this.title+'">\n    <table>\n        <caption>'+this.title+"</caption>\n        <thead>\n          "+this.subTitles.map((function(t){return"<th>"+t+"</th>"})).join("")+"\n        </thead>\n        <tbody>\n          "+this.dataList.map((function(t){var n=t.displayInfo();return'\n                <tr data-id="'+t.id+'">\n                '+Object.keys(n).map((function(t){return"<td>"+n[t]+"</td>"})).join("")+"\n                </tr>\n          "})).join("")+"\n        </tbody>\n      </table>\n    </div>\n    "},t.prototype.mount=function(t){t.innerHTML=this.renderRawHtml()},t.prototype.init=function(){this.render()},t}(),i=function(t,n,e,i,o){this.id=t,this.firstName=n,this.lastName=e,this.email=i,this.age=o},o=(t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])})(n,e)},function(n,e){function i(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),r=function(t){function n(n,e,i,o,r){var s=t.call(this,n,e,i,o,r)||this;return s.subjects=[],s}return o(n,t),n.prototype.displayInfo=function(){return{name:this.firstName+"-"+this.lastName,email:this.email,age:""+this.age}},n}(i),s=function(){function t(t){this.parentElement=t,this.teachersView=new e(this.parentElement,[new r(1,"Frank","Smith","frank@io.com",43),new r(2,"Logan","Jonsson","logan@io.com",47),new r(3,"Mia","Greger","mia@io.com",41),new r(4,"Boris","Rooney","frank@io.com",53)],"Teachers",["name","email","age"])}return t.prototype.init=function(){this.teachersView.init()},t}(),a=function(){function t(){this.id=1,this.name="Mr Alfred",this.isAdmin=!0}return t.getInstance=function(){return t.instance||(t.instance=new t),t.instance},t.prototype.receive=function(t,n){var e="Student "+n.firstName+" has been registered for the course "+t.title;return console.log(e),e},t}(),u=function(){function t(){this.students={},this.admin=new a}return t.prototype.registerStudent=function(t){this.students[t.firstName]=t,t.adminMediator=this},t.prototype.send=function(t,n,e,i){var o=this;e?e.receive(t,n):Object.keys(this.students).forEach((function(e){o.students[e]!==n&&o.students[e].receive(t,n)}))},t}(),c=function(){function t(){this.courses={}}return t.prototype.registerCourse=function(t){this.courses[t.title]=t,t.courseMediator=this},t.prototype.send=function(t,n,e){},t}(),d=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])})(n,e)};return function(n,e){function i(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}(),l=function(t){function n(n,e,i,o,r){var s=t.call(this,n,e,i,o,r)||this;return s.adminMediator=null,s}return d(n,t),n.prototype.displayInfo=function(){return{name:this.firstName+"-"+this.lastName,email:this.email,age:""+this.age}},n.prototype.send=function(t,n){var e;null===(e=this.adminMediator)||void 0===e||e.send(t,this,n)},n.prototype.receive=function(t,n){return t+" - from "+n},n}(i),h=new u,f=function(){return[new l(1,"Frank","Mellberg","frank@io.com",21),new l(2,"Rio","Ferdinand","rio@io.com",25),new l(3,"Nemanja","Vidic","nemanja@io.com",32),new l(4,"Fredrik","ljungberg","fredrik@io.com",32)]},p=function(){function t(t,n,i,o,r){this.parentElement=t,this.list=n,this.data=i,this.title=o,this.subTitles=r,this.listView=new e(this.parentElement,this.list,this.title,this.subTitles),this.confirmationText=""}return t.prototype.updateText=function(t){console.log("TEXT",t),this.confirmationText=t},t.prototype.render=function(){var t,n=this,e=document.querySelector(".modal");e.classList.add("show-modal");var i='\n    <div class="modal-container">\n      '+this.listView.renderRawHtml()+"\n      "+this.confirmationText+'\n      <button class="close-modal">\n        ‚ùå\n      </button>\n    </div>\n    ';e.innerHTML=i,null===(t=document.querySelector(".close-modal"))||void 0===t||t.addEventListener("click",(function(){e.classList.remove("show-modal"),e.innerHTML=""})),document.querySelectorAll(".modal tbody tr").forEach((function(t){t.addEventListener("click",(function(t){if("send"in n.data){var e="You have now been registered to the "+t.target.innerText+" Course";n.data.send(e,n.data),n.updateText(e),n.updateHtml()}}))}))},t.prototype.updateHtml=function(){this.render()},t}(),m=function(){function t(t,n,e,i){this.id=t,this.title=n,this.description=e,this.duration=i,this.courseMediator=null}return t.prototype.displayInfo=function(){return{title:this.title,duration:this.duration}},t.prototype.send=function(){},t.prototype.receive=function(){},t}(),y=(new c,function(){return[new m(1,"math","math is wonderful","6h"),new m(2,"history","history is good for you","3h"),new m(3,"swedish","without swedish you will face some serious problems","2h"),new m(4,"english","the global language, learn it NOW!!!","5h")]}),w=function(){function t(t){this.parentElement=t,this.studentsView=new e(this.parentElement,f(),"Students",["name","email","age"])}return t.prototype.handleClickStudent=function(){this.studentsView.clickHandler((function(t){var n=f().find((function(n){return n.id===t})),e=y(),i=document.querySelector(".modal-list");new p(i,e,n,"courses",["title","duration"]).render()}))},t.prototype.handleShowProfile=function(){},t.prototype.init=function(){this.studentsView.init(),this.handleClickStudent(),function(){for(var t=0,n=f();t<n.length;t++){var e=n[t];h.registerStudent(e)}}(),this.handleShowProfile()},t}();new n(new s(document.getElementById("teacher")),new w(document.getElementById("student"))).render()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zY2hvb2wtZGF0YS8uL3NyYy9wYXR0ZXJucy9tdmMyLjAvY29udHJvbGxlcnMvYXBwLnRzIiwid2VicGFjazovL3NjaG9vbC1kYXRhLy4vc3JjL3BhdHRlcm5zL212YzIuMC92aWV3cy9saXN0LXZpZXcudHMiLCJ3ZWJwYWNrOi8vc2Nob29sLWRhdGEvLi9zcmMvcGF0dGVybnMvbXZjMi4wL21vZGVscy9QZXJzb24udHMiLCJ3ZWJwYWNrOi8vc2Nob29sLWRhdGEvLi9zcmMvcGF0dGVybnMvbXZjMi4wL21vZGVscy90ZWFjaGVyLnRzIiwid2VicGFjazovL3NjaG9vbC1kYXRhLy4vc3JjL3BhdHRlcm5zL212YzIuMC9jb250cm9sbGVycy90ZWFjaGVyLnRzIiwid2VicGFjazovL3NjaG9vbC1kYXRhLy4vc3JjL3BhdHRlcm5zL212YzIuMC9tb2RlbHMvYWRtaW4udHMiLCJ3ZWJwYWNrOi8vc2Nob29sLWRhdGEvLi9zcmMvcGF0dGVybnMvbXZjMi4wL21vZGVscy9tZWRpYXRvci50cyIsIndlYnBhY2s6Ly9zY2hvb2wtZGF0YS8uL3NyYy9wYXR0ZXJucy9tdmMyLjAvbW9kZWxzL3N0dWRlbnQudHMiLCJ3ZWJwYWNrOi8vc2Nob29sLWRhdGEvLi9zcmMvcGF0dGVybnMvbXZjMi4wL3ZpZXdzL21vZGFsLXZpZXcudHMiLCJ3ZWJwYWNrOi8vc2Nob29sLWRhdGEvLi9zcmMvcGF0dGVybnMvbXZjMi4wL21vZGVscy9jb3Vyc2UudHMiLCJ3ZWJwYWNrOi8vc2Nob29sLWRhdGEvLi9zcmMvcGF0dGVybnMvbXZjMi4wL2NvbnRyb2xsZXJzL3N0dWRlbnQudHMiLCJ3ZWJwYWNrOi8vc2Nob29sLWRhdGEvLi9zcmMvaW5kZXgudHMiXSwibmFtZXMiOlsidGVhY2hlciIsInN0dWRlbnRzIiwidGhpcyIsInJlbmRlciIsImluaXQiLCJwYXJlbnRFbGVtZW50IiwiZGF0YUxpc3QiLCJ0aXRsZSIsInN1YlRpdGxlcyIsImNsaWNrSGFuZGxlciIsInN1YnNjcmliZXIiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJmb3JFYWNoIiwidHIiLCJhZGRFdmVudExpc3RlbmVyIiwicGFyc2VJbnQiLCJkYXRhc2V0IiwiaWQiLCJzZXNzaW9uU3RvcmFnZSIsInNldEl0ZW0iLCJTdHJpbmciLCJodG1sIiwibWFwIiwidCIsImpvaW4iLCJkYXRhIiwiZGlzcGxheUluZm8iLCJPYmplY3QiLCJrZXlzIiwia2V5IiwiaW5uZXJIVE1MIiwicmVuZGVyUmF3SHRtbCIsIm1vdW50IiwiZWxlbWVudCIsImZpcnN0TmFtZSIsImxhc3ROYW1lIiwiZW1haWwiLCJhZ2UiLCJzdWJqZWN0cyIsIm5hbWUiLCJQZXJzb24iLCJ0ZWFjaGVyc1ZpZXciLCJMaXN0VmlldyIsIlRlYWNoZXIiLCJpc0FkbWluIiwiZ2V0SW5zdGFuY2UiLCJBZG1pbiIsImluc3RhbmNlIiwicmVjZWl2ZSIsImNvdXJzZSIsImZyb20iLCJzdHVkZW50UmVnaXN0cmVkRm9yQ291cnNlTWVzc2FnZSIsImNvbnNvbGUiLCJsb2ciLCJhZG1pbiIsInJlZ2lzdGVyU3R1ZGVudCIsInN0dWRlbnQiLCJhZG1pbk1lZGlhdG9yIiwic2VuZCIsIm1lc3NhZ2UiLCJ0byIsImNvdXJzZXMiLCJyZWdpc3RlckNvdXJzZSIsImNvdXJzZU1lZGlhdG9yIiwiQWRtaW5NZWRpYXRvciIsImxvYWRTdHVkZW50cyIsIlN0dWRlbnQiLCJsaXN0IiwibGlzdFZpZXciLCJjb25maXJtYXRpb25UZXh0IiwidXBkYXRlVGV4dCIsInRleHQiLCJtb2RhbFdyYXBwZXIiLCJxdWVyeVNlbGVjdG9yIiwiY2xhc3NMaXN0IiwiYWRkIiwicmVtb3ZlIiwiZXZlbnQiLCJ0YXJnZXQiLCJpbm5lclRleHQiLCJ1cGRhdGVIdG1sIiwiZGVzY3JpcHRpb24iLCJkdXJhdGlvbiIsImxvYWRDb3Vyc2VzIiwiQ291cnNlTWVkaWF0b3IiLCJDb3Vyc2UiLCJzdHVkZW50c1ZpZXciLCJoYW5kbGVDbGlja1N0dWRlbnQiLCJmaW5kIiwibW9kYWwiLCJoYW5kbGVTaG93UHJvZmlsZSIsInJlZ2lzdGVyQWxsU3R1ZGVudHMiLCJBcHAiLCJUZWFjaGVyQ29udHJvbGxlciIsImdldEVsZW1lbnRCeUlkIiwiU3R1ZGVudENvbnRyb2xsZXIiXSwibWFwcGluZ3MiOiJtQkFJQSxJLEVBQUEsYUFJRSxXQUFZQSxFQUE0QkMsR0FDdENDLEtBQUtGLFFBQVVBLEVBRWZFLEtBQUtELFNBQVdBLEVBUXBCLE9BTEUsWUFBQUUsT0FBQSxXQUNFRCxLQUFLRixRQUFRSSxPQUViRixLQUFLRCxTQUFTRyxRQUVsQixFQWZBLEdDREEsYUFLRSxXQUNFQyxFQUNBQyxFQUNBQyxFQUNBQyxHQUVBTixLQUFLRyxjQUFnQkEsRUFDckJILEtBQUtJLFNBQVdBLEVBQ2hCSixLQUFLSyxNQUFRQSxFQUNiTCxLQUFLTSxVQUFZQSxFQTRFckIsT0F6RUUsWUFBQUMsYUFBQSxTQUFhQyxHQUNDQyxTQUFTQyxpQkFBaUIsTUFDbENDLFNBQVEsU0FBQUMsR0FDVixPQUFBQSxFQUFHQyxpQkFBaUIsU0FBUyxXQUMzQkwsRUFBV00sU0FBU0YsRUFBR0csUUFBUUMsR0FBSyxLQUNwQ0MsZUFBZUMsUUFBUSxPQUFRQyxPQUFPUCxFQUFHRyxRQUFRQyxZQUsvQyxZQUFBZixPQUFSLFdBQ0UsSUFBTW1CLEVBQU8sMkNBQ3VCcEIsS0FBS0ssTUFBSyx5QkFDOUJMLEtBQUtLLE1BQUssd0JBQ1hMLEtBQUtLLE1BQUssMENBRWpCTCxLQUFLTSxVQUFVZSxLQUFJLFNBQUFDLEdBQUssYUFBT0EsRUFBQyxXQUFTQyxLQUFLLElBQUcsa0RBR2hEdkIsS0FBS0ksU0FDTGlCLEtBQUksU0FBQ0csR0FDSixJQUFNQyxFQUFjRCxFQUFLQyxjQUN6QixNQUFPLGtDQUNVRCxFQUFLUixHQUFFLHVCQUNwQlUsT0FBT0MsS0FBS0YsR0FDWEosS0FBSSxTQUFBTyxHQUFPLHdCQUFrQkgsRUFBWUcsR0FBSSxLQUFLSCxFQUFZRyxHQUFJLFdBQ2xFTCxLQUFLLElBQUcseUNBSWRBLEtBQUssSUFBRyx1REFLakJ2QixLQUFL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LElBQUlDLEVBRVAsV0FBZ0IsT0FDbEMsSUFBSUMsRUFBTyxFQUFHLE9BQVEsb0JBQXFCLE1BQzNDLElBQUlBLEVBQU8sRUFBRyxVQUFXLDBCQUEyQixNQUNwRCxJQUFJQSxFQUFPLEVBQUcsVUFBVyxzREFBdUQsTUFDaEYsSUFBSUEsRUFBTyxFQUFHLFVBQVcsdUNBQXdDLFNDMUJuRSxhQUdFLFdBQVlqRixHQUNWSCxLQUFLRyxjQUFnQkEsRUFDckJILEtBQUtxRixhQUFlLElBQUk1QyxFQUFTekMsS0FBS0csY0FBZTZELElBQWdCLFdBQVksQ0FDL0UsT0FDQSxRQUNBLFFBa0NOLE9BOUJFLFlBQUFzQixtQkFBQSxXQUNFdEYsS0FBS3FGLGFBQWE5RSxjQUFhLFNBQUNTLEdBQzlCLElBQ01RLEVBRFV3QyxJQUFldUIsTUFBSyxTQUFBaEMsR0FBVyxPQUFBQSxFQUFRdkMsS0FBT0EsS0FFeEQ0QyxFQUFVc0IsSUFDVk0sRUFBUS9FLFNBQVMrRCxjQUFjLGVBQ3JDLElBQUksRUFBaUNnQixFQUFPNUIsRUFBU3BDLEVBQU0sVUFBVyxDQUNwRSxRQUNBLGFBQ0N2QixhQUlQLFlBQUF3RixrQkFBQSxhQVVBLFlBQUF2RixLQUFBLFdBQ0VGLEtBQUtxRixhQUFhbkYsT0FDbEJGLEtBQUtzRixxQkhWbUIsV0FDMUIsSUFBb0IsVUFBQXRCLElBQUEsZUFBZ0IsQ0FBL0IsSUFBSVQsRUFBTyxLQUNkQyxFQUFjRixnQkFBZ0JDLElHUzlCbUMsR0FDQTFGLEtBQUt5RixxQkFHVCxFQTFDQSxHQ0dFLElBQUlFLEVBQ0YsSUFBSUMsRUFBa0JuRixTQUFTb0YsZUFBZSxZQUM5QyxJQUFJQyxFQUFrQnJGLFNBQVNvRixlQUFlLGFBQzlDNUYsVSIsImZpbGUiOiJidW5kbGUuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBUZWFjaGVyQ29udHJvbGxlciB9IGZyb20gXCIuL3RlYWNoZXJcIlxuaW1wb3J0IHsgQ291cnNlQ29udHJvbGxlciB9IGZyb20gXCIuL2NvdXJzZVwiXG5pbXBvcnQgeyBTdHVkZW50Q29udHJvbGxlciB9IGZyb20gXCIuL3N0dWRlbnRcIlxuXG5leHBvcnQgY2xhc3MgQXBwIHtcbiAgdGVhY2hlcjogVGVhY2hlckNvbnRyb2xsZXJcbiAgLy8gY291cnNlczogQ291cnNlQ29udHJvbGxlclxuICBzdHVkZW50czogU3R1ZGVudENvbnRyb2xsZXJcbiAgY29uc3RydWN0b3IodGVhY2hlcjogVGVhY2hlckNvbnRyb2xsZXIsIHN0dWRlbnRzOiBTdHVkZW50Q29udHJvbGxlcikge1xuICAgIHRoaXMudGVhY2hlciA9IHRlYWNoZXJcbiAgICAvLyB0aGlzLmNvdXJzZXMgPSBjb3Vyc2VzXG4gICAgdGhpcy5zdHVkZW50cyA9IHN0dWRlbnRzXG4gIH1cblxuICByZW5kZXIoKTogdm9pZCB7XG4gICAgdGhpcy50ZWFjaGVyLmluaXQoKVxuICAgIC8vIHRoaXMuY291cnNlcy5pbml0KClcbiAgICB0aGlzLnN0dWRlbnRzLmluaXQoKVxuICB9XG59XG4iLCJpbXBvcnQgeyBDb3Vyc2UgfSBmcm9tIFwiLi4vLi4vbXZjL21vZGVscy9jb3Vyc2UtbW9kZWxcIlxuaW1wb3J0IHsgVGVhY2hlciB9IGZyb20gXCIuLi9tb2RlbHMvdGVhY2hlclwiXG5cbmV4cG9ydCBjbGFzcyBMaXN0VmlldzxUPiB7XG4gIHBhcmVudEVsZW1lbnQ6IEhUTUxEaXZFbGVtZW50XG4gIGRhdGFMaXN0OiBBcnJheTxUPlxuICB0aXRsZTogc3RyaW5nXG4gIHN1YlRpdGxlczogc3RyaW5nW11cbiAgY29uc3RydWN0b3IoXG4gICAgcGFyZW50RWxlbWVudDogSFRNTERpdkVsZW1lbnQsXG4gICAgZGF0YUxpc3Q6IEFycmF5PFQ+LFxuICAgIHRpdGxlOiBzdHJpbmcsXG4gICAgc3ViVGl0bGVzOiBzdHJpbmdbXSxcbiAgKSB7XG4gICAgdGhpcy5wYXJlbnRFbGVtZW50ID0gcGFyZW50RWxlbWVudFxuICAgIHRoaXMuZGF0YUxpc3QgPSBkYXRhTGlzdFxuICAgIHRoaXMudGl0bGUgPSB0aXRsZVxuICAgIHRoaXMuc3ViVGl0bGVzID0gc3ViVGl0bGVzXG4gIH1cblxuICBjbGlja0hhbmRsZXIoc3Vic2NyaWJlcjogRnVuY3Rpb24pIHtcbiAgICBjb25zdCB0cnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwidHJcIilcbiAgICB0cnMuZm9yRWFjaCh0ciA9PlxuICAgICAgdHIuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgICAgc3Vic2NyaWJlcihwYXJzZUludCh0ci5kYXRhc2V0LmlkISwgMTApKVxuICAgICAgICBzZXNzaW9uU3RvcmFnZS5zZXRJdGVtKFwidXNlclwiLCBTdHJpbmcodHIuZGF0YXNldC5pZCkpXG4gICAgICB9KSxcbiAgICApXG4gIH1cblxuICBwcml2YXRlIHJlbmRlcigpOiB2b2lkIHtcbiAgICBjb25zdCBodG1sID0gYFxuICAgIDxkaXYgY2xhc3M9XCJ0YWJsZS13cmFwcGVyIHdyYXBwZXItJHt0aGlzLnRpdGxlfVwiPlxuICAgIDx0YWJsZSBjbGFzcz1cIiR7dGhpcy50aXRsZX1cIj5cbiAgICAgICAgPGNhcHRpb24+JHt0aGlzLnRpdGxlfTwvY2FwdGlvbj5cbiAgICAgICAgPHRoZWFkPlxuICAgICAgICAgICR7dGhpcy5zdWJUaXRsZXMubWFwKHQgPT4gYDx0aD4ke3R9PC90aD5gKS5qb2luKFwiXCIpfVxuICAgICAgICA8L3RoZWFkPlxuICAgICAgICA8dGJvZHk+XG4gICAgICAgICAgJHsodGhpcy5kYXRhTGlzdCBhcyBBcnJheTxUPilcbiAgICAgICAgICAgIC5tYXAoKGRhdGE6IGFueSkgPT4ge1xuICAgICAgICAgICAgICBjb25zdCBkaXNwbGF5SW5mbyA9IGRhdGEuZGlzcGxheUluZm8oKSBhcyB7IFtrZXk6IHN0cmluZ106IHN0cmluZyB9XG4gICAgICAgICAgICAgIHJldHVybiBgXG4gICAgICAgICAgICAgICAgPHRyIGRhdGEtaWQ9XCIke2RhdGEuaWR9XCI+XG4gICAgICAgICAgICAgICAgJHtPYmplY3Qua2V5cyhkaXNwbGF5SW5mbylcbiAgICAgICAgICAgICAgICAgIC5tYXAoa2V5ID0+IGA8dGQgZGF0YS1pbmZvPVwiJHtkaXNwbGF5SW5mb1trZXldfVwiPiR7ZGlzcGxheUluZm9ba2V5XX08L3RkPmApXG4gICAgICAgICAgICAgICAgICAuam9pbihcIlwiKX1cbiAgICAgICAgICAgICAgICA8L3RyPlxuICAgICAgICAgIGBcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuam9pbihcIlwiKX1cbiAgICAgICAgPC90Ym9keT5cbiAgICAgIDwvdGFibGU+XG4gICAgPC9kaXY+XG4gICAgYFxuICAgIHRoaXMucGFyZW50RWxlbWVudC5pbm5lckhUTUwgPSBodG1sXG4gIH1cblxuICByZW5kZXJSYXdIdG1sKCk6IHN0cmluZyB7XG4gICAgY29uc3QgaHRtbCA9IGBcbiAgICA8ZGl2IGNsYXNzPVwidGFibGUtd3JhcHBlciB3cmFwcGVyLSR7dGhpcy50aXRsZX1cIj5cbiAgICA8dGFibGU+XG4gICAgICAgIDxjYXB0aW9uPiR7dGhpcy50aXRsZX08L2NhcHRpb24+XG4gICAgICAgIDx0aGVhZD5cbiAgICAgICAgICAke3RoaXMuc3ViVGl0bGVzLm1hcCh0ID0+IGA8dGg+JHt0fTwvdGg+YCkuam9pbihcIlwiKX1cbiAgICAgICAgPC90aGVhZD5cbiAgICAgICAgPHRib2R5PlxuICAgICAgICAgICR7KHRoaXMuZGF0YUxpc3QgYXMgQXJyYXk8YW55PilcbiAgICAgICAgICAgIC5tYXAoKGRhdGE6IGFueSkgPT4ge1xuICAgICAgICAgICAgICBjb25zdCBkaXNwbGF5SW5mbyA9IGRhdGEuZGlzcGxheUluZm8oKSBhcyB7IFtrZXk6IHN0cmluZ106IHN0cmluZyB9XG4gICAgICAgICAgICAgIHJldHVybiBgXG4gICAgICAgICAgICAgICAgPHRyIGRhdGEtaWQ9XCIke2RhdGEuaWR9XCI+XG4gICAgICAgICAgICAgICAgJHtPYmplY3Qua2V5cyhkaXNwbGF5SW5mbylcbiAgICAgICAgICAgICAgICAgIC5tYXAoa2V5ID0+IGA8dGQ+JHtkaXNwbGF5SW5mb1trZXldfTwvdGQ+YClcbiAgICAgICAgICAgICAgICAgIC5qb2luKFwiXCIpfVxuICAgICAgICAgICAgICAgIDwvdHI+XG4gICAgICAgICAgYFxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5qb2luKFwiXCIpfVxuICAgICAgICA8L3Rib2R5PlxuICAgICAgPC90YWJsZT5cbiAgICA8L2Rpdj5cbiAgICBgXG4gICAgcmV0dXJuIGh0bWxcbiAgfVxuXG4gIG1vdW50KGVsZW1lbnQ6IEhUTUxFbGVtZW50KSB7XG4gICAgZWxlbWVudC5pbm5lckhUTUwgPSB0aGlzLnJlbmRlclJhd0h0bWwoKVxuICB9XG5cbiAgaW5pdCgpOiB2b2lkIHtcbiAgICB0aGlzLnJlbmRlcigpXG4gIH1cbn1cbiIsImV4cG9ydCBjbGFzcyBQZXJzb24ge1xuICBpZDogbnVtYmVyXG4gIGZpcnN0TmFtZTogc3RyaW5nXG4gIGxhc3ROYW1lOiBzdHJpbmdcbiAgZW1haWw6IHN0cmluZ1xuICBhZ2U6IG51bWJlclxuICBjb25zdHJ1Y3RvcihpZDogbnVtYmVyLCBmaXJzdE5hbWU6IHN0cmluZywgbGFzdE5hbWU6IHN0cmluZywgZW1haWw6IHN0cmluZywgYWdlOiBudW1iZXIpIHtcbiAgICB0aGlzLmlkID0gaWRcbiAgICB0aGlzLmZpcnN0TmFtZSA9IGZpcnN0TmFtZVxuICAgIHRoaXMubGFzdE5hbWUgPSBsYXN0TmFtZVxuICAgIHRoaXMuZW1haWwgPSBlbWFpbFxuICAgIHRoaXMuYWdlID0gYWdlXG4gIH1cbn1cbiIsImltcG9ydCB7IFBlcnNvbiB9IGZyb20gXCIuL1BlcnNvblwiXG5pbXBvcnQgeyBTdWJqZWN0LCBUZWFjaGVyU3R1ZGVudENvbnN0cnVjdCB9IGZyb20gXCIuLi90eXBlc1wiXG5pbXBvcnQgeyBuYW5vaWQgfSBmcm9tIFwibmFub2lkXCJcblxuZXhwb3J0IGNsYXNzIFRlYWNoZXIgZXh0ZW5kcyBQZXJzb24gaW1wbGVtZW50cyBUZWFjaGVyU3R1ZGVudENvbnN0cnVjdCB7XG4gIHN1YmplY3RzOiBTdWJqZWN0W11cbiAgY29uc3RydWN0b3IoaWQ6IG51bWJlciwgZmlyc3ROYW1lOiBzdHJpbmcsIGxhc3ROYW1lOiBzdHJpbmcsIGVtYWlsOiBzdHJpbmcsIGFnZTogbnVtYmVyKSB7XG4gICAgc3VwZXIoaWQsIGZpcnN0TmFtZSwgbGFzdE5hbWUsIGVtYWlsLCBhZ2UpXG4gICAgdGhpcy5zdWJqZWN0cyA9IFtdXG4gIH1cblxuICBkaXNwbGF5SW5mbygpIHtcbiAgICByZXR1cm4ge1xuICAgICAgbmFtZTogYCR7dGhpcy5maXJzdE5hbWV9LSR7dGhpcy5sYXN0TmFtZX1gLFxuICAgICAgZW1haWw6IHRoaXMuZW1haWwsXG4gICAgICBhZ2U6IGAke3RoaXMuYWdlfWAsXG4gICAgfVxuICB9XG59XG5cbmV4cG9ydCBjb25zdCBsb2FkVGVhY2hlcnMgPSAoKSA9PiBbXG4gIG5ldyBUZWFjaGVyKDEsIFwiRnJhbmtcIiwgXCJTbWl0aFwiLCBcImZyYW5rQGlvLmNvbVwiLCA0MyksXG4gIG5ldyBUZWFjaGVyKDIsIFwiTG9nYW5cIiwgXCJKb25zc29uXCIsIFwibG9nYW5AaW8uY29tXCIsIDQ3KSxcbiAgbmV3IFRlYWNoZXIoMywgXCJNaWFcIiwgXCJHcmVnZXJcIiwgXCJtaWFAaW8uY29tXCIsIDQxKSxcbiAgbmV3IFRlYWNoZXIoNCwgXCJCb3Jpc1wiLCBcIlJvb25leVwiLCBcImZyYW5rQGlvLmNvbVwiLCA1MyksXG5dXG4iLCJpbXBvcnQgeyBMaXN0VmlldyB9IGZyb20gXCIuLi92aWV3cy9saXN0LXZpZXdcIlxuaW1wb3J0IHsgbG9hZFRlYWNoZXJzLCBUZWFjaGVyIH0gZnJvbSBcIi4uL21vZGVscy90ZWFjaGVyXCJcblxuZXhwb3J0IGNsYXNzIFRlYWNoZXJDb250cm9sbGVyIHtcbiAgcGFyZW50RWxlbWVudDogSFRNTERpdkVsZW1lbnRcbiAgdGVhY2hlcnNWaWV3OiBMaXN0VmlldzxUZWFjaGVyPlxuICBjb25zdHJ1Y3RvcihwYXJlbnRFbGVtZW50OiBIVE1MRGl2RWxlbWVudCkge1xuICAgIHRoaXMucGFyZW50RWxlbWVudCA9IHBhcmVudEVsZW1lbnRcbiAgICB0aGlzLnRlYWNoZXJzVmlldyA9IG5ldyBMaXN0Vmlldyh0aGlzLnBhcmVudEVsZW1lbnQsIGxvYWRUZWFjaGVycygpLCBcIlRlYWNoZXJzXCIsIFtcbiAgICAgIFwibmFtZVwiLFxuICAgICAgXCJlbWFpbFwiLFxuICAgICAgXCJhZ2VcIixcbiAgICBdKVxuICB9XG5cbiAgaW5pdCgpOiB2b2lkIHtcbiAgICB0aGlzLnRlYWNoZXJzVmlldy5pbml0KClcbiAgfVxufVxuIiwiaW1wb3J0IHsgQ291cnNlIH0gZnJvbSBcIi4vY291cnNlXCJcbmltcG9ydCB7IFN0dWRlbnQgfSBmcm9tIFwiLi9zdHVkZW50XCJcblxuY2xhc3MgQWRtaW4ge1xuICBwcml2YXRlIHN0YXRpYyBpbnN0YW5jZTogQWRtaW5cbiAgaWQ6IG51bWJlclxuICBuYW1lOiBzdHJpbmdcbiAgaXNBZG1pbjogYm9vbGVhblxuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLmlkID0gMVxuICAgIHRoaXMubmFtZSA9IFwiTXIgQWxmcmVkXCJcbiAgICB0aGlzLmlzQWRtaW4gPSB0cnVlXG4gIH1cbiAgc3RhdGljIGdldEluc3RhbmNlKCkge1xuICAgIGlmICghQWRtaW4uaW5zdGFuY2UpIHtcbiAgICAgIEFkbWluLmluc3RhbmNlID0gbmV3IEFkbWluKClcbiAgICB9XG4gICAgcmV0dXJuIEFkbWluLmluc3RhbmNlXG4gIH1cbiAgcmVjZWl2ZShjb3Vyc2U6IENvdXJzZSwgZnJvbTogU3R1ZGVudCk6IHN0cmluZyB7XG4gICAgY29uc3Qgc3R1ZGVudFJlZ2lzdHJlZEZvckNvdXJzZU1lc3NhZ2UgPSBgU3R1ZGVudCAke2Zyb20uZmlyc3ROYW1lfSBoYXMgYmVlbiByZWdpc3RlcmVkIGZvciB0aGUgY291cnNlICR7Y291cnNlLnRpdGxlfWBcbiAgICBjb25zb2xlLmxvZyhzdHVkZW50UmVnaXN0cmVkRm9yQ291cnNlTWVzc2FnZSlcbiAgICByZXR1cm4gc3R1ZGVudFJlZ2lzdHJlZEZvckNvdXJzZU1lc3NhZ2VcbiAgfVxufVxuXG5jb25zdCBsb2FkQWRtaW4gPSAoKSA9PiBuZXcgQWRtaW4oKVxuXG5leHBvcnQgeyBBZG1pbiwgbG9hZEFkbWluIH1cbiIsImltcG9ydCB7IEFkbWluLCBsb2FkQWRtaW4gfSBmcm9tIFwiLi9hZG1pblwiXG5pbXBvcnQgeyBDb3Vyc2UgfSBmcm9tIFwiLi9jb3Vyc2VcIlxuaW1wb3J0IHsgU3R1ZGVudCB9IGZyb20gXCIuL3N0dWRlbnRcIlxuXG5jbGFzcyBBZG1pbk1lZGlhdG9yIHtcbiAgc3R1ZGVudHM6IFJlY29yZDxzdHJpbmcsIFN0dWRlbnQ+XG4gIGFkbWluOiBBZG1pblxuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLnN0dWRlbnRzID0ge31cbiAgICB0aGlzLmFkbWluID0gbG9hZEFkbWluKClcbiAgfVxuICByZWdpc3RlclN0dWRlbnQoc3R1ZGVudDogU3R1ZGVudCkge1xuICAgIHRoaXMuc3R1ZGVudHNbc3R1ZGVudC5maXJzdE5hbWVdID0gc3R1ZGVudFxuICAgIHN0dWRlbnQuYWRtaW5NZWRpYXRvciA9IHRoaXNcbiAgfVxuXG4gIHNlbmQobWVzc2FnZTogc3RyaW5nLCBmcm9tOiBTdHVkZW50LCB0bz86IFN0dWRlbnQsIGFkbWluPzogQWRtaW4pIHtcbiAgICBpZiAodG8pIHtcbiAgICAgIHRvLnJlY2VpdmUobWVzc2FnZSwgZnJvbSlcbiAgICB9IGVsc2Uge1xuICAgICAgT2JqZWN0LmtleXModGhpcy5zdHVkZW50cykuZm9yRWFjaChrZXkgPT4ge1xuICAgICAgICBpZiAodGhpcy5zdHVkZW50c1trZXldICE9PSBmcm9tKSB7XG4gICAgICAgICAgdGhpcy5zdHVkZW50c1trZXldLnJlY2VpdmUobWVzc2FnZSwgZnJvbSlcbiAgICAgICAgfVxuICAgICAgfSlcbiAgICB9XG4gIH1cbn1cblxuLy8gY2xhc3MgU3R1ZGVudE1lZGlhdG9yIHtcbi8vICAgc3R1ZGVudHM6IFJlY29yZDxzdHJpbmcsIFN0dWRlbnQ+XG4vLyAgIGNvbnN0cnVjdG9yKCkge1xuLy8gICAgIHRoaXMuc3R1ZGVudHMgPSB7fVxuLy8gICB9XG5cbi8vICAgcmVnaXN0ZXJTdHVkZW50KHN0dWRlbnQ6IFN0dWRlbnQpIHtcbi8vICAgICB0aGlzLnN0dWRlbnRzW3N0dWRlbnQuZmlyc3ROYW1lXSA9IHN0dWRlbnRcbi8vICAgICBzdHVkZW50LmFkbWluTWVkaWF0b3IgPSB0aGlzXG4vLyAgIH1cblxuLy8gICBzZW5kKG1lc3NhZ2U6IHN0cmluZywgZnJvbTogU3R1ZGVudCwgdG8/OiBTdHVkZW50KSB7XG4vLyAgICAgaWYgKHRvKSB7XG4vLyAgICAgICB0by5yZWNlaXZlKG1lc3NhZ2UsIGZyb20pXG4vLyAgICAgfSBlbHNlIHtcbi8vICAgICAgIE9iamVjdC5rZXlzKHRoaXMuc3R1ZGVudHMpLmZvckVhY2goa2V5ID0+IHtcbi8vICAgICAgICAgaWYgKHRoaXMuc3R1ZGVudHNba2V5XSAhPT0gZnJvbSkge1xuLy8gICAgICAgICAgIHRoaXMuc3R1ZGVudHNba2V5XS5yZWNlaXZlKG1lc3NhZ2UsIGZyb20pXG4vLyAgICAgICAgIH1cbi8vICAgICAgIH0pXG4vLyAgICAgfVxuLy8gICB9XG4vLyB9XG5jbGFzcyBDb3Vyc2VNZWRpYXRvciB7XG4gIGNvdXJzZXM6IFJlY29yZDxzdHJpbmcsIENvdXJzZT5cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgdGhpcy5jb3Vyc2VzID0ge31cbiAgfVxuXG4gIHJlZ2lzdGVyQ291cnNlKGNvdXJzZTogQ291cnNlKSB7XG4gICAgdGhpcy5jb3Vyc2VzW2NvdXJzZS50aXRsZV0gPSBjb3Vyc2VcbiAgICBjb3Vyc2UuY291cnNlTWVkaWF0b3IgPSB0aGlzXG4gIH1cblxuICBzZW5kKG1lc3NhZ2U6IHN0cmluZywgZnJvbTogQ291cnNlLCB0bz86IENvdXJzZSkge1xuICAgIC8vXG4gIH1cbn1cblxuZXhwb3J0IHsgQ291cnNlTWVkaWF0b3IsIEFkbWluTWVkaWF0b3IgfVxuIiwiaW1wb3J0IHsgQWRtaW5NZWRpYXRvciB9IGZyb20gXCIuL21lZGlhdG9yXCJcbmltcG9ydCB7IFBlcnNvbiB9IGZyb20gXCIuL1BlcnNvblwiXG5cbmNsYXNzIFN0dWRlbnQgZXh0ZW5kcyBQZXJzb24ge1xuICBhZG1pbk1lZGlhdG9yOiBudWxsIHwgQWRtaW5NZWRpYXRvclxuICBjb25zdHJ1Y3RvcihpZDogbnVtYmVyLCBmaXJzdE5hbWU6IHN0cmluZywgbGFzdE5hbWU6IHN0cmluZywgZW1haWw6IHN0cmluZywgYWdlOiBudW1iZXIpIHtcbiAgICBzdXBlcihpZCwgZmlyc3ROYW1lLCBsYXN0TmFtZSwgZW1haWwsIGFnZSlcbiAgICB0aGlzLmFkbWluTWVkaWF0b3IgPSBudWxsXG4gIH1cbiAgZGlzcGxheUluZm8oKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIG5hbWU6IGAke3RoaXMuZmlyc3ROYW1lfS0ke3RoaXMubGFzdE5hbWV9YCxcbiAgICAgIGVtYWlsOiB0aGlzLmVtYWlsLFxuICAgICAgYWdlOiBgJHt0aGlzLmFnZX1gLFxuICAgIH1cbiAgfVxuICBzZW5kKG1lc3NhZ2U6IHN0cmluZywgdG8/OiBTdHVkZW50KSB7XG4gICAgdGhpcy5hZG1pbk1lZGlhdG9yPy5zZW5kKG1lc3NhZ2UsIHRoaXMsIHRvKVxuICB9XG4gIHJlY2VpdmUobWVzc2FnZTogc3RyaW5nLCBmcm9tOiBTdHVkZW50KTogc3RyaW5nIHtcbiAgICByZXR1cm4gYCR7bWVzc2FnZX0gLSBmcm9tICR7ZnJvbX1gXG4gIH1cbn1cblxuY29uc3QgYWRtaW5NZWRpYXRvciA9IG5ldyBBZG1pbk1lZGlhdG9yKClcblxuY29uc3QgbG9hZFN0dWRlbnRzID0gKCkgPT4gW1xuICBuZXcgU3R1ZGVudCgxLCBcIkZyYW5rXCIsIFwiTWVsbGJlcmdcIiwgXCJmcmFua0Bpby5jb21cIiwgMjEpLFxuICBuZXcgU3R1ZGVudCgyLCBcIlJpb1wiLCBcIkZlcmRpbmFuZFwiLCBcInJpb0Bpby5jb21cIiwgMjUpLFxuICBuZXcgU3R1ZGVudCgzLCBcIk5lbWFuamFcIiwgXCJWaWRpY1wiLCBcIm5lbWFuamFAaW8uY29tXCIsIDMyKSxcbiAgbmV3IFN0dWRlbnQoNCwgXCJGcmVkcmlrXCIsIFwibGp1bmdiZXJnXCIsIFwiZnJlZHJpa0Bpby5jb21cIiwgMzIpLFxuXVxuXG5jb25zdCByZWdpc3RlckFsbFN0dWRlbnRzID0gKCk6IHZvaWQgPT4ge1xuICBmb3IgKGxldCBzdHVkZW50IG9mIGxvYWRTdHVkZW50cygpKSB7XG4gICAgYWRtaW5NZWRpYXRvci5yZWdpc3RlclN0dWRlbnQoc3R1ZGVudClcbiAgfVxufVxuXG5leHBvcnQgeyBTdHVkZW50LCBsb2FkU3R1ZGVudHMsIGFkbWluTWVkaWF0b3IsIHJlZ2lzdGVyQWxsU3R1ZGVudHMgfVxuIiwiaW1wb3J0IHsgU3R1ZGVudCB9IGZyb20gXCIuLi9tb2RlbHMvc3R1ZGVudFwiXG5pbXBvcnQgeyBUZWFjaGVyIH0gZnJvbSBcIi4uL21vZGVscy90ZWFjaGVyXCJcbmltcG9ydCB7IExpc3RWaWV3IH0gZnJvbSBcIi4vbGlzdC12aWV3XCJcblxuZXhwb3J0IGNsYXNzIE1vZGFsVmlldzxULCBTPiB7XG4gIHBhcmVudEVsZW1lbnQ6IEhUTUxEaXZFbGVtZW50XG4gIGxpc3Q6IEFycmF5PGFueT5cbiAgZGF0YTogU3R1ZGVudCB8IFRlYWNoZXJcbiAgdGl0bGU6IHN0cmluZ1xuICBsaXN0VmlldzogTGlzdFZpZXc8VD5cbiAgc3ViVGl0bGVzOiBzdHJpbmdbXVxuICBjb25maXJtYXRpb25UZXh0OiBzdHJpbmdcbiAgY29uc3RydWN0b3IoXG4gICAgcGFyZW50RWxlbWVudDogSFRNTERpdkVsZW1lbnQsXG4gICAgbGlzdDogYW55LFxuICAgIGRhdGE6IFN0dWRlbnQgfCBUZWFjaGVyLFxuICAgIHRpdGxlOiBzdHJpbmcsXG4gICAgc3ViVGl0bGVzOiBzdHJpbmdbXSxcbiAgKSB7XG4gICAgdGhpcy5wYXJlbnRFbGVtZW50ID0gcGFyZW50RWxlbWVudFxuICAgIHRoaXMubGlzdCA9IGxpc3RcbiAgICB0aGlzLmRhdGEgPSBkYXRhXG4gICAgdGhpcy50aXRsZSA9IHRpdGxlXG4gICAgdGhpcy5zdWJUaXRsZXMgPSBzdWJUaXRsZXNcbiAgICB0aGlzLmxpc3RWaWV3ID0gbmV3IExpc3RWaWV3KHRoaXMucGFyZW50RWxlbWVudCwgdGhpcy5saXN0LCB0aGlzLnRpdGxlLCB0aGlzLnN1YlRpdGxlcylcbiAgICB0aGlzLmNvbmZpcm1hdGlvblRleHQgPSBcIlwiXG4gIH1cblxuICB1cGRhdGVUZXh0KHRleHQ6IHN0cmluZykge1xuICAgIGNvbnNvbGUubG9nKFwiVEVYVFwiLCB0ZXh0KVxuICAgIHRoaXMuY29uZmlybWF0aW9uVGV4dCA9IHRleHRcbiAgfVxuXG4gIHJlbmRlcigpOiB2b2lkIHtcbiAgICBjb25zdCBtb2RhbFdyYXBwZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsXCIpIGFzIEhUTUxETGlzdEVsZW1lbnRcbiAgICBtb2RhbFdyYXBwZXIuY2xhc3NMaXN0LmFkZChcInNob3ctbW9kYWxcIilcblxuICAgIGNvbnN0IGh0bWwgPSBgXG4gICAgPGRpdiBjbGFzcz1cIm1vZGFsLWNvbnRhaW5lclwiPlxuICAgICAgJHt0aGlzLmxpc3RWaWV3LnJlbmRlclJhd0h0bWwoKX1cbiAgICAgICR7dGhpcy5jb25maXJtYXRpb25UZXh0fVxuICAgICAgPGJ1dHRvbiBjbGFzcz1cImNsb3NlLW1vZGFsXCI+XG4gICAgICAgIOKdjFxuICAgICAgPC9idXR0b24+XG4gICAgPC9kaXY+XG4gICAgYFxuXG4gICAgbW9kYWxXcmFwcGVyLmlubmVySFRNTCA9IGh0bWxcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNsb3NlLW1vZGFsXCIpPy5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgbW9kYWxXcmFwcGVyLmNsYXNzTGlzdC5yZW1vdmUoXCJzaG93LW1vZGFsXCIpXG4gICAgICBtb2RhbFdyYXBwZXIuaW5uZXJIVE1MID0gXCJcIlxuICAgIH0pXG5cbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLm1vZGFsIHRib2R5IHRyXCIpLmZvckVhY2goKHRyOiBhbnkpID0+IHtcbiAgICAgIHRyLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZlbnQ6IGFueSkgPT4ge1xuICAgICAgICBpZiAoXCJzZW5kXCIgaW4gdGhpcy5kYXRhKSB7XG4gICAgICAgICAgY29uc3QgY29uZmlybWF0aW9uVGV4dCA9IGBZb3UgaGF2ZSBub3cgYmVlbiByZWdpc3RlcmVkIHRvIHRoZSAke2V2ZW50LnRhcmdldC5pbm5lclRleHR9IENvdXJzZWBcbiAgICAgICAgICB0aGlzLmRhdGEuc2VuZChjb25maXJtYXRpb25UZXh0LCB0aGlzLmRhdGEpIC8vIHNlbmRpbmcgdG8geW91cnNlbGZcbiAgICAgICAgICB0aGlzLnVwZGF0ZVRleHQoY29uZmlybWF0aW9uVGV4dClcbiAgICAgICAgICB0aGlzLnVwZGF0ZUh0bWwoKVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gaWYgKHRyLmRhdGFzZXQuaWQgPT09IFN0cmluZyh0aGlzLmRhdGEuaWQpKSB7XG4gICAgICAgIC8vICAgaWYgKFwic2VuZFwiIGluIHRoaXMuZGF0YSkge1xuICAgICAgICAvLyAgICAgY29uc3QgY29uZmlybWF0aW9uVGV4dCA9IGBZb3UgaGF2ZSBub3cgYmVlbiByZWdpc3RlcmVkIHRvICR7ZXZlbnQudGFyZ2V0LmlubmVyVGV4dH1gXG4gICAgICAgIC8vICAgICB0aGlzLmRhdGEuc2VuZChjb25maXJtYXRpb25UZXh0LCB0aGlzLmRhdGEpXG4gICAgICAgIC8vICAgICB0aGlzLnVwZGF0ZVRleHQoY29uZmlybWF0aW9uVGV4dClcbiAgICAgICAgLy8gICB9XG4gICAgICAgIC8vIH1cbiAgICAgIH0pXG4gICAgfSlcbiAgfVxuICB1cGRhdGVIdG1sKCkge1xuICAgIHRoaXMucmVuZGVyKClcbiAgfVxufVxuIiwiaW1wb3J0IHsgQ291cnNlTWVkaWF0b3IgfSBmcm9tIFwiLi9tZWRpYXRvclwiXG5pbXBvcnQgeyBEaXNwbGF5SW5mbyB9IGZyb20gXCIuLi90eXBlc1wiXG5jbGFzcyBDb3Vyc2Uge1xuICBpZDogbnVtYmVyXG4gIHRpdGxlOiBzdHJpbmdcbiAgZGVzY3JpcHRpb246IHN0cmluZ1xuICBkdXJhdGlvbjogc3RyaW5nXG4gIGNvdXJzZU1lZGlhdG9yOiBudWxsIHwgQ291cnNlTWVkaWF0b3JcbiAgY29uc3RydWN0b3IoaWQ6IG51bWJlciwgdGl0bGU6IHN0cmluZywgZGVzY3JpcHRpb246IHN0cmluZywgZHVyYXRpb246IHN0cmluZykge1xuICAgIHRoaXMuaWQgPSBpZFxuICAgIHRoaXMudGl0bGUgPSB0aXRsZVxuICAgIHRoaXMuZGVzY3JpcHRpb24gPSBkZXNjcmlwdGlvblxuICAgIHRoaXMuZHVyYXRpb24gPSBkdXJhdGlvblxuICAgIHRoaXMuY291cnNlTWVkaWF0b3IgPSBudWxsXG4gIH1cblxuICBkaXNwbGF5SW5mbygpOiBEaXNwbGF5SW5mbyB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHRpdGxlOiB0aGlzLnRpdGxlLFxuICAgICAgZHVyYXRpb246IHRoaXMuZHVyYXRpb24sXG4gICAgfVxuICB9XG4gIHNlbmQoKSB7fVxuICByZWNlaXZlKCkge31cbn1cblxuY29uc3QgY291cnNlTWVkaWF0b3IgPSBuZXcgQ291cnNlTWVkaWF0b3IoKVxuXG5jb25zdCBsb2FkQ291cnNlcyA9ICgpOiBDb3Vyc2VbXSA9PiBbXG4gIG5ldyBDb3Vyc2UoMSwgXCJtYXRoXCIsIFwibWF0aCBpcyB3b25kZXJmdWxcIiwgXCI2aFwiKSxcbiAgbmV3IENvdXJzZSgyLCBcImhpc3RvcnlcIiwgXCJoaXN0b3J5IGlzIGdvb2QgZm9yIHlvdVwiLCBcIjNoXCIpLFxuICBuZXcgQ291cnNlKDMsIFwic3dlZGlzaFwiLCBcIndpdGhvdXQgc3dlZGlzaCB5b3Ugd2lsbCBmYWNlIHNvbWUgc2VyaW91cyBwcm9ibGVtc1wiLCBcIjJoXCIpLFxuICBuZXcgQ291cnNlKDQsIFwiZW5nbGlzaFwiLCBcInRoZSBnbG9iYWwgbGFuZ3VhZ2UsIGxlYXJuIGl0IE5PVyEhIVwiLCBcIjVoXCIpLFxuXVxuXG5jb25zdCByZWdpc3RlckNvdXJzZXMgPSAoKSA9PiB7XG4gIGZvciAobGV0IGNvdXJzZSBvZiBsb2FkQ291cnNlcygpKSB7XG4gICAgY291cnNlTWVkaWF0b3IucmVnaXN0ZXJDb3Vyc2UoY291cnNlKVxuICB9XG59XG5cbmV4cG9ydCB7IENvdXJzZSwgbG9hZENvdXJzZXMsIHJlZ2lzdGVyQ291cnNlcyB9XG4iLCJpbXBvcnQgeyBsb2FkU3R1ZGVudHMsIFN0dWRlbnQsIHJlZ2lzdGVyQWxsU3R1ZGVudHMsIGFkbWluTWVkaWF0b3IgfSBmcm9tIFwiLi4vbW9kZWxzL3N0dWRlbnRcIlxuaW1wb3J0IHsgTGlzdFZpZXcgfSBmcm9tIFwiLi4vdmlld3MvbGlzdC12aWV3XCJcbmltcG9ydCB7IE1vZGFsVmlldyBhcyBDb3Vyc2VzTW9kYWxWaWV3IH0gZnJvbSBcIi4uL3ZpZXdzL21vZGFsLXZpZXdcIlxuaW1wb3J0IHsgbG9hZENvdXJzZXMgfSBmcm9tIFwiLi4vbW9kZWxzL2NvdXJzZVwiXG5pbXBvcnQgeyBQcm9maWxlVmlldyB9IGZyb20gXCIuLi92aWV3cy9wcm9maWxlLXZpZXdcIlxuXG5leHBvcnQgY2xhc3MgU3R1ZGVudENvbnRyb2xsZXIge1xuICBwYXJlbnRFbGVtZW50OiBIVE1MRGl2RWxlbWVudFxuICBzdHVkZW50c1ZpZXc6IExpc3RWaWV3PFN0dWRlbnQ+XG4gIGNvbnN0cnVjdG9yKHBhcmVudEVsZW1lbnQ6IEhUTUxEaXZFbGVtZW50KSB7XG4gICAgdGhpcy5wYXJlbnRFbGVtZW50ID0gcGFyZW50RWxlbWVudFxuICAgIHRoaXMuc3R1ZGVudHNWaWV3ID0gbmV3IExpc3RWaWV3KHRoaXMucGFyZW50RWxlbWVudCwgbG9hZFN0dWRlbnRzKCksIFwiU3R1ZGVudHNcIiwgW1xuICAgICAgXCJuYW1lXCIsXG4gICAgICBcImVtYWlsXCIsXG4gICAgICBcImFnZVwiLFxuICAgIF0pXG4gIH1cblxuICBoYW5kbGVDbGlja1N0dWRlbnQoKTogdm9pZCB7XG4gICAgdGhpcy5zdHVkZW50c1ZpZXcuY2xpY2tIYW5kbGVyKChpZDogbnVtYmVyKSA9PiB7XG4gICAgICBjb25zdCBzdHVkZW50ID0gbG9hZFN0dWRlbnRzKCkuZmluZChzdHVkZW50ID0+IHN0dWRlbnQuaWQgPT09IGlkKVxuICAgICAgY29uc3QgZGF0YSA9IHN0dWRlbnQhIGFzIFN0dWRlbnRcbiAgICAgIGNvbnN0IGNvdXJzZXMgPSBsb2FkQ291cnNlcygpXG4gICAgICBjb25zdCBtb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWwtbGlzdFwiKSBhcyBIVE1MRGl2RWxlbWVudFxuICAgICAgbmV3IENvdXJzZXNNb2RhbFZpZXc8YW55W10sIFN0dWRlbnQ+KG1vZGFsLCBjb3Vyc2VzLCBkYXRhLCBcImNvdXJzZXNcIiwgW1xuICAgICAgICBcInRpdGxlXCIsXG4gICAgICAgIFwiZHVyYXRpb25cIixcbiAgICAgIF0pLnJlbmRlcigpXG4gICAgfSlcbiAgfVxuXG4gIGhhbmRsZVNob3dQcm9maWxlKCk6IHZvaWQge1xuICAgIC8vIHRoaXMucHJvZmlsZVZpZXcuY2xpY2tIYW5kbGVyKChpZDogbnVtYmVyKSA9PiB7XG4gICAgLy8gICBjb25zdCBzdHVkZW50ID0gbG9hZFN0dWRlbnRzKCkuZmluZChzdHVkZW50ID0+IHN0dWRlbnQuaWQgPT09IGlkKVxuICAgIC8vICAgY29uc3QgZGF0YSA9IHN0dWRlbnQhIGFzIFN0dWRlbnRcbiAgICAvLyAgIGNvbnN0IGNvdXJzZXMgPSBsb2FkQ291cnNlcygpXG4gICAgLy8gICBjb25zdCBtb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWwtbGlzdFwiKSBhcyBIVE1MRGl2RWxlbWVudFxuICAgIC8vICAgY29uc29sZS5sb2coXCJtb2RhbFwiLCBtb2RhbClcbiAgICAvLyB9KVxuICB9XG5cbiAgaW5pdCgpOiB2b2lkIHtcbiAgICB0aGlzLnN0dWRlbnRzVmlldy5pbml0KClcbiAgICB0aGlzLmhhbmRsZUNsaWNrU3R1ZGVudCgpXG4gICAgcmVnaXN0ZXJBbGxTdHVkZW50cygpXG4gICAgdGhpcy5oYW5kbGVTaG93UHJvZmlsZSgpXG4gICAgLy8gY29uc29sZS5sb2coXCJhZG1pbk1lZGlhdG9yXCIsIGFkbWluTWVkaWF0b3IpIC8vIWZvciB0ZXN0aW5nIVxuICB9XG59XG4iLCJpbXBvcnQgeyBBcHAgfSBmcm9tIFwiLi9wYXR0ZXJucy9tdmMyLjAvY29udHJvbGxlcnMvYXBwXCJcbmltcG9ydCB7IFRlYWNoZXJDb250cm9sbGVyIH0gZnJvbSBcIi4vcGF0dGVybnMvbXZjMi4wL2NvbnRyb2xsZXJzL3RlYWNoZXJcIlxuaW1wb3J0IHsgU3R1ZGVudENvbnRyb2xsZXIgfSBmcm9tIFwiLi9wYXR0ZXJucy9tdmMyLjAvY29udHJvbGxlcnMvc3R1ZGVudFwiXG47KCgpID0+IHtcbiAgY29uc3QgY3JlYXRlRWxlbWVudCA9ICh0YWc6IHN0cmluZywgY2xhc3NOYW1lOiBzdHJpbmcpOiBIVE1MRWxlbWVudCA9PiB7XG4gICAgY29uc3QgZWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQodGFnKVxuICAgIGVsZW1lbnQuY2xhc3NMaXN0LmFkZChjbGFzc05hbWUpXG4gICAgcmV0dXJuIGVsZW1lbnRcbiAgfVxuICBuZXcgQXBwKFxuICAgIG5ldyBUZWFjaGVyQ29udHJvbGxlcihkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInRlYWNoZXJcIikgYXMgSFRNTERpdkVsZW1lbnQpLFxuICAgIG5ldyBTdHVkZW50Q29udHJvbGxlcihkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInN0dWRlbnRcIikgYXMgSFRNTERpdkVsZW1lbnQpXG4gICkucmVuZGVyKClcbn0pKClcbiJdLCJzb3VyY2VSb290IjoiIn0=