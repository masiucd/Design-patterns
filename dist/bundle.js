(()=>{"use strict";var t,n=function(){function t(t,n){this.teacher=t,this.students=n}return t.prototype.render=function(){this.teacher.init(),this.students.init()},t}(),e=function(){function t(t,n,e,i){this.parentElement=t,this.dataList=n,this.title=e,this.subTitles=i}return t.prototype.clickHandler=function(t){document.querySelectorAll("tr").forEach((function(n){return n.addEventListener("click",(function(){t(parseInt(n.dataset.id,10)),sessionStorage.setItem("user",String(n.dataset.id))}))}))},t.prototype.render=function(){var t='\n    <div class="table-wrapper wrapper-'+this.title+'">\n    <table class="'+this.title+'">\n        <caption>'+this.title+"</caption>\n        <thead>\n          "+this.subTitles.map((function(t){return"<th>"+t+"</th>"})).join("")+"\n        </thead>\n        <tbody>\n          "+this.dataList.map((function(t){var n=t.displayInfo();return'\n                <tr data-id="'+t.id+'">\n                '+Object.keys(n).map((function(t){return'<td data-info="'+n[t]+'">'+n[t]+"</td>"})).join("")+"\n                </tr>\n          "})).join("")+"\n        </tbody>\n      </table>\n    </div>\n    ";this.parentElement.innerHTML=t},t.prototype.renderRawHtml=function(){return'\n    <div class="table-wrapper wrapper-'+this.title+'">\n    <table>\n        <caption>'+this.title+"</caption>\n        <thead>\n          "+this.subTitles.map((function(t){return"<th>"+t+"</th>"})).join("")+"\n        </thead>\n        <tbody>\n          "+this.dataList.map((function(t){var n=t.displayInfo();return'\n                <tr data-id="'+t.id+'">\n                '+Object.keys(n).map((function(t){return"<td>"+n[t]+"</td>"})).join("")+"\n                </tr>\n          "})).join("")+"\n        </tbody>\n      </table>\n    </div>\n    "},t.prototype.mount=function(t){t.innerHTML=this.renderRawHtml()},t.prototype.init=function(){this.render()},t}(),i=function(t,n,e,i,o){this.id=t,this.firstName=n,this.lastName=e,this.email=i,this.age=o},o=(t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])})(n,e)},function(n,e){function i(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),r=function(t){function n(n,e,i,o,r){var s=t.call(this,n,e,i,o,r)||this;return s.subjects=[],s}return o(n,t),n.prototype.displayInfo=function(){return{name:this.firstName+"-"+this.lastName,email:this.email,age:""+this.age}},n}(i),s=function(){function t(t){this.parentElement=t,this.teachersView=new e(this.parentElement,[new r(1,"Frank","Smith","frank@io.com",43),new r(2,"Logan","Jonsson","logan@io.com",47),new r(3,"Mia","Greger","mia@io.com",41),new r(4,"Boris","Rooney","frank@io.com",53)],"Teachers",["name","email","age"])}return t.prototype.init=function(){this.teachersView.init()},t}(),a=function(){function t(){this.students={}}return t.prototype.registerStudent=function(t){this.students[t.firstName]=t,t.adminMediator=this},t.prototype.send=function(t,n,e){var i=this;e?e.receive(t,n):Object.keys(this.students).forEach((function(e){i.students[e]!==n&&i.students[e].receive(t,n)}))},t}(),u=function(){function t(){this.courses={}}return t.prototype.registerCourse=function(t){this.courses[t.title]=t,t.courseMediator=this},t.prototype.send=function(t,n,e){},t}(),c=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])})(n,e)};return function(n,e){function i(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}(),l=function(t){function n(n,e,i,o,r){var s=t.call(this,n,e,i,o,r)||this;return s.adminMediator=null,s}return c(n,t),n.prototype.displayInfo=function(){return{name:this.firstName+"-"+this.lastName,email:this.email,age:""+this.age}},n.prototype.send=function(t,n){var e;null===(e=this.adminMediator)||void 0===e||e.send(t,this,n)},n.prototype.receive=function(t,n){return t+" - from "+n},n}(i),d=new a;console.log("adminMediator",d);var h=function(){return[new l(1,"Frank","Mellberg","frank@io.com",21),new l(2,"Rio","Ferdinand","rio@io.com",25),new l(3,"Nemanja","Vidic","nemanja@io.com",32),new l(4,"Fredrik","ljungberg","fredrik@io.com",32)]};console.log(h()[0].send("hello"));var p=function(){function t(t,n,i,o,r){this.parentElement=t,this.list=n,this.data=i,this.title=o,this.subTitles=r,this.listView=new e(this.parentElement,this.list,this.title,this.subTitles),this.confirmationText=""}return t.prototype.updateText=function(t){console.log("TEXT",t),this.confirmationText=t},t.prototype.render=function(){var t,n=this,e=document.querySelector(".modal");e.classList.add("show-modal");var i='\n    <div class="modal-container">\n      '+this.listView.renderRawHtml()+"\n      "+this.confirmationText+'\n      <button class="close-modal">\n        ‚ùå\n      </button>\n    </div>\n    ';e.innerHTML=i,null===(t=document.querySelector(".close-modal"))||void 0===t||t.addEventListener("click",(function(){e.classList.remove("show-modal"),e.innerHTML=""})),document.querySelectorAll(".modal tbody tr").forEach((function(t){t.addEventListener("click",(function(t){if("send"in n.data){var e="You have now been registered to the "+t.target.innerText+" Course";n.data.send(e,n.data),n.updateText(e),n.updateHtml()}}))}))},t.prototype.updateHtml=function(){this.render()},t}(),f=function(){function t(t,n,e,i){this.id=t,this.title=n,this.description=e,this.duration=i,this.courseMediator=null}return t.prototype.displayInfo=function(){return{title:this.title,duration:this.duration}},t.prototype.send=function(){},t.prototype.receive=function(){},t}(),m=(new u,function(){return[new f(1,"math","math is wonderful","6h"),new f(2,"history","history is good for you","3h"),new f(3,"swedish","without swedish you will face some serious problems","2h"),new f(4,"english","the global language, learn it NOW!!!","5h")]}),y=function(){function t(){}return t.prototype.clickHandler=function(){},t}(),w=function(){function t(t){this.parentElement=t,this.studentsView=new e(this.parentElement,h(),"Students",["name","email","age"]),this.profileView=new y}return t.prototype.handleClickStudent=function(){this.studentsView.clickHandler((function(t){var n=h().find((function(n){return n.id===t}));console.log("data",n);var e=m(),i=document.querySelector(".modal-list");new p(i,e,n,"courses",["title","duration"]).render()}))},t.prototype.handleShowProfile=function(){},t.prototype.init=function(){this.studentsView.init(),this.handleClickStudent(),function(){for(var t=0,n=h();t<n.length;t++){var e=n[t];d.registerStudent(e)}}(),console.log("adminMediator",d)},t}();new n(new s(document.getElementById("teacher")),new w(document.getElementById("student"))).render()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zY2hvb2wtZGF0YS8uL3NyYy9wYXR0ZXJucy9tdmMyLjAvY29udHJvbGxlcnMvYXBwLnRzIiwid2VicGFjazovL3NjaG9vbC1kYXRhLy4vc3JjL3BhdHRlcm5zL212YzIuMC92aWV3cy9saXN0LXZpZXcudHMiLCJ3ZWJwYWNrOi8vc2Nob29sLWRhdGEvLi9zcmMvcGF0dGVybnMvbXZjMi4wL21vZGVscy9QZXJzb24udHMiLCJ3ZWJwYWNrOi8vc2Nob29sLWRhdGEvLi9zcmMvcGF0dGVybnMvbXZjMi4wL21vZGVscy90ZWFjaGVyLnRzIiwid2VicGFjazovL3NjaG9vbC1kYXRhLy4vc3JjL3BhdHRlcm5zL212YzIuMC9jb250cm9sbGVycy90ZWFjaGVyLnRzIiwid2VicGFjazovL3NjaG9vbC1kYXRhLy4vc3JjL3BhdHRlcm5zL212YzIuMC9tb2RlbHMvbWVkaWF0b3IudHMiLCJ3ZWJwYWNrOi8vc2Nob29sLWRhdGEvLi9zcmMvcGF0dGVybnMvbXZjMi4wL21vZGVscy9zdHVkZW50LnRzIiwid2VicGFjazovL3NjaG9vbC1kYXRhLy4vc3JjL3BhdHRlcm5zL212YzIuMC92aWV3cy9tb2RhbC12aWV3LnRzIiwid2VicGFjazovL3NjaG9vbC1kYXRhLy4vc3JjL3BhdHRlcm5zL212YzIuMC9tb2RlbHMvY291cnNlLnRzIiwid2VicGFjazovL3NjaG9vbC1kYXRhLy4vc3JjL3BhdHRlcm5zL212YzIuMC92aWV3cy9wcm9maWxlLXZpZXcudHMiLCJ3ZWJwYWNrOi8vc2Nob29sLWRhdGEvLi9zcmMvcGF0dGVybnMvbXZjMi4wL2NvbnRyb2xsZXJzL3N0dWRlbnQudHMiLCJ3ZWJwYWNrOi8vc2Nob29sLWRhdGEvLi9zcmMvaW5kZXgudHMiXSwibmFtZXMiOlsidGVhY2hlciIsInN0dWRlbnRzIiwidGhpcyIsInJlbmRlciIsImluaXQiLCJwYXJlbnRFbGVtZW50IiwiZGF0YUxpc3QiLCJ0aXRsZSIsInN1YlRpdGxlcyIsImNsaWNrSGFuZGxlciIsInN1YnNjcmliZXIiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJmb3JFYWNoIiwidHIiLCJhZGRFdmVudExpc3RlbmVyIiwicGFyc2VJbnQiLCJkYXRhc2V0IiwiaWQiLCJzZXNzaW9uU3RvcmFnZSIsInNldEl0ZW0iLCJTdHJpbmciLCJodG1sIiwibWFwIiwidCIsImpvaW4iLCJkYXRhIiwiZGlzcGxheUluZm8iLCJPYmplY3QiLCJrZXlzIiwia2V5IiwiaW5uZXJIVE1MIiwicmVuZGVyUmF3SHRtbCIsIm1vdW50IiwiZWxlbWVudCIsImZpcnN0TmFtZSIsImxhc3ROYW1lIiwiZW1haWwiLCJhZ2UiLCJzdWJqZWN0cyIsIm5hbWUiLCJQZXJzb24iLCJ0ZWFjaGVyc1ZpZXciLCJMaXN0VmlldyIsIlRlYWNoZXIiLCJyZWdpc3RlclN0dWRlbnQiLCJzdHVkZW50IiwiYWRtaW5NZWRpYXRvciIsInNlbmQiLCJtZXNzYWdlIiwiZnJvbSIsInRvIiwicmVjZWl2ZSIsImNvdXJzZXMiLCJyZWdpc3RlckNvdXJzZSIsImNvdXJzZSIsImNvdXJzZU1lZGlhdG9yIiwiQWRtaW5NZWRpYXRvciIsImNvbnNvbGUiLCJsb2ciLCJsb2FkU3R1ZGVudHMiLCJTdHVkZW50IiwibGlzdCIsImxpc3RWaWV3IiwiY29uZmlybWF0aW9uVGV4dCIsInVwZGF0ZVRleHQiLCJ0ZXh0IiwibW9kYWxXcmFwcGVyIiwicXVlcnlTZWxlY3RvciIsImNsYXNzTGlzdCIsImFkZCIsInJlbW92ZSIsImV2ZW50IiwidGFyZ2V0IiwiaW5uZXJUZXh0IiwidXBkYXRlSHRtbCIsImRlc2NyaXB0aW9uIiwiZHVyYXRpb24iLCJsb2FkQ291cnNlcyIsIkNvdXJzZU1lZGlhdG9yIiwiQ291cnNlIiwic3R1ZGVudHNWaWV3IiwicHJvZmlsZVZpZXciLCJQcm9maWxlVmlldyIsImhhbmRsZUNsaWNrU3R1ZGVudCIsImZpbmQiLCJtb2RhbCIsImhhbmRsZVNob3dQcm9maWxlIiwicmVnaXN0ZXJBbGxTdHVkZW50cyIsIkFwcCIsIlRlYWNoZXJDb250cm9sbGVyIiwiZ2V0RWxlbWVudEJ5SWQiLCJTdHVkZW50Q29udHJvbGxlciJdLCJtYXBwaW5ncyI6Im1CQUlBLEksRUFBQSxhQUlFLFdBQVlBLEVBQTRCQyxHQUN0Q0MsS0FBS0YsUUFBVUEsRUFFZkUsS0FBS0QsU0FBV0EsRUFRcEIsT0FMRSxZQUFBRSxPQUFBLFdBQ0VELEtBQUtGLFFBQVFJLE9BRWJGLEtBQUtELFNBQVNHLFFBRWxCLEVBZkEsR0NEQSxhQUtFLFdBQ0VDLEVBQ0FDLEVBQ0FDLEVBQ0FDLEdBRUFOLEtBQUtHLGNBQWdCQSxFQUNyQkgsS0FBS0ksU0FBV0EsRUFDaEJKLEtBQUtLLE1BQVFBLEVBQ2JMLEtBQUtNLFVBQVlBLEVBNEVyQixPQXpFRSxZQUFBQyxhQUFBLFNBQWFDLEdBQ0NDLFNBQVNDLGlCQUFpQixNQUNsQ0MsU0FBUSxTQUFBQyxHQUNWLE9BQUFBLEVBQUdDLGlCQUFpQixTQUFTLFdBQzNCTCxFQUFXTSxTQUFTRixFQUFHRyxRQUFRQyxHQUFLLEtBQ3BDQyxlQUFlQyxRQUFRLE9BQVFDLE9BQU9QLEVBQUdHLFFBQVFDLFlBSy9DLFlBQUFmLE9BQVIsV0FDRSxJQUFNbUIsRUFBTywyQ0FDdUJwQixLQUFLSyxNQUFLLHlCQUM5QkwsS0FBS0ssTUFBSyx3QkFDWEwsS0FBS0ssTUFBSywwQ0FFakJMLEtBQUtNLFVBQVVlLEtBQUksU0FBQUMsR0FBSyxhQUFPQSxFQUFDLFdBQVNDLEtBQUssSUFBRyxrREFHaER2QixLQUFLSSxTQUNMaUIsS0FBSSxTQUFDRyxHQUNKLElBQU1DLEVBQWNELEVBQUtDLGNBQ3pCLE1BQU8sa0NBQ1VELEVBQUtSLEdBQUUsdUJBQ3BCVSxPQUFPQyxLQUFLRixHQUNYSixLQUFJLFNBQUFPLEdBQU8sd0JBQWtCSCxFQUFZRyxHQUFJLEtBQUtILEVBQVlHLEdBQUksV0FDbEVMLEtBQUssSUFBRyx5Q0FJZEEsS0FBSyxJQUFHLHVEQUtqQnZCLEtBQUtHLGNBQWMwQixVQUFZVCxHQUdqQyxZQUFBVSxjQUFBLFdBeUJFLE1BeEJhLDJDQUN1QjlCLEtBQUtLLE1BQUsscUNBRS9CTCxLQUFLSyxNQUFLLDBDQUVqQkwsS0FBS00sVUFBVWUsS0FBSSxTQUFBQyxHQUFLLGFBQU9BLEVBQUMsV0FBU0MsS0FBSyxJQUFHLGtEQUdoRHZCLEtBQUtJLFNBQ0xpQixLQUFJLFNBQUNHLEdBQ0osSUFBTUMsRUFBY0QsRUFBS0MsY0FDekIsTUFBTyxrQ0FDVUQsRUFBS1IsR0FBRSx1QkFDcEJVLE9BQU9DLEtBQUtGLEdBQ1hKLEtBQUksU0FBQU8sR0FBTyxhQUFPSCxFQUFZRyxHQUFJLFdBQ2xDTCxLQUFLLElBQUcseUNBSWRBLEtBQUssSUFBRyx3REFRbkIsWUFBQVEsTUFBQSxTQUFNQyxHQUNKQSxFQUFRSCxVQUFZN0IsS0FBSzhCLGlCQUczQixZQUFBNUIsS0FBQSxXQUNFRixLQUFLQyxVQUVULEVBMUZBLEdDSEEsRUFNRSxTQUFZZSxFQUFZaUIsRUFBbUJDLEVBQWtCQyxFQUFlQyxHQUMxRXBDLEtBQUtnQixHQUFLQSxFQUNWaEIsS0FBS2lDLFVBQVlBLEVBQ2pCakMsS0FBS2tDLFNBQVdBLEVBQ2hCbEMsS0FBS21DLE1BQVFBLEVBQ2JuQyxLQUFLb0MsSUFBTUEsRywwVUNQZixjQUVFLFdBQVlwQixFQUFZaUIsRUFBbUJDLEVBQWtCQyxFQUFlQyxHQUE1RSxNQUNFLFlBQU1wQixFQUFJaUIsRUFBV0MsRUFBVUMsRUFBT0MsSUFBSSxLLE9BQzFDLEVBQUtDLFNBQVcsRyxFQVVwQixPQWQ2QixPQU8zQixZQUFBWixZQUFBLFdBQ0UsTUFBTyxDQUNMYSxLQUFTdEMsS0FBS2lDLFVBQVMsSUFBSWpDLEtBQUtrQyxTQUNoQ0MsTUFBT25DLEtBQUttQyxNQUNaQyxJQUFLLEdBQUdwQyxLQUFLb0MsTUFHbkIsRUFkQSxDQUE2QkcsR0NEN0IsYUFHRSxXQUFZcEMsR0FDVkgsS0FBS0csY0FBZ0JBLEVBQ3JCSCxLQUFLd0MsYUFBZSxJQUFJQyxFQUFTekMsS0FBS0csY0RZUixDQUNoQyxJQUFJdUMsRUFBUSxFQUFHLFFBQVMsUUFBUyxlQUFnQixJQUNqRCxJQUFJQSxFQUFRLEVBQUcsUUFBUyxVQUFXLGVBQWdCLElBQ25ELElBQUlBLEVBQVEsRUFBRyxNQUFPLFNBQVUsYUFBYyxJQUM5QyxJQUFJQSxFQUFRLEVBQUcsUUFBUyxTQUFVLGVBQWdCLEtDaEJxQixXQUFZLENBQy9FLE9BQ0EsUUFDQSxRQU9OLE9BSEUsWUFBQXhDLEtBQUEsV0FDRUYsS0FBS3dDLGFBQWF0QyxRQUV0QixFQWZBLEdDQUEsYUFFRSxhQUNFRixLQUFLRCxTQUFXLEdBa0JwQixPQWhCRSxZQUFBNEMsZ0JBQUEsU0FBZ0JDLEdBQ2Q1QyxLQUFLRCxTQUFTNkMsRUFBUVgsV0FBYVcsRUFDbkNBLEVBQVFDLGNBQWdCN0MsTUFHMUIsWUFBQThDLEtBQUEsU0FBS0MsRUFBaUJDLEVBQWVDLEdBQXJDLFdBQ01BLEVBQ0ZBLEVBQUdDLFFBQVFILEVBQVNDLEdBRXBCdEIsT0FBT0MsS0FBSzNCLEtBQUtELFVBQVVZLFNBQVEsU0FBQWlCLEdBQzdCLEVBQUs3QixTQUFTNkIsS0FBU29CLEdBQ3pCLEVBQUtqRCxTQUFTNkIsR0FBS3NCLFFBQVFILEVBQVNDLE9BSzlDLEVBckJBLEdBOENBLGFBRUUsYUFDRWhELEtBQUttRCxRQUFVLEdBV25CLE9BUkUsWUFBQUMsZUFBQSxTQUFlQyxHQUNickQsS0FBS21ELFFBQVFFLEVBQU9oRCxPQUFTZ0QsRUFDN0JBLEVBQU9DLGVBQWlCdEQsTUFHMUIsWUFBQThDLEtBQUEsU0FBS0MsRUFBaUJDLEVBQWNDLEtBR3RDLEVBZEEsRyxpV0M5Q0EsY0FFRSxXQUFZakMsRUFBWWlCLEVBQW1CQyxFQUFrQkMsRUFBZUMsR0FBNUUsTUFDRSxZQUFNcEIsRUFBSWlCLEVBQVdDLEVBQVVDLEVBQU9DLElBQUksSyxPQUMxQyxFQUFLUyxjQUFnQixLLEVBZXpCLE9BbkJzQixPQU1wQixZQUFBcEIsWUFBQSxXQUNFLE1BQU8sQ0FDTGEsS0FBU3RDLEtBQUtpQyxVQUFTLElBQUlqQyxLQUFLa0MsU0FDaENDLE1BQU9uQyxLQUFLbUMsTUFDWkMsSUFBSyxHQUFHcEMsS0FBS29DLE1BR2pCLFlBQUFVLEtBQUEsU0FBS0MsRUFBaUJFLEcsTUFDRixRQUFsQixFQUFBakQsS0FBSzZDLHFCQUFhLFNBQUVDLEtBQUtDLEVBQVMvQyxLQUFNaUQsSUFFMUMsWUFBQUMsUUFBQSxTQUFRSCxFQUFpQkMsR0FDdkIsT0FBVUQsRUFBTyxXQUFXQyxHQUVoQyxFQW5CQSxDQUFzQlQsR0FxQmhCTSxFQUFnQixJQUFJVSxFQUUxQkMsUUFBUUMsSUFBSSxnQkFBaUJaLEdBRTdCLElBQU1hLEVBQWUsV0FBTSxPQUN6QixJQUFJQyxFQUFRLEVBQUcsUUFBUyxXQUFZLGVBQWdCLElBQ3BELElBQUlBLEVBQVEsRUFBRyxNQUFPLFlBQWEsYUFBYyxJQUNqRCxJQUFJQSxFQUFRLEVBQUcsVUFBVyxRQUFTLGlCQUFrQixJQUNyRCxJQUFJQSxFQUFRLEVBQUcsVUFBVyxZQUFhLGlCQUFrQixNQUczREgsUUFBUUMsSUFBSUMsSUFBZSxHQUFHWixLQUFLLFVBQ25DLElDaENBLGFBUUUsV0FDRTNDLEVBQ0F5RCxFQUNBcEMsRUFDQW5CLEVBQ0FDLEdBRUFOLEtBQUtHLGNBQWdCQSxFQUNyQkgsS0FBSzRELEtBQU9BLEVBQ1o1RCxLQUFLd0IsS0FBT0EsRUFDWnhCLEtBQUtLLE1BQVFBLEVBQ2JMLEtBQUtNLFVBQVlBLEVBQ2pCTixLQUFLNkQsU0FBVyxJQUFJcEIsRUFBU3pDLEtBQUtHLGNBQWVILEtBQUs0RCxLQUFNNUQsS0FBS0ssTUFBT0wsS0FBS00sV0FDN0VOLEtBQUs4RCxpQkFBbUIsR0FrRDVCLE9BL0NFLFlBQUFDLFdBQUEsU0FBV0MsR0FDVFIsUUFBUUMsSUFBSSxPQUFRTyxHQUNwQmhFLEtBQUs4RCxpQkFBbUJFLEdBRzFCLFlBQUEvRCxPQUFBLGUsRUFBQSxPQUNRZ0UsRUFBZXhELFNBQVN5RCxjQUFjLFVBQzVDRCxFQUFhRSxVQUFVQyxJQUFJLGNBRTNCLElBQU1oRCxFQUFPLDhDQUVUcEIsS0FBSzZELFNBQVMvQixnQkFBZSxXQUM3QjlCLEtBQUs4RCxpQkFBZ0IscUZBT3pCRyxFQUFhcEMsVUFBWVQsRUFDYSxRQUF0QyxFQUFBWCxTQUFTeUQsY0FBYyx1QkFBZSxTQUFFckQsaUJBQWlCLFNBQVMsV0FDaEVvRCxFQUFhRSxVQUFVRSxPQUFPLGNBQzlCSixFQUFhcEMsVUFBWSxNQUczQnBCLFNBQVNDLGlCQUFpQixtQkFBbUJDLFNBQVEsU0FBQ0MsR0FDcERBLEVBQUdDLGlCQUFpQixTQUFTLFNBQUN5RCxHQUM1QixHQUFJLFNBQVUsRUFBSzlDLEtBQU0sQ0FDdkIsSUFBTXNDLEVBQW1CLHVDQUF1Q1EsRUFBTUMsT0FBT0MsVUFBUyxVQUN0RixFQUFLaEQsS0FBS3NCLEtBQUtnQixFQUFrQixFQUFLdEMsTUFDdEMsRUFBS3VDLFdBQVdELEdBQ2hCLEVBQUtXLHFCQWFiLFlBQUFBLFdBQUEsV0FDRXpFLEtBQUtDLFVBRVQsRUF2RUEsR0NGQSxhQU1FLFdBQVllLEVBQVlYLEVBQWVxRSxFQUFxQkMsR0FDMUQzRSxLQUFLZ0IsR0FBS0EsRUFDVmhCLEtBQUtLLE1BQVFBLEVBQ2JMLEtBQUswRSxZQUFjQSxFQUNuQjFFLEtBQUsyRSxTQUFXQSxFQUNoQjNFLEtBQUtzRCxlQUFpQixLQVcxQixPQVJFLFlBQUE3QixZQUFBLFdBQ0UsTUFBTyxDQUNMcEIsTUFBT0wsS0FBS0ssTUFDWnNFLFNBQVUzRSxLQUFLMkUsV0FHbkIsWUFBQTdCLEtBQUEsYUFDQSxZQUFBSSxRQUFBLGFBQ0YsRUF0QkEsR0EwQk0wQixHQUZpQixJQUFJQyxFQUVQLFdBQWdCLE9BQ2xDLElBQUlDLEVBQU8sRUFBRyxPQUFRLG9CQUFxQixNQUMzQyxJQUFJQSxFQUFPLEVBQUcsVUFBVywwQkFBMkIsTUFDcEQsSUFBSUEsRUFBTyxFQUFHLFVBQVcsc0RBQXVELE1BQ2hGLElBQUlBLEVBQU8sRUFBRyxVQUFXLHVDQUF3QyxTQ2hDbkUsYUFDRSxjQUdGLE9BREUsWUFBQXZFLGFBQUEsYUFDRixFQUpBLEdDTUEsYUFJRSxXQUFZSixHQUNWSCxLQUFLRyxjQUFnQkEsRUFDckJILEtBQUsrRSxhQUFlLElBQUl0QyxFQUFTekMsS0FBS0csY0FBZXVELElBQWdCLFdBQVksQ0FDL0UsT0FDQSxRQUNBLFFBRUYxRCxLQUFLZ0YsWUFBYyxJQUFJQyxFQTJCM0IsT0F4QkUsWUFBQUMsbUJBQUEsV0FDRWxGLEtBQUsrRSxhQUFheEUsY0FBYSxTQUFDUyxHQUM5QixJQUNNUSxFQURVa0MsSUFBZXlCLE1BQUssU0FBQXZDLEdBQVcsT0FBQUEsRUFBUTVCLEtBQU9BLEtBRTlEd0MsUUFBUUMsSUFBSSxPQUFRakMsR0FDcEIsSUFBTTJCLEVBQVV5QixJQUNWUSxFQUFRM0UsU0FBU3lELGNBQWMsZUFDckMsSUFBSSxFQUFpQ2tCLEVBQU9qQyxFQUFTM0IsRUFBTSxVQUFXLENBQ3BFLFFBQ0EsYUFDQ3ZCLGFBSVAsWUFBQW9GLGtCQUFBLGFBSUEsWUFBQW5GLEtBQUEsV0FDRUYsS0FBSytFLGFBQWE3RSxPQUNsQkYsS0FBS2tGLHFCSkptQixXQUMxQixJQUFvQixVQUFBeEIsSUFBQSxlQUFnQixDQUEvQixJQUFJZCxFQUFPLEtBQ2RDLEVBQWNGLGdCQUFnQkMsSUlHOUIwQyxHQUNBOUIsUUFBUUMsSUFBSSxnQkFBaUJaLElBRWpDLEVBdENBLEdDR0UsSUFBSTBDLEVBQ0YsSUFBSUMsRUFBa0IvRSxTQUFTZ0YsZUFBZSxZQUM5QyxJQUFJQyxFQUFrQmpGLFNBQVNnRixlQUFlLGFBQzlDeEYsVSIsImZpbGUiOiJidW5kbGUuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBUZWFjaGVyQ29udHJvbGxlciB9IGZyb20gXCIuL3RlYWNoZXJcIlxuaW1wb3J0IHsgQ291cnNlQ29udHJvbGxlciB9IGZyb20gXCIuL2NvdXJzZVwiXG5pbXBvcnQgeyBTdHVkZW50Q29udHJvbGxlciB9IGZyb20gXCIuL3N0dWRlbnRcIlxuXG5leHBvcnQgY2xhc3MgQXBwIHtcbiAgdGVhY2hlcjogVGVhY2hlckNvbnRyb2xsZXJcbiAgLy8gY291cnNlczogQ291cnNlQ29udHJvbGxlclxuICBzdHVkZW50czogU3R1ZGVudENvbnRyb2xsZXJcbiAgY29uc3RydWN0b3IodGVhY2hlcjogVGVhY2hlckNvbnRyb2xsZXIsIHN0dWRlbnRzOiBTdHVkZW50Q29udHJvbGxlcikge1xuICAgIHRoaXMudGVhY2hlciA9IHRlYWNoZXJcbiAgICAvLyB0aGlzLmNvdXJzZXMgPSBjb3Vyc2VzXG4gICAgdGhpcy5zdHVkZW50cyA9IHN0dWRlbnRzXG4gIH1cblxuICByZW5kZXIoKTogdm9pZCB7XG4gICAgdGhpcy50ZWFjaGVyLmluaXQoKVxuICAgIC8vIHRoaXMuY291cnNlcy5pbml0KClcbiAgICB0aGlzLnN0dWRlbnRzLmluaXQoKVxuICB9XG59XG4iLCJpbXBvcnQgeyBDb3Vyc2UgfSBmcm9tIFwiLi4vLi4vbXZjL21vZGVscy9jb3Vyc2UtbW9kZWxcIlxuaW1wb3J0IHsgVGVhY2hlciB9IGZyb20gXCIuLi9tb2RlbHMvdGVhY2hlclwiXG5cbmV4cG9ydCBjbGFzcyBMaXN0VmlldzxUPiB7XG4gIHBhcmVudEVsZW1lbnQ6IEhUTUxEaXZFbGVtZW50XG4gIGRhdGFMaXN0OiBBcnJheTxUPlxuICB0aXRsZTogc3RyaW5nXG4gIHN1YlRpdGxlczogc3RyaW5nW11cbiAgY29uc3RydWN0b3IoXG4gICAgcGFyZW50RWxlbWVudDogSFRNTERpdkVsZW1lbnQsXG4gICAgZGF0YUxpc3Q6IEFycmF5PFQ+LFxuICAgIHRpdGxlOiBzdHJpbmcsXG4gICAgc3ViVGl0bGVzOiBzdHJpbmdbXVxuICApIHtcbiAgICB0aGlzLnBhcmVudEVsZW1lbnQgPSBwYXJlbnRFbGVtZW50XG4gICAgdGhpcy5kYXRhTGlzdCA9IGRhdGFMaXN0XG4gICAgdGhpcy50aXRsZSA9IHRpdGxlXG4gICAgdGhpcy5zdWJUaXRsZXMgPSBzdWJUaXRsZXNcbiAgfVxuXG4gIGNsaWNrSGFuZGxlcihzdWJzY3JpYmVyOiBGdW5jdGlvbikge1xuICAgIGNvbnN0IHRycyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCJ0clwiKVxuICAgIHRycy5mb3JFYWNoKHRyID0+XG4gICAgICB0ci5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgICBzdWJzY3JpYmVyKHBhcnNlSW50KHRyLmRhdGFzZXQuaWQhLCAxMCkpXG4gICAgICAgIHNlc3Npb25TdG9yYWdlLnNldEl0ZW0oXCJ1c2VyXCIsIFN0cmluZyh0ci5kYXRhc2V0LmlkKSlcbiAgICAgIH0pXG4gICAgKVxuICB9XG5cbiAgcHJpdmF0ZSByZW5kZXIoKTogdm9pZCB7XG4gICAgY29uc3QgaHRtbCA9IGBcbiAgICA8ZGl2IGNsYXNzPVwidGFibGUtd3JhcHBlciB3cmFwcGVyLSR7dGhpcy50aXRsZX1cIj5cbiAgICA8dGFibGUgY2xhc3M9XCIke3RoaXMudGl0bGV9XCI+XG4gICAgICAgIDxjYXB0aW9uPiR7dGhpcy50aXRsZX08L2NhcHRpb24+XG4gICAgICAgIDx0aGVhZD5cbiAgICAgICAgICAke3RoaXMuc3ViVGl0bGVzLm1hcCh0ID0+IGA8dGg+JHt0fTwvdGg+YCkuam9pbihcIlwiKX1cbiAgICAgICAgPC90aGVhZD5cbiAgICAgICAgPHRib2R5PlxuICAgICAgICAgICR7KHRoaXMuZGF0YUxpc3QgYXMgQXJyYXk8VD4pXG4gICAgICAgICAgICAubWFwKChkYXRhOiBhbnkpID0+IHtcbiAgICAgICAgICAgICAgY29uc3QgZGlzcGxheUluZm8gPSBkYXRhLmRpc3BsYXlJbmZvKCkgYXMgeyBba2V5OiBzdHJpbmddOiBzdHJpbmcgfVxuICAgICAgICAgICAgICByZXR1cm4gYFxuICAgICAgICAgICAgICAgIDx0ciBkYXRhLWlkPVwiJHtkYXRhLmlkfVwiPlxuICAgICAgICAgICAgICAgICR7T2JqZWN0LmtleXMoZGlzcGxheUluZm8pXG4gICAgICAgICAgICAgICAgICAubWFwKGtleSA9PiBgPHRkIGRhdGEtaW5mbz1cIiR7ZGlzcGxheUluZm9ba2V5XX1cIj4ke2Rpc3BsYXlJbmZvW2tleV19PC90ZD5gKVxuICAgICAgICAgICAgICAgICAgLmpvaW4oXCJcIil9XG4gICAgICAgICAgICAgICAgPC90cj5cbiAgICAgICAgICBgXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmpvaW4oXCJcIil9XG4gICAgICAgIDwvdGJvZHk+XG4gICAgICA8L3RhYmxlPlxuICAgIDwvZGl2PlxuICAgIGBcbiAgICB0aGlzLnBhcmVudEVsZW1lbnQuaW5uZXJIVE1MID0gaHRtbFxuICB9XG5cbiAgcmVuZGVyUmF3SHRtbCgpOiBzdHJpbmcge1xuICAgIGNvbnN0IGh0bWwgPSBgXG4gICAgPGRpdiBjbGFzcz1cInRhYmxlLXdyYXBwZXIgd3JhcHBlci0ke3RoaXMudGl0bGV9XCI+XG4gICAgPHRhYmxlPlxuICAgICAgICA8Y2FwdGlvbj4ke3RoaXMudGl0bGV9PC9jYXB0aW9uPlxuICAgICAgICA8dGhlYWQ+XG4gICAgICAgICAgJHt0aGlzLnN1YlRpdGxlcy5tYXAodCA9PiBgPHRoPiR7dH08L3RoPmApLmpvaW4oXCJcIil9XG4gICAgICAgIDwvdGhlYWQ+XG4gICAgICAgIDx0Ym9keT5cbiAgICAgICAgICAkeyh0aGlzLmRhdGFMaXN0IGFzIEFycmF5PGFueT4pXG4gICAgICAgICAgICAubWFwKChkYXRhOiBhbnkpID0+IHtcbiAgICAgICAgICAgICAgY29uc3QgZGlzcGxheUluZm8gPSBkYXRhLmRpc3BsYXlJbmZvKCkgYXMgeyBba2V5OiBzdHJpbmddOiBzdHJpbmcgfVxuICAgICAgICAgICAgICByZXR1cm4gYFxuICAgICAgICAgICAgICAgIDx0ciBkYXRhLWlkPVwiJHtkYXRhLmlkfVwiPlxuICAgICAgICAgICAgICAgICR7T2JqZWN0LmtleXMoZGlzcGxheUluZm8pXG4gICAgICAgICAgICAgICAgICAubWFwKGtleSA9PiBgPHRkPiR7ZGlzcGxheUluZm9ba2V5XX08L3RkPmApXG4gICAgICAgICAgICAgICAgICAuam9pbihcIlwiKX1cbiAgICAgICAgICAgICAgICA8L3RyPlxuICAgICAgICAgIGBcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuam9pbihcIlwiKX1cbiAgICAgICAgPC90Ym9keT5cbiAgICAgIDwvdGFibGU+XG4gICAgPC9kaXY+XG4gICAgYFxuICAgIHJldHVybiBodG1sXG4gIH1cblxuICBtb3VudChlbGVtZW50OiBIVE1MRWxlbWVudCkge1xuICAgIGVsZW1lbnQuaW5uZXJIVE1MID0gdGhpcy5yZW5kZXJSYXdIdG1sKClcbiAgfVxuXG4gIGluaXQoKTogdm9pZCB7XG4gICAgdGhpcy5yZW5kZXIoKVxuICB9XG59XG4iLCJleHBvcnQgY2xhc3MgUGVyc29uIHtcbiAgaWQ6IG51bWJlclxuICBmaXJzdE5hbWU6IHN0cmluZ1xuICBsYXN0TmFtZTogc3RyaW5nXG4gIGVtYWlsOiBzdHJpbmdcbiAgYWdlOiBudW1iZXJcbiAgY29uc3RydWN0b3IoaWQ6IG51bWJlciwgZmlyc3ROYW1lOiBzdHJpbmcsIGxhc3ROYW1lOiBzdHJpbmcsIGVtYWlsOiBzdHJpbmcsIGFnZTogbnVtYmVyKSB7XG4gICAgdGhpcy5pZCA9IGlkXG4gICAgdGhpcy5maXJzdE5hbWUgPSBmaXJzdE5hbWVcbiAgICB0aGlzLmxhc3ROYW1lID0gbGFzdE5hbWVcbiAgICB0aGlzLmVtYWlsID0gZW1haWxcbiAgICB0aGlzLmFnZSA9IGFnZVxuICB9XG59XG4iLCJpbXBvcnQgeyBQZXJzb24gfSBmcm9tIFwiLi9QZXJzb25cIlxuaW1wb3J0IHsgU3ViamVjdCwgVGVhY2hlclN0dWRlbnRDb25zdHJ1Y3QgfSBmcm9tIFwiLi4vdHlwZXNcIlxuaW1wb3J0IHsgbmFub2lkIH0gZnJvbSBcIm5hbm9pZFwiXG5cbmV4cG9ydCBjbGFzcyBUZWFjaGVyIGV4dGVuZHMgUGVyc29uIGltcGxlbWVudHMgVGVhY2hlclN0dWRlbnRDb25zdHJ1Y3Qge1xuICBzdWJqZWN0czogU3ViamVjdFtdXG4gIGNvbnN0cnVjdG9yKGlkOiBudW1iZXIsIGZpcnN0TmFtZTogc3RyaW5nLCBsYXN0TmFtZTogc3RyaW5nLCBlbWFpbDogc3RyaW5nLCBhZ2U6IG51bWJlcikge1xuICAgIHN1cGVyKGlkLCBmaXJzdE5hbWUsIGxhc3ROYW1lLCBlbWFpbCwgYWdlKVxuICAgIHRoaXMuc3ViamVjdHMgPSBbXVxuICB9XG5cbiAgZGlzcGxheUluZm8oKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIG5hbWU6IGAke3RoaXMuZmlyc3ROYW1lfS0ke3RoaXMubGFzdE5hbWV9YCxcbiAgICAgIGVtYWlsOiB0aGlzLmVtYWlsLFxuICAgICAgYWdlOiBgJHt0aGlzLmFnZX1gLFxuICAgIH1cbiAgfVxufVxuXG5leHBvcnQgY29uc3QgbG9hZFRlYWNoZXJzID0gKCkgPT4gW1xuICBuZXcgVGVhY2hlcigxLCBcIkZyYW5rXCIsIFwiU21pdGhcIiwgXCJmcmFua0Bpby5jb21cIiwgNDMpLFxuICBuZXcgVGVhY2hlcigyLCBcIkxvZ2FuXCIsIFwiSm9uc3NvblwiLCBcImxvZ2FuQGlvLmNvbVwiLCA0NyksXG4gIG5ldyBUZWFjaGVyKDMsIFwiTWlhXCIsIFwiR3JlZ2VyXCIsIFwibWlhQGlvLmNvbVwiLCA0MSksXG4gIG5ldyBUZWFjaGVyKDQsIFwiQm9yaXNcIiwgXCJSb29uZXlcIiwgXCJmcmFua0Bpby5jb21cIiwgNTMpLFxuXVxuIiwiaW1wb3J0IHsgTGlzdFZpZXcgfSBmcm9tIFwiLi4vdmlld3MvbGlzdC12aWV3XCJcbmltcG9ydCB7IGxvYWRUZWFjaGVycywgVGVhY2hlciB9IGZyb20gXCIuLi9tb2RlbHMvdGVhY2hlclwiXG5cbmV4cG9ydCBjbGFzcyBUZWFjaGVyQ29udHJvbGxlciB7XG4gIHBhcmVudEVsZW1lbnQ6IEhUTUxEaXZFbGVtZW50XG4gIHRlYWNoZXJzVmlldzogTGlzdFZpZXc8VGVhY2hlcj5cbiAgY29uc3RydWN0b3IocGFyZW50RWxlbWVudDogSFRNTERpdkVsZW1lbnQpIHtcbiAgICB0aGlzLnBhcmVudEVsZW1lbnQgPSBwYXJlbnRFbGVtZW50XG4gICAgdGhpcy50ZWFjaGVyc1ZpZXcgPSBuZXcgTGlzdFZpZXcodGhpcy5wYXJlbnRFbGVtZW50LCBsb2FkVGVhY2hlcnMoKSwgXCJUZWFjaGVyc1wiLCBbXG4gICAgICBcIm5hbWVcIixcbiAgICAgIFwiZW1haWxcIixcbiAgICAgIFwiYWdlXCIsXG4gICAgXSlcbiAgfVxuXG4gIGluaXQoKTogdm9pZCB7XG4gICAgdGhpcy50ZWFjaGVyc1ZpZXcuaW5pdCgpXG4gIH1cbn1cbiIsImltcG9ydCB7IENvdXJzZSB9IGZyb20gXCIuL2NvdXJzZVwiXG5pbXBvcnQgeyBTdHVkZW50IH0gZnJvbSBcIi4vc3R1ZGVudFwiXG5cbmNsYXNzIEFkbWluTWVkaWF0b3Ige1xuICBzdHVkZW50czogUmVjb3JkPHN0cmluZywgU3R1ZGVudD5cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgdGhpcy5zdHVkZW50cyA9IHt9XG4gIH1cbiAgcmVnaXN0ZXJTdHVkZW50KHN0dWRlbnQ6IFN0dWRlbnQpIHtcbiAgICB0aGlzLnN0dWRlbnRzW3N0dWRlbnQuZmlyc3ROYW1lXSA9IHN0dWRlbnRcbiAgICBzdHVkZW50LmFkbWluTWVkaWF0b3IgPSB0aGlzXG4gIH1cblxuICBzZW5kKG1lc3NhZ2U6IHN0cmluZywgZnJvbTogU3R1ZGVudCwgdG8/OiBTdHVkZW50KSB7XG4gICAgaWYgKHRvKSB7XG4gICAgICB0by5yZWNlaXZlKG1lc3NhZ2UsIGZyb20pXG4gICAgfSBlbHNlIHtcbiAgICAgIE9iamVjdC5rZXlzKHRoaXMuc3R1ZGVudHMpLmZvckVhY2goa2V5ID0+IHtcbiAgICAgICAgaWYgKHRoaXMuc3R1ZGVudHNba2V5XSAhPT0gZnJvbSkge1xuICAgICAgICAgIHRoaXMuc3R1ZGVudHNba2V5XS5yZWNlaXZlKG1lc3NhZ2UsIGZyb20pXG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgfVxuICB9XG59XG5cbi8vIGNsYXNzIFN0dWRlbnRNZWRpYXRvciB7XG4vLyAgIHN0dWRlbnRzOiBSZWNvcmQ8c3RyaW5nLCBTdHVkZW50PlxuLy8gICBjb25zdHJ1Y3RvcigpIHtcbi8vICAgICB0aGlzLnN0dWRlbnRzID0ge31cbi8vICAgfVxuXG4vLyAgIHJlZ2lzdGVyU3R1ZGVudChzdHVkZW50OiBTdHVkZW50KSB7XG4vLyAgICAgdGhpcy5zdHVkZW50c1tzdHVkZW50LmZpcnN0TmFtZV0gPSBzdHVkZW50XG4vLyAgICAgc3R1ZGVudC5hZG1pbk1lZGlhdG9yID0gdGhpc1xuLy8gICB9XG5cbi8vICAgc2VuZChtZXNzYWdlOiBzdHJpbmcsIGZyb206IFN0dWRlbnQsIHRvPzogU3R1ZGVudCkge1xuLy8gICAgIGlmICh0bykge1xuLy8gICAgICAgdG8ucmVjZWl2ZShtZXNzYWdlLCBmcm9tKVxuLy8gICAgIH0gZWxzZSB7XG4vLyAgICAgICBPYmplY3Qua2V5cyh0aGlzLnN0dWRlbnRzKS5mb3JFYWNoKGtleSA9PiB7XG4vLyAgICAgICAgIGlmICh0aGlzLnN0dWRlbnRzW2tleV0gIT09IGZyb20pIHtcbi8vICAgICAgICAgICB0aGlzLnN0dWRlbnRzW2tleV0ucmVjZWl2ZShtZXNzYWdlLCBmcm9tKVxuLy8gICAgICAgICB9XG4vLyAgICAgICB9KVxuLy8gICAgIH1cbi8vICAgfVxuLy8gfVxuY2xhc3MgQ291cnNlTWVkaWF0b3Ige1xuICBjb3Vyc2VzOiBSZWNvcmQ8c3RyaW5nLCBDb3Vyc2U+XG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMuY291cnNlcyA9IHt9XG4gIH1cblxuICByZWdpc3RlckNvdXJzZShjb3Vyc2U6IENvdXJzZSkge1xuICAgIHRoaXMuY291cnNlc1tjb3Vyc2UudGl0bGVdID0gY291cnNlXG4gICAgY291cnNlLmNvdXJzZU1lZGlhdG9yID0gdGhpc1xuICB9XG5cbiAgc2VuZChtZXNzYWdlOiBzdHJpbmcsIGZyb206IENvdXJzZSwgdG8/OiBDb3Vyc2UpIHtcbiAgICAvL1xuICB9XG59XG5cbmV4cG9ydCB7IENvdXJzZU1lZGlhdG9yLCBBZG1pbk1lZGlhdG9yIH1cbiIsImltcG9ydCB7IEFkbWluTWVkaWF0b3IgfSBmcm9tIFwiLi9tZWRpYXRvclwiXG5pbXBvcnQgeyBQZXJzb24gfSBmcm9tIFwiLi9QZXJzb25cIlxuXG5jbGFzcyBTdHVkZW50IGV4dGVuZHMgUGVyc29uIHtcbiAgYWRtaW5NZWRpYXRvcjogbnVsbCB8IEFkbWluTWVkaWF0b3JcbiAgY29uc3RydWN0b3IoaWQ6IG51bWJlciwgZmlyc3ROYW1lOiBzdHJpbmcsIGxhc3ROYW1lOiBzdHJpbmcsIGVtYWlsOiBzdHJpbmcsIGFnZTogbnVtYmVyKSB7XG4gICAgc3VwZXIoaWQsIGZpcnN0TmFtZSwgbGFzdE5hbWUsIGVtYWlsLCBhZ2UpXG4gICAgdGhpcy5hZG1pbk1lZGlhdG9yID0gbnVsbFxuICB9XG4gIGRpc3BsYXlJbmZvKCkge1xuICAgIHJldHVybiB7XG4gICAgICBuYW1lOiBgJHt0aGlzLmZpcnN0TmFtZX0tJHt0aGlzLmxhc3ROYW1lfWAsXG4gICAgICBlbWFpbDogdGhpcy5lbWFpbCxcbiAgICAgIGFnZTogYCR7dGhpcy5hZ2V9YCxcbiAgICB9XG4gIH1cbiAgc2VuZChtZXNzYWdlOiBzdHJpbmcsIHRvPzogU3R1ZGVudCkge1xuICAgIHRoaXMuYWRtaW5NZWRpYXRvcj8uc2VuZChtZXNzYWdlLCB0aGlzLCB0bylcbiAgfVxuICByZWNlaXZlKG1lc3NhZ2U6IHN0cmluZywgZnJvbTogU3R1ZGVudCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIGAke21lc3NhZ2V9IC0gZnJvbSAke2Zyb219YFxuICB9XG59XG5cbmNvbnN0IGFkbWluTWVkaWF0b3IgPSBuZXcgQWRtaW5NZWRpYXRvcigpXG5cbmNvbnNvbGUubG9nKFwiYWRtaW5NZWRpYXRvclwiLCBhZG1pbk1lZGlhdG9yKVxuXG5jb25zdCBsb2FkU3R1ZGVudHMgPSAoKSA9PiBbXG4gIG5ldyBTdHVkZW50KDEsIFwiRnJhbmtcIiwgXCJNZWxsYmVyZ1wiLCBcImZyYW5rQGlvLmNvbVwiLCAyMSksXG4gIG5ldyBTdHVkZW50KDIsIFwiUmlvXCIsIFwiRmVyZGluYW5kXCIsIFwicmlvQGlvLmNvbVwiLCAyNSksXG4gIG5ldyBTdHVkZW50KDMsIFwiTmVtYW5qYVwiLCBcIlZpZGljXCIsIFwibmVtYW5qYUBpby5jb21cIiwgMzIpLFxuICBuZXcgU3R1ZGVudCg0LCBcIkZyZWRyaWtcIiwgXCJsanVuZ2JlcmdcIiwgXCJmcmVkcmlrQGlvLmNvbVwiLCAzMiksXG5dXG5cbmNvbnNvbGUubG9nKGxvYWRTdHVkZW50cygpWzBdLnNlbmQoXCJoZWxsb1wiKSlcbmNvbnN0IHJlZ2lzdGVyQWxsU3R1ZGVudHMgPSAoKTogdm9pZCA9PiB7XG4gIGZvciAobGV0IHN0dWRlbnQgb2YgbG9hZFN0dWRlbnRzKCkpIHtcbiAgICBhZG1pbk1lZGlhdG9yLnJlZ2lzdGVyU3R1ZGVudChzdHVkZW50KVxuICB9XG59XG5cbmV4cG9ydCB7IFN0dWRlbnQsIGxvYWRTdHVkZW50cywgYWRtaW5NZWRpYXRvciwgcmVnaXN0ZXJBbGxTdHVkZW50cyB9XG4iLCJpbXBvcnQgeyBTdHVkZW50IH0gZnJvbSBcIi4uL21vZGVscy9zdHVkZW50XCJcbmltcG9ydCB7IFRlYWNoZXIgfSBmcm9tIFwiLi4vbW9kZWxzL3RlYWNoZXJcIlxuaW1wb3J0IHsgTGlzdFZpZXcgfSBmcm9tIFwiLi9saXN0LXZpZXdcIlxuXG5leHBvcnQgY2xhc3MgTW9kYWxWaWV3PFQsIFM+IHtcbiAgcGFyZW50RWxlbWVudDogSFRNTERpdkVsZW1lbnRcbiAgbGlzdDogQXJyYXk8YW55PlxuICBkYXRhOiBTdHVkZW50IHwgVGVhY2hlclxuICB0aXRsZTogc3RyaW5nXG4gIGxpc3RWaWV3OiBMaXN0VmlldzxUPlxuICBzdWJUaXRsZXM6IHN0cmluZ1tdXG4gIGNvbmZpcm1hdGlvblRleHQ6IHN0cmluZ1xuICBjb25zdHJ1Y3RvcihcbiAgICBwYXJlbnRFbGVtZW50OiBIVE1MRGl2RWxlbWVudCxcbiAgICBsaXN0OiBhbnksXG4gICAgZGF0YTogU3R1ZGVudCB8IFRlYWNoZXIsXG4gICAgdGl0bGU6IHN0cmluZyxcbiAgICBzdWJUaXRsZXM6IHN0cmluZ1tdLFxuICApIHtcbiAgICB0aGlzLnBhcmVudEVsZW1lbnQgPSBwYXJlbnRFbGVtZW50XG4gICAgdGhpcy5saXN0ID0gbGlzdFxuICAgIHRoaXMuZGF0YSA9IGRhdGFcbiAgICB0aGlzLnRpdGxlID0gdGl0bGVcbiAgICB0aGlzLnN1YlRpdGxlcyA9IHN1YlRpdGxlc1xuICAgIHRoaXMubGlzdFZpZXcgPSBuZXcgTGlzdFZpZXcodGhpcy5wYXJlbnRFbGVtZW50LCB0aGlzLmxpc3QsIHRoaXMudGl0bGUsIHRoaXMuc3ViVGl0bGVzKVxuICAgIHRoaXMuY29uZmlybWF0aW9uVGV4dCA9IFwiXCJcbiAgfVxuXG4gIHVwZGF0ZVRleHQodGV4dDogc3RyaW5nKSB7XG4gICAgY29uc29sZS5sb2coXCJURVhUXCIsIHRleHQpXG4gICAgdGhpcy5jb25maXJtYXRpb25UZXh0ID0gdGV4dFxuICB9XG5cbiAgcmVuZGVyKCk6IHZvaWQge1xuICAgIGNvbnN0IG1vZGFsV3JhcHBlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxcIikgYXMgSFRNTERMaXN0RWxlbWVudFxuICAgIG1vZGFsV3JhcHBlci5jbGFzc0xpc3QuYWRkKFwic2hvdy1tb2RhbFwiKVxuXG4gICAgY29uc3QgaHRtbCA9IGBcbiAgICA8ZGl2IGNsYXNzPVwibW9kYWwtY29udGFpbmVyXCI+XG4gICAgICAke3RoaXMubGlzdFZpZXcucmVuZGVyUmF3SHRtbCgpfVxuICAgICAgJHt0aGlzLmNvbmZpcm1hdGlvblRleHR9XG4gICAgICA8YnV0dG9uIGNsYXNzPVwiY2xvc2UtbW9kYWxcIj5cbiAgICAgICAg4p2MXG4gICAgICA8L2J1dHRvbj5cbiAgICA8L2Rpdj5cbiAgICBgXG5cbiAgICBtb2RhbFdyYXBwZXIuaW5uZXJIVE1MID0gaHRtbFxuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2xvc2UtbW9kYWxcIik/LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICBtb2RhbFdyYXBwZXIuY2xhc3NMaXN0LnJlbW92ZShcInNob3ctbW9kYWxcIilcbiAgICAgIG1vZGFsV3JhcHBlci5pbm5lckhUTUwgPSBcIlwiXG4gICAgfSlcblxuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWwgdGJvZHkgdHJcIikuZm9yRWFjaCgodHI6IGFueSkgPT4ge1xuICAgICAgdHIuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldmVudDogYW55KSA9PiB7XG4gICAgICAgIGlmIChcInNlbmRcIiBpbiB0aGlzLmRhdGEpIHtcbiAgICAgICAgICBjb25zdCBjb25maXJtYXRpb25UZXh0ID0gYFlvdSBoYXZlIG5vdyBiZWVuIHJlZ2lzdGVyZWQgdG8gdGhlICR7ZXZlbnQudGFyZ2V0LmlubmVyVGV4dH0gQ291cnNlYFxuICAgICAgICAgIHRoaXMuZGF0YS5zZW5kKGNvbmZpcm1hdGlvblRleHQsIHRoaXMuZGF0YSkgLy8gc2VuZGluZyB0byB5b3Vyc2VsZlxuICAgICAgICAgIHRoaXMudXBkYXRlVGV4dChjb25maXJtYXRpb25UZXh0KVxuICAgICAgICAgIHRoaXMudXBkYXRlSHRtbCgpXG4gICAgICAgIH1cblxuICAgICAgICAvLyBpZiAodHIuZGF0YXNldC5pZCA9PT0gU3RyaW5nKHRoaXMuZGF0YS5pZCkpIHtcbiAgICAgICAgLy8gICBpZiAoXCJzZW5kXCIgaW4gdGhpcy5kYXRhKSB7XG4gICAgICAgIC8vICAgICBjb25zdCBjb25maXJtYXRpb25UZXh0ID0gYFlvdSBoYXZlIG5vdyBiZWVuIHJlZ2lzdGVyZWQgdG8gJHtldmVudC50YXJnZXQuaW5uZXJUZXh0fWBcbiAgICAgICAgLy8gICAgIHRoaXMuZGF0YS5zZW5kKGNvbmZpcm1hdGlvblRleHQsIHRoaXMuZGF0YSlcbiAgICAgICAgLy8gICAgIHRoaXMudXBkYXRlVGV4dChjb25maXJtYXRpb25UZXh0KVxuICAgICAgICAvLyAgIH1cbiAgICAgICAgLy8gfVxuICAgICAgfSlcbiAgICB9KVxuICB9XG4gIHVwZGF0ZUh0bWwoKSB7XG4gICAgdGhpcy5yZW5kZXIoKVxuICB9XG59XG4iLCJpbXBvcnQgeyBDb3Vyc2VNZWRpYXRvciB9IGZyb20gXCIuL21lZGlhdG9yXCJcbmltcG9ydCB7IERpc3BsYXlJbmZvIH0gZnJvbSBcIi4uL3R5cGVzXCJcbmNsYXNzIENvdXJzZSB7XG4gIGlkOiBudW1iZXJcbiAgdGl0bGU6IHN0cmluZ1xuICBkZXNjcmlwdGlvbjogc3RyaW5nXG4gIGR1cmF0aW9uOiBzdHJpbmdcbiAgY291cnNlTWVkaWF0b3I6IG51bGwgfCBDb3Vyc2VNZWRpYXRvclxuICBjb25zdHJ1Y3RvcihpZDogbnVtYmVyLCB0aXRsZTogc3RyaW5nLCBkZXNjcmlwdGlvbjogc3RyaW5nLCBkdXJhdGlvbjogc3RyaW5nKSB7XG4gICAgdGhpcy5pZCA9IGlkXG4gICAgdGhpcy50aXRsZSA9IHRpdGxlXG4gICAgdGhpcy5kZXNjcmlwdGlvbiA9IGRlc2NyaXB0aW9uXG4gICAgdGhpcy5kdXJhdGlvbiA9IGR1cmF0aW9uXG4gICAgdGhpcy5jb3Vyc2VNZWRpYXRvciA9IG51bGxcbiAgfVxuXG4gIGRpc3BsYXlJbmZvKCk6IERpc3BsYXlJbmZvIHtcbiAgICByZXR1cm4ge1xuICAgICAgdGl0bGU6IHRoaXMudGl0bGUsXG4gICAgICBkdXJhdGlvbjogdGhpcy5kdXJhdGlvbixcbiAgICB9XG4gIH1cbiAgc2VuZCgpIHt9XG4gIHJlY2VpdmUoKSB7fVxufVxuXG5jb25zdCBjb3Vyc2VNZWRpYXRvciA9IG5ldyBDb3Vyc2VNZWRpYXRvcigpXG5cbmNvbnN0IGxvYWRDb3Vyc2VzID0gKCk6IENvdXJzZVtdID0+IFtcbiAgbmV3IENvdXJzZSgxLCBcIm1hdGhcIiwgXCJtYXRoIGlzIHdvbmRlcmZ1bFwiLCBcIjZoXCIpLFxuICBuZXcgQ291cnNlKDIsIFwiaGlzdG9yeVwiLCBcImhpc3RvcnkgaXMgZ29vZCBmb3IgeW91XCIsIFwiM2hcIiksXG4gIG5ldyBDb3Vyc2UoMywgXCJzd2VkaXNoXCIsIFwid2l0aG91dCBzd2VkaXNoIHlvdSB3aWxsIGZhY2Ugc29tZSBzZXJpb3VzIHByb2JsZW1zXCIsIFwiMmhcIiksXG4gIG5ldyBDb3Vyc2UoNCwgXCJlbmdsaXNoXCIsIFwidGhlIGdsb2JhbCBsYW5ndWFnZSwgbGVhcm4gaXQgTk9XISEhXCIsIFwiNWhcIiksXG5dXG5cbmNvbnN0IHJlZ2lzdGVyQ291cnNlcyA9ICgpID0+IHtcbiAgZm9yIChsZXQgY291cnNlIG9mIGxvYWRDb3Vyc2VzKCkpIHtcbiAgICBjb3Vyc2VNZWRpYXRvci5yZWdpc3RlckNvdXJzZShjb3Vyc2UpXG4gIH1cbn1cblxuZXhwb3J0IHsgQ291cnNlLCBsb2FkQ291cnNlcywgcmVnaXN0ZXJDb3Vyc2VzIH1cbiIsImV4cG9ydCBjbGFzcyBQcm9maWxlVmlldyB7XG4gIGNvbnN0cnVjdG9yKCkge31cblxuICBjbGlja0hhbmRsZXIoKSB7fVxufVxuIiwiaW1wb3J0IHsgbG9hZFN0dWRlbnRzLCBTdHVkZW50LCByZWdpc3RlckFsbFN0dWRlbnRzLCBhZG1pbk1lZGlhdG9yIH0gZnJvbSBcIi4uL21vZGVscy9zdHVkZW50XCJcbmltcG9ydCB7IExpc3RWaWV3IH0gZnJvbSBcIi4uL3ZpZXdzL2xpc3Qtdmlld1wiXG5pbXBvcnQgeyBNb2RhbFZpZXcgYXMgQ291cnNlc01vZGFsVmlldyB9IGZyb20gXCIuLi92aWV3cy9tb2RhbC12aWV3XCJcbmltcG9ydCB7IGxvYWRDb3Vyc2VzIH0gZnJvbSBcIi4uL21vZGVscy9jb3Vyc2VcIlxuaW1wb3J0IHsgUHJvZmlsZVZpZXcgfSBmcm9tIFwiLi4vdmlld3MvcHJvZmlsZS12aWV3XCJcblxuZXhwb3J0IGNsYXNzIFN0dWRlbnRDb250cm9sbGVyIHtcbiAgcGFyZW50RWxlbWVudDogSFRNTERpdkVsZW1lbnRcbiAgc3R1ZGVudHNWaWV3OiBMaXN0VmlldzxTdHVkZW50PlxuICBwcm9maWxlVmlldzogUHJvZmlsZVZpZXdcbiAgY29uc3RydWN0b3IocGFyZW50RWxlbWVudDogSFRNTERpdkVsZW1lbnQpIHtcbiAgICB0aGlzLnBhcmVudEVsZW1lbnQgPSBwYXJlbnRFbGVtZW50XG4gICAgdGhpcy5zdHVkZW50c1ZpZXcgPSBuZXcgTGlzdFZpZXcodGhpcy5wYXJlbnRFbGVtZW50LCBsb2FkU3R1ZGVudHMoKSwgXCJTdHVkZW50c1wiLCBbXG4gICAgICBcIm5hbWVcIixcbiAgICAgIFwiZW1haWxcIixcbiAgICAgIFwiYWdlXCIsXG4gICAgXSlcbiAgICB0aGlzLnByb2ZpbGVWaWV3ID0gbmV3IFByb2ZpbGVWaWV3KClcbiAgfVxuXG4gIGhhbmRsZUNsaWNrU3R1ZGVudCgpOiB2b2lkIHtcbiAgICB0aGlzLnN0dWRlbnRzVmlldy5jbGlja0hhbmRsZXIoKGlkOiBudW1iZXIpID0+IHtcbiAgICAgIGNvbnN0IHN0dWRlbnQgPSBsb2FkU3R1ZGVudHMoKS5maW5kKHN0dWRlbnQgPT4gc3R1ZGVudC5pZCA9PT0gaWQpXG4gICAgICBjb25zdCBkYXRhID0gc3R1ZGVudCEgYXMgU3R1ZGVudFxuICAgICAgY29uc29sZS5sb2coXCJkYXRhXCIsIGRhdGEpXG4gICAgICBjb25zdCBjb3Vyc2VzID0gbG9hZENvdXJzZXMoKVxuICAgICAgY29uc3QgbW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsLWxpc3RcIikgYXMgSFRNTERpdkVsZW1lbnRcbiAgICAgIG5ldyBDb3Vyc2VzTW9kYWxWaWV3PGFueVtdLCBTdHVkZW50Pihtb2RhbCwgY291cnNlcywgZGF0YSwgXCJjb3Vyc2VzXCIsIFtcbiAgICAgICAgXCJ0aXRsZVwiLFxuICAgICAgICBcImR1cmF0aW9uXCIsXG4gICAgICBdKS5yZW5kZXIoKVxuICAgIH0pXG4gIH1cblxuICBoYW5kbGVTaG93UHJvZmlsZSgpOiB2b2lkIHtcbiAgICAvL1xuICB9XG5cbiAgaW5pdCgpOiB2b2lkIHtcbiAgICB0aGlzLnN0dWRlbnRzVmlldy5pbml0KClcbiAgICB0aGlzLmhhbmRsZUNsaWNrU3R1ZGVudCgpXG4gICAgcmVnaXN0ZXJBbGxTdHVkZW50cygpXG4gICAgY29uc29sZS5sb2coXCJhZG1pbk1lZGlhdG9yXCIsIGFkbWluTWVkaWF0b3IpIC8vIWZvciB0ZXN0aW5nIVxuICB9XG59XG4iLCJpbXBvcnQgeyBBcHAgfSBmcm9tIFwiLi9wYXR0ZXJucy9tdmMyLjAvY29udHJvbGxlcnMvYXBwXCJcbmltcG9ydCB7IFRlYWNoZXJDb250cm9sbGVyIH0gZnJvbSBcIi4vcGF0dGVybnMvbXZjMi4wL2NvbnRyb2xsZXJzL3RlYWNoZXJcIlxuaW1wb3J0IHsgU3R1ZGVudENvbnRyb2xsZXIgfSBmcm9tIFwiLi9wYXR0ZXJucy9tdmMyLjAvY29udHJvbGxlcnMvc3R1ZGVudFwiXG47KCgpID0+IHtcbiAgY29uc3QgY3JlYXRlRWxlbWVudCA9ICh0YWc6IHN0cmluZywgY2xhc3NOYW1lOiBzdHJpbmcpOiBIVE1MRWxlbWVudCA9PiB7XG4gICAgY29uc3QgZWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQodGFnKVxuICAgIGVsZW1lbnQuY2xhc3NMaXN0LmFkZChjbGFzc05hbWUpXG4gICAgcmV0dXJuIGVsZW1lbnRcbiAgfVxuICBuZXcgQXBwKFxuICAgIG5ldyBUZWFjaGVyQ29udHJvbGxlcihkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInRlYWNoZXJcIikgYXMgSFRNTERpdkVsZW1lbnQpLFxuICAgIG5ldyBTdHVkZW50Q29udHJvbGxlcihkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInN0dWRlbnRcIikgYXMgSFRNTERpdkVsZW1lbnQpXG4gICkucmVuZGVyKClcbn0pKClcbiJdLCJzb3VyY2VSb290IjoiIn0=